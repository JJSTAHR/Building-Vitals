
<!doctype html>
<html lang="en">

<head>
    <title>Code coverage report for Building Vitals/Building-Vitals/build/js/app-core-rH6lZf1X.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../../prettify.css" />
    <link rel="stylesheet" href="../../../../base.css" />
    <link rel="shortcut icon" type="image/x-icon" href="../../../../favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../../sort-arrow-sprite.png);
        }
    </style>
</head>
    
<body>
<div class='wrapper'>
    <div class='pad1'>
        <h1><a href="../../../../index.html">All files</a> / <a href="index.html">Building Vitals/Building-Vitals/build/js</a> app-core-rH6lZf1X.js</h1>
        <div class='clearfix'>
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Statements</span>
                <span class='fraction'>0/2</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Branches</span>
                <span class='fraction'>0/1</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Functions</span>
                <span class='fraction'>0/1</span>
            </div>
        
            
            <div class='fl pad1y space-right2'>
                <span class="strong">0% </span>
                <span class="quiet">Lines</span>
                <span class='fraction'>0/2</span>
            </div>
        
            
        </div>
        <p class="quiet">
            Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
        </p>
        <template id="filterTemplate">
            <div class="quiet">
                Filter:
                <input type="search" id="fileSearch">
            </div>
        </template>
    </div>
    <div class='status-line low'></div>
    <pre><table class="coverage">
<tr><td class="line-count quiet"><a name='L1'></a><a href='#L1'>1</a>
<a name='L2'></a><a href='#L2'>2</a>
<a name='L3'></a><a href='#L3'>3</a></td><td class="line-coverage quiet"><span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js"><span class="cstat-no" title="statement not covered" ><span class="fstat-no" title="function not covered" ><span class="branch-0 cbranch-no" title="branch not covered" >const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/services-B0KkmCks.js","js/firebase-vendor-DFJ8_Xw5.js","js/vendor-CFMRQ_Yt.js","js/data-vendor-DBrFxduC.js","js/echarts-vendor-xTKhTmAz.js","assets/vendor-BOltB2Hq.css","js/utils-CrQ8UdBz.js","js/date-vendor-BU9txqBG.js"])))=&gt;i.map(i=&gt;d[i]);</span></span></span>
<span class="cstat-no" title="statement not covered" >var __defProp=Object.defineProperty,__publicField=(obj,key,value)=&gt;((obj,key,value)=&gt;key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value)(obj,"symbol"!=typeof key?key+"":key,value);import{u as useDispatch,a as useSelector,c as createSlice,b as createTheme,d as combineReducers,r as retry,f as fetchBaseQuery,e as createApi,s as storage,g as configureStore,h as setupListeners,p as persistStore,i as persistReducer,F as FLUSH,R as REHYDRATE,P as PAUSE,j as PERSIST,k as PURGE,l as REGISTER,m as jwtDecode,n as reactExports,o as useTheme,q as jsxRuntimeExports,S as Snackbar,A as Alert,t as useMediaQuery$1,v as alpha,w as useQueryClient,x as useQuery,y as useMutation,z as useNavigate,B as useHotkeys,D as Dialog,C as DialogTitle,E as Box,K as Keyboard,T as Typography,G as DialogContent,H as TableContainer,I as Paper,J as Table,L as TableBody,M as TableRow,N as TableCell,O as React,Q as Chip,U as DialogActions,V as Button}from"./vendor-CFMRQ_Yt.js";import{g as getAceApiToken,i as initializeBatchApiService$1,v as validateAceToken,s as setAceApiToken,a as secureStorage,e as encryptionService,b as initializeTokenInterceptor,l as loadDashboardConfiguration,c as setActiveDashboardId,d as snapshotService,f as getActiveDashboardId,h as saveDashboardConfiguration,j as getUserDashboardsFromFirestore,k as fetchTimeseriesForPoints,p as pointService,m as cachedSitePointService}from"./services-B0KkmCks.js";import{i as initializeApp,g as getAuth,a as initializeFirestore,p as persistentLocalCache,b as getStorage,c as getFunctions,d as isSupported,e as getAnalytics,f as isWindowSupported,h as getMessagingInWindow,G as GoogleAuthProvider,O as OAuthProvider,j as persistentMultipleTabManager,k as httpsCallable,l as doc,m as getDoc,s as setDoc,u as updateDoc,n as getRedirectResult,o as serverTimestamp,q as signInWithRedirect,r as signInWithPopup}from"./firebase-vendor-DFJ8_Xw5.js";import{a as axios}from"./data-vendor-DBrFxduC.js";import"./echarts-vendor-xTKhTmAz.js";import{C as CHART_DESIGN_TOKENS,c as calculateGridTop,a as calculateGridBottom,T as TYPOGRAPHY,S as SPACING,b as TokenSyncService,w as withErrorHandling,f as formatErrorForUser,r as reportError,i as isWeatherTemperaturePoint,d as convertTemperatureData,g as getPointDisplayLabel,e as formatLocalTimeForAPI,t as transformPointData,o as organizePointsHierarchically,v as validateChartConfig,h as hasKvTags,j as enhancePointWithKvTags,n as needsEnhancement,k as enhancePoint}from"./utils-CrQ8UdBz.js";import{s as subDays,a as subYears,b as subMonths,c as subHours}from"./date-vendor-BU9txqBG.js";import{u as useOptimisticNotification}from"./components-DaeLY-_K.js";const seen={},__vitePreload=function preload(baseModule,deps,importerUrl){let promise=Promise.resolve();if(deps&amp;&amp;deps.length&gt;0){let allSettled2=function(promises){return Promise.all(promises.map(p=&gt;Promise.resolve(p).then(value=&gt;({status:"fulfilled",value:value}),reason=&gt;({status:"rejected",reason:reason}))))};document.getElementsByTagName("link");const cspNonceMeta=document.querySelector("meta[property=csp-nonce]"),cspNonce=(null==cspNonceMeta?void 0:cspNonceMeta.nonce)||(null==cspNonceMeta?void 0:cspNonceMeta.getAttribute("nonce"));promise=allSettled2(deps.map(dep=&gt;{if((dep=function(dep){return"/"+dep}(dep))in seen)return;seen[dep]=!0;const isCss=dep.endsWith(".css"),cssSelector=isCss?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${dep}"]${cssSelector}`))return;const link=document.createElement("link");return link.rel=isCss?"stylesheet":"modulepreload",isCss||(link.as="script"),link.crossOrigin="",link.href=dep,cspNonce&amp;&amp;link.setAttribute("nonce",cspNonce),document.head.appendChild(link),isCss?new Promise((res,rej)=&gt;{link.addEventListener("load",res),link.addEventListener("error",()=&gt;rej(new Error(`Unable to preload CSS for ${dep}`)))}):void 0}))}function handlePreloadError(err){const e=new Event("vite:preloadError",{cancelable:!0});if(e.payload=err,window.dispatchEvent(e),!e.defaultPrevented)throw err}return promise.then(res=&gt;{for(const item of res||[])"rejected"===item.status&amp;&amp;handlePreloadError(item.reason);return baseModule().catch(handlePreloadError)})},useAppDispatch=()=&gt;useDispatch(),useAppSelector=useSelector,uiSlice=createSlice({name:"ui",initialState:{darkMode:!0,theme:"accessible",sidebarOpen:!0,selectedSite:null,selectedSiteId:null,selectedPoints:[],timeRange:"24h",customTimeRange:null,refreshInterval:60,autoRefresh:!1,loading:!1,notification:null},reducers:{setDarkMode:(state,action)=&gt;{state.darkMode=action.payload},setTheme:(state,action)=&gt;{state.theme=action.payload},toggleSidebar:state=&gt;{state.sidebarOpen=!state.sidebarOpen},setSidebarOpen:(state,action)=&gt;{state.sidebarOpen=action.payload},setSelectedSite:(state,action)=&gt;{state.selectedSite=action.payload},setSelectedSiteId:(state,action)=&gt;{state.selectedSiteId=action.payload,action.payload!==state.selectedSite&amp;&amp;(state.selectedPoints=[])},setSelectedPoints:(state,action)=&gt;{state.selectedPoints=action.payload},addSelectedPoint:(state,action)=&gt;{state.selectedPoints.includes(action.payload)||state.selectedPoints.push(action.payload)},removeSelectedPoint:(state,action)=&gt;{state.selectedPoints=state.selectedPoints.filter(point=&gt;point!==action.payload)},setTimeRange:(state,action)=&gt;{state.timeRange=action.payload,"custom"!==action.payload&amp;&amp;(state.customTimeRange=null)},setCustomTimeRange:(state,action)=&gt;{state.customTimeRange=action.payload,state.timeRange="custom"},setRefreshInterval:(state,action)=&gt;{state.refreshInterval=action.payload},setAutoRefresh:(state,action)=&gt;{state.autoRefresh=action.payload},setLoading:(state,action)=&gt;{state.loading=action.payload},showNotification:(state,action)=&gt;{state.notification={open:!0,message:action.payload.message,severity:action.payload.severity}},hideNotification:state=&gt;{state.notification&amp;&amp;(state.notification.open=!1)},clearNotification:state=&gt;{state.notification=null}}}),{setDarkMode:setDarkMode,setTheme:setTheme,toggleSidebar:toggleSidebar,setSidebarOpen:setSidebarOpen,setSelectedSite:setSelectedSite,setSelectedSiteId:setSelectedSiteId,setSelectedPoints:setSelectedPoints,addSelectedPoint:addSelectedPoint,removeSelectedPoint:removeSelectedPoint,setTimeRange:setTimeRange,setCustomTimeRange:setCustomTimeRange,setRefreshInterval:setRefreshInterval,setAutoRefresh:setAutoRefresh,setLoading:setLoading$1,showNotification:showNotification,hideNotification:hideNotification,clearNotification:clearNotification$1}=uiSlice.actions,uiSlice$1=uiSlice.reducer,sesColorPalette={primary:"#4571AF",primaryLight:"#6FA0D8",primaryDark:"#19437F",secondary:"#00BFA5",secondaryLight:"#5DFFDA",secondaryDark:"#008E76",accent:"#00E5FF",success:"#00E676",warning:"#FFC107",error:"#FF5252",info:"#3B82F6",backgroundDark:"#0a0a0b",backgroundPaper:"rgba(15, 15, 17, 0.8)",textPrimary:"rgba(255, 255, 255, 0.95)",textSecondary:"rgba(255, 255, 255, 0.7)",textDisabled:"rgba(255, 255, 255, 0.38)"},chartColorPalettes={ses:[sesColorPalette.primaryDark,sesColorPalette.primary,sesColorPalette.primaryLight,sesColorPalette.secondary,sesColorPalette.accent]},glassEffect={light:{backgroundColor:"rgba(255, 255, 255, 0.05)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.1)"},medium:{backgroundColor:"rgba(15, 15, 17, 0.8)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"},strong:{backgroundColor:"rgba(10, 14, 39, 0.9)",backdropFilter:"blur(30px)",WebkitBackdropFilter:"blur(30px)",border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"}},chartThemes={dark:{colors:chartColorPalettes.ses,textColor:sesColorPalette.textPrimary,gridColor:`${sesColorPalette.primary}15`,tooltipBackground:"rgba(10, 14, 39, 0.95)",tooltipBorder:`${sesColorPalette.primary}50`},light:{colors:chartColorPalettes.ses,textColor:"rgba(10, 14, 39, 0.9)",gridColor:`${sesColorPalette.primary}15`,tooltipBackground:"rgba(248, 250, 252, 0.95)",tooltipBorder:`${sesColorPalette.primary}30`}},sesDarkTheme=createTheme({palette:{mode:"dark",primary:{main:sesColorPalette.primary,light:sesColorPalette.primaryLight,dark:sesColorPalette.primaryDark,contrastText:"#FFFFFF"},secondary:{main:sesColorPalette.secondary,light:sesColorPalette.secondaryLight,dark:sesColorPalette.secondaryDark,contrastText:"#000000"},background:{default:sesColorPalette.backgroundDark,paper:sesColorPalette.backgroundPaper},text:{primary:sesColorPalette.textPrimary,secondary:sesColorPalette.textSecondary,disabled:sesColorPalette.textDisabled},success:{main:sesColorPalette.success,light:"#66FFA6",dark:"#00B248"},warning:{main:sesColorPalette.warning,light:"#FFD54F",dark:"#C79100"},error:{main:sesColorPalette.error,light:"#FF8A80",dark:"#C50E29"},info:{main:sesColorPalette.info,light:"#60A5FA",dark:"#2563EB"},divider:"rgba(255, 255, 255, 0.12)"},typography:{fontFamily:'"JetBrains Mono", "Roboto", "Helvetica", "Arial", monospace',fontSize:14,h1:{fontSize:"3rem",fontWeight:700,letterSpacing:"-0.02em",lineHeight:1.2},h2:{fontSize:"2.5rem",fontWeight:600,letterSpacing:"-0.01em",lineHeight:1.3},h3:{fontSize:"2rem",fontWeight:600,lineHeight:1.3},h4:{fontSize:"1.75rem",fontWeight:500,lineHeight:1.4},h5:{fontSize:"1.5rem",fontWeight:500,lineHeight:1.4},h6:{fontSize:"1.25rem",fontWeight:500,lineHeight:1.4},body1:{fontSize:"1rem",lineHeight:1.6},body2:{fontSize:"0.875rem",lineHeight:1.6},button:{textTransform:"none",fontWeight:500,fontSize:"0.875rem"}},spacing:8,shape:{borderRadius:8},components:{MuiCssBaseline:{styleOverrides:{body:{backgroundColor:sesColorPalette.backgroundDark,backgroundImage:`radial-gradient(ellipse at top left, ${sesColorPalette.primary}08, transparent 50%), radial-gradient(ellipse at bottom right, ${sesColorPalette.secondary}05, transparent 50%)`},":root":{"--spacing-0":"0px","--spacing-1":"8px","--spacing-2":"16px","--spacing-3":"24px","--spacing-4":"32px","--spacing-5":"40px","--spacing-6":"48px","--spacing-8":"64px","--spacing-10":"80px","--spacing-12":"96px","--spacing-16":"128px","--spacing-20":"160px","--spacing-24":"192px","--border-radius-small":"4px","--border-radius-medium":"8px","--border-radius-large":"12px","--border-radius-full":"50%","--shadow-light":"0 2px 8px rgba(0, 0, 0, 0.1)","--shadow-medium":"0 4px 16px rgba(0, 0, 0, 0.15)","--shadow-strong":"0 8px 32px rgba(0, 0, 0, 0.2)","--shadow-glow":`0 0 20px ${sesColorPalette.primary}40`,"--color-primary":sesColorPalette.primary,"--color-primary-light":sesColorPalette.primaryLight,"--color-primary-dark":sesColorPalette.primaryDark,"--color-secondary":sesColorPalette.secondary,"--color-accent":sesColorPalette.accent,"--color-background":sesColorPalette.backgroundDark,"--color-background-paper":sesColorPalette.backgroundPaper,"--color-text-primary":sesColorPalette.textPrimary,"--color-text-secondary":sesColorPalette.textSecondary}}},MuiButton:{styleOverrides:{root:{borderRadius:8,padding:"10px 24px",minHeight:"44px",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",fontWeight:500,"&amp;:focus-visible":{outline:`3px solid ${sesColorPalette.accent}`,outlineOffset:"2px"}},contained:{...glassEffect.light,background:`linear-gradient(135deg, ${sesColorPalette.primaryDark}E6 0%, ${sesColorPalette.primary}E6 100%)`,color:"#FFFFFF",border:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:`0 4px 16px ${sesColorPalette.primaryDark}50, inset 0 1px 0 rgba(255,255,255,0.2)`,"&amp;:hover":{transform:"translateY(-2px)",background:`linear-gradient(135deg, ${sesColorPalette.primaryDark} 0%, ${sesColorPalette.primary} 100%)`,boxShadow:`0 8px 32px ${sesColorPalette.primary}60, inset 0 1px 0 rgba(255,255,255,0.3)`}},outlined:{...glassEffect.light,borderColor:`${sesColorPalette.primary}80`,color:sesColorPalette.textPrimary,"&amp;:hover":{borderColor:sesColorPalette.primary,backgroundColor:`${sesColorPalette.primaryDark}20`}}}},MuiPaper:{styleOverrides:{root:{backgroundImage:"none",...glassEffect.medium}}},MuiCard:{styleOverrides:{root:{...glassEffect.medium,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)","&amp;:hover":{transform:"translateY(-4px)",boxShadow:`0 12px 48px rgba(0, 0, 0, 0.4), 0 0 0 1px ${sesColorPalette.primary}20`}}}},MuiTextField:{styleOverrides:{root:{"&amp; .MuiInputBase-root":{minHeight:"44px"},"&amp; .MuiOutlinedInput-root":{...glassEffect.light,"&amp; .MuiOutlinedInput-notchedOutline":{borderColor:`${sesColorPalette.primary}40`},"&amp;:hover":{"&amp; .MuiOutlinedInput-notchedOutline":{borderColor:`${sesColorPalette.primary}80`,borderWidth:"2px"}},"&amp;.Mui-focused":{"&amp; .MuiOutlinedInput-notchedOutline":{borderColor:sesColorPalette.accent,borderWidth:"2px"}}}}}},MuiAppBar:{styleOverrides:{root:{...glassEffect.strong,borderBottom:`1px solid ${sesColorPalette.primary}20`}}},MuiDrawer:{styleOverrides:{paper:{...glassEffect.strong,borderRight:`1px solid ${sesColorPalette.primary}20`}}},MuiTooltip:{styleOverrides:{tooltip:{backgroundColor:"rgba(10, 14, 39, 0.95)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",border:`1px solid ${sesColorPalette.primary}30`,fontSize:"0.75rem"}}},MuiChip:{styleOverrides:{root:{...glassEffect.light,backgroundColor:`${sesColorPalette.primary}20`,color:sesColorPalette.textPrimary,"&amp;:hover":{backgroundColor:`${sesColorPalette.primary}30`}}}},MuiMenu:{styleOverrides:{paper:{...glassEffect.medium,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.3)"}}},MuiMenuItem:{styleOverrides:{root:{"&amp;:hover":{backgroundColor:`${sesColorPalette.primary}15`},"&amp;.Mui-selected":{backgroundColor:`${sesColorPalette.primary}25`,"&amp;:hover":{backgroundColor:`${sesColorPalette.primary}35`}}}}},MuiDialog:{styleOverrides:{paper:{...glassEffect.medium,boxShadow:"0 8px 32px rgba(0, 0, 0, 0.4)"}}}}}),lightGlassEffect_light={backgroundColor:"rgba(255, 255, 255, 0.7)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",border:"1px solid rgba(69, 113, 175, 0.15)",boxShadow:"0 4px 16px 0 rgba(25, 67, 127, 0.08)"},lightGlassEffect_medium={backgroundColor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",border:"1px solid rgba(69, 113, 175, 0.2)",boxShadow:"0 8px 32px 0 rgba(25, 67, 127, 0.1)"},lightGlassEffect_strong={backgroundColor:"rgba(248, 250, 252, 0.95)",backdropFilter:"blur(30px)",WebkitBackdropFilter:"blur(30px)",border:"1px solid rgba(69, 113, 175, 0.25)",boxShadow:"0 8px 32px 0 rgba(25, 67, 127, 0.12)"};createTheme({palette:{mode:"light",primary:{main:"#4571AF",light:"#6FA0D8",dark:"#19437F",contrastText:"#FFFFFF"},secondary:{main:"#00BFA5",light:"#5DFFDA",dark:"#008E76",contrastText:"#FFFFFF"},background:{default:"#F8FAFC",paper:"rgba(255, 255, 255, 0.8)"},text:{primary:"rgba(10, 14, 39, 0.95)",secondary:"rgba(10, 14, 39, 0.7)",disabled:"rgba(10, 14, 39, 0.38)"},success:{main:"#00C853",light:"#5EFC82",dark:"#009624"},warning:{main:"#FF9800",light:"#FFC947",dark:"#C66900"},error:{main:"#D32F2F",light:"#EF5350",dark:"#C62828"},divider:`${sesColorPalette.primary}20`},typography:sesDarkTheme.typography,shape:sesDarkTheme.shape,components:{MuiCssBaseline:{styleOverrides:{body:{backgroundColor:"#F8FAFC",backgroundImage:`radial-gradient(ellipse at top left, ${sesColorPalette.primary}08 0%, transparent 50%), radial-gradient(ellipse at bottom right, ${sesColorPalette.secondary}05 0%, transparent 50%)`}}},MuiButton:{styleOverrides:{root:{borderRadius:8,padding:"8px 24px",transition:"all 0.3s ease",...lightGlassEffect_light,"&amp;:hover":{transform:"translateY(-2px)",boxShadow:"0 6px 20px rgba(69, 113, 175, 0.25)"}},contained:{background:`linear-gradient(135deg, ${sesColorPalette.primary}F0 0%, ${sesColorPalette.primaryLight}F0 100%)`,color:"#FFFFFF",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:`0 4px 16px ${sesColorPalette.primary}50, inset 0 1px 0 rgba(255,255,255,0.4)`,"&amp;:hover":{background:`linear-gradient(135deg, ${sesColorPalette.primary} 0%, ${sesColorPalette.primaryLight} 100%)`,boxShadow:`0 6px 24px ${sesColorPalette.primary}60, inset 0 1px 0 rgba(255,255,255,0.5)`}},outlined:{borderColor:`${sesColorPalette.primary}80`,color:sesColorPalette.primary,backgroundColor:"rgba(255, 255, 255, 0.5)","&amp;:hover":{borderColor:sesColorPalette.primary,backgroundColor:`${sesColorPalette.primary}10`}}}},MuiPaper:{styleOverrides:{root:{backgroundImage:"none",...lightGlassEffect_medium}}},MuiCard:{styleOverrides:{root:{...lightGlassEffect_medium,transition:"all 0.3s ease","&amp;:hover":{transform:"translateY(-4px)",boxShadow:"0 12px 48px rgba(25, 67, 127, 0.15)"}}}},MuiTextField:{styleOverrides:{root:{"&amp; .MuiOutlinedInput-root":{...lightGlassEffect_light,"&amp;:hover":{"&amp; .MuiOutlinedInput-notchedOutline":{borderColor:`${sesColorPalette.primary}60`}},"&amp;.Mui-focused":{"&amp; .MuiOutlinedInput-notchedOutline":{borderColor:sesColorPalette.primary}}}}}},MuiAppBar:{styleOverrides:{root:{...lightGlassEffect_strong,color:"rgba(10, 14, 39, 0.95)",borderBottom:`1px solid ${sesColorPalette.primary}30`}}},MuiDrawer:{styleOverrides:{paper:{...lightGlassEffect_strong,borderRight:`1px solid ${sesColorPalette.primary}30`}}},MuiTableCell:{styleOverrides:{root:{borderColor:`${sesColorPalette.primary}20`}}},MuiDivider:{styleOverrides:{root:{borderColor:`${sesColorPalette.primary}20`}}},MuiChip:{styleOverrides:{root:{...lightGlassEffect_light}}},MuiTooltip:{styleOverrides:{tooltip:{backgroundColor:"rgba(248, 250, 252, 0.95)",color:"rgba(10, 14, 39, 0.95)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",border:`1px solid ${sesColorPalette.primary}30`,fontSize:"0.75rem"}}},MuiSelect:{styleOverrides:{select:{...lightGlassEffect_light,"&amp;:focus":{backgroundColor:"rgba(255, 255, 255, 0.8)"}}}},MuiMenu:{styleOverrides:{paper:{...lightGlassEffect_medium,boxShadow:`0 8px 32px ${sesColorPalette.primaryDark}20`}}},MuiMenuItem:{styleOverrides:{root:{"&amp;:hover":{backgroundColor:`${sesColorPalette.primary}10`},"&amp;.Mui-selected":{backgroundColor:`${sesColorPalette.primary}20`,"&amp;:hover":{backgroundColor:`${sesColorPalette.primary}30`}}}}},MuiDialog:{styleOverrides:{paper:{...lightGlassEffect_medium,boxShadow:`0 8px 32px ${sesColorPalette.primaryDark}30`}}}}});const app=initializeApp({apiKey:"AIzaSyDw6olWUfzfvptwklxb-UtK9K5Snrttlak",authDomain:"building-vitals.firebaseapp.com",projectId:"building-vitals",storageBucket:"building-vitals.firebasestorage.app",messagingSenderId:"763711142996",appId:"1:763711142996:web:183060d72d1139eb6d81c1",measurementId:"G-9C1FZSRSM4"}),auth=getAuth(app),db=initializeFirestore(app,{localCache:persistentLocalCache({tabManager:persistentMultipleTabManager()})});getStorage(app);const functions=getFunctions(app),firebaseFunctions={httpsCallable:functionName=&gt;httpsCallable(functions,functionName)},getFirebaseAuth=()=&gt;auth;let analytics=null;isSupported().then(supported=&gt;{if(supported)try{analytics=getAnalytics(app),console.log("âœ“ Analytics initialized successfully")}catch(error){console.warn("Analytics initialization failed:",error instanceof Error?error.message:"Unknown error")}else console.info("Analytics not supported in this browser")}).catch(error=&gt;{console.warn("Analytics support check failed:",error instanceof Error?error.message:"Unknown error")}),console.info("App Check disabled: Configure valid ReCAPTCHA v3 key in production"),isWindowSupported().then(supported=&gt;{supported&amp;&amp;getMessagingInWindow(app)}).catch(error=&gt;{console.warn("Failed to initialize Firebase Messaging:",error)});const googleProvider=new GoogleAuthProvider;googleProvider.setCustomParameters({prompt:"select_account"});const microsoftProvider=new OAuthProvider("microsoft.com");microsoftProvider.setCustomParameters({prompt:"select_account",tenant:"common"}),microsoftProvider.addScope("email"),microsoftProvider.addScope("profile");const authSlice=createSlice({name:"auth",initialState:{isAuthenticated:!1,loading:!0,loadingProfile:!1,tokenLoading:!1,firebaseUser:null,userProfile:null,aceToken:null,tokenExpiresAt:null,error:null},reducers:{authStart:state=&gt;{state.loading=!0,state.error=null},setFirebaseUser:(state,action)=&gt;{state.firebaseUser=action.payload,state.isAuthenticated=!!action.payload,state.loading=!1,state.error=null,action.payload||(state.userProfile=null,state.aceToken=null,state.loadingProfile=!1)},loadProfileStart:state=&gt;{state.loadingProfile=!0,state.error=null},setUserProfile:(state,action)=&gt;{state.userProfile=action.payload.profile,state.loadingProfile=!1},setAceToken:(state,action)=&gt;{const token=action.payload.token;if(null!==token&amp;&amp;token.length&lt;50)return console.warn("[AuthSlice] Token too short - JWT tokens should be at least 50 characters"),void(state.tokenLoading=!1);state.aceToken=token,state.tokenExpiresAt=action.payload.expiresAt||null,state.tokenLoading=!1},tokenLoadStart:state=&gt;{state.tokenLoading=!0,state.error=null},tokenLoadComplete:state=&gt;{state.tokenLoading=!1},authFailure:(state,action)=&gt;{state.loading=!1,state.loadingProfile=!1,state.error=action.payload},logout:state=&gt;{state.isAuthenticated=!1,state.firebaseUser=null,state.userProfile=null,state.aceToken=null,state.tokenExpiresAt=null,state.loading=!1,state.loadingProfile=!1,state.tokenLoading=!1,state.error=null},clearError:state=&gt;{state.error=null}}}),{authStart:authStart,setFirebaseUser:setFirebaseUser,loadProfileStart:loadProfileStart,setUserProfile:setUserProfile,setAceToken:setAceToken$1,tokenLoadStart:tokenLoadStart,tokenLoadComplete:tokenLoadComplete,authFailure:authFailure,logout:logout,clearError:clearError}=authSlice.actions,authSlice$1=authSlice.reducer,authSlice$2=Object.freeze(Object.defineProperty({__proto__:null,authFailure:authFailure,authStart:authStart,clearError:clearError,default:authSlice$1,loadProfileStart:loadProfileStart,logout:logout,setAceToken:setAceToken$1,setFirebaseUser:setFirebaseUser,setUserProfile:setUserProfile,tokenLoadComplete:tokenLoadComplete,tokenLoadStart:tokenLoadStart},Symbol.toStringTag,{value:"Module"})),isSite=obj=&gt;obj&amp;&amp;"object"==typeof obj&amp;&amp;"string"==typeof obj.id&amp;&amp;"string"==typeof obj.name&amp;&amp;"string"==typeof obj.client,isDevice=obj=&gt;obj&amp;&amp;"object"==typeof obj&amp;&amp;"string"==typeof obj.id&amp;&amp;"string"==typeof obj.name&amp;&amp;"string"==typeof obj.siteId,isPoint=obj=&gt;obj&amp;&amp;"object"==typeof obj&amp;&amp;"string"==typeof obj.id&amp;&amp;"string"==typeof obj.name&amp;&amp;"string"==typeof obj.client&amp;&amp;"string"==typeof obj.site&amp;&amp;"string"==typeof obj.siteId,isTimeSeriesDataPoint=obj=&gt;obj&amp;&amp;"object"==typeof obj&amp;&amp;"number"==typeof obj.timestamp&amp;&amp;(null===obj.value||"number"==typeof obj.value||"string"==typeof obj.value||"boolean"==typeof obj.value),validateSites=data=&gt;{if(!Array.isArray(data))throw new Error("Sites data must be an array");const validSites=data.filter(isSite);return validSites.length!==data.length&amp;&amp;console.warn(`Validated ${validSites.length} out of ${data.length} sites`),validSites},validateTimeSeriesData=data=&gt;{if(!((obj=data)&amp;&amp;"object"==typeof obj&amp;&amp;"string"==typeof obj.pointId&amp;&amp;"string"==typeof obj.pointName&amp;&amp;Array.isArray(obj.data)&amp;&amp;obj.data.every(isTimeSeriesDataPoint)))throw new Error("Invalid time series data structure");var obj;return data},sitesSlice=createSlice({name:"sites",initialState:{sites:[],devices:{},points:{},isLoading:!1,error:null,lastUpdated:null},reducers:{setSites:(state,action)=&gt;{try{state.sites=validateSites(action.payload),state.lastUpdated=(new Date).toISOString(),state.error=null}catch(error){state.error=error instanceof Error?error.message:"Failed to set sites"}},addSite:(state,action)=&gt;{try{const validatedSite=validateSites([action.payload])[0];validatedSite&amp;&amp;!state.sites.find(s=&gt;s.id===validatedSite.id)&amp;&amp;(state.sites.push(validatedSite),state.lastUpdated=(new Date).toISOString())}catch(error){state.error=error instanceof Error?error.message:"Failed to add site"}},removeSite:(state,action)=&gt;{state.sites=state.sites.filter(site=&gt;site.id!==action.payload),delete state.devices[action.payload],delete state.points[action.payload],delete state.points[`site_${action.payload}`],delete state.points[`points_${action.payload}`],state.lastUpdated=(new Date).toISOString()},setDevices:(state,action)=&gt;{try{state.devices[action.payload.siteId]=(data=&gt;{if(!Array.isArray(data))throw new Error("Devices data must be an array");const validDevices=data.filter(isDevice);return validDevices.length!==data.length&amp;&amp;console.warn(`Validated ${validDevices.length} out of ${data.length} devices`),validDevices})(action.payload.devices),state.lastUpdated=(new Date).toISOString(),state.error=null}catch(error){state.error=error instanceof Error?error.message:"Failed to set devices"}},removeDevices:(state,action)=&gt;{delete state.devices[action.payload],state.lastUpdated=(new Date).toISOString()},setPoints:(state,action)=&gt;{try{state.points[action.payload.key]=(data=&gt;{if(!Array.isArray(data))throw new Error("Points data must be an array");const validPoints=data.filter(isPoint);return validPoints.length!==data.length&amp;&amp;console.warn(`Validated ${validPoints.length} out of ${data.length} points`),validPoints})(action.payload.points),state.lastUpdated=(new Date).toISOString(),state.error=null}catch(error){state.error=error instanceof Error?error.message:"Failed to set points"}},removePoints:(state,action)=&gt;{delete state.points[action.payload],state.lastUpdated=(new Date).toISOString()},clearSitesData:state=&gt;{state.sites=[],state.devices={},state.points={},state.error=null,state.lastUpdated=null},clearDataType:(state,action)=&gt;{switch(action.payload){case"sites":state.sites=[];break;case"devices":state.devices={};break;case"points":state.points={}}state.lastUpdated=(new Date).toISOString()},setSitesLoading:(state,action)=&gt;{state.isLoading=action.payload},setSitesError:(state,action)=&gt;{state.error=action.payload}}}),{setSites:setSites,addSite:addSite,removeSite:removeSite,setDevices:setDevices,removeDevices:removeDevices,setPoints:setPoints,removePoints:removePoints,clearSitesData:clearSitesData,clearDataType:clearDataType,setSitesLoading:setSitesLoading,setSitesError:setSitesError}=sitesSlice.actions,sitesSlice$1=sitesSlice.reducer,timeseriesSlice=createSlice({name:"timeseries",initialState:{timeSeries:{},isLoading:!1,error:null,lastUpdated:null},reducers:{setTimeSeriesData:(state,action)=&gt;{try{state.timeSeries[action.payload.key]=validateTimeSeriesData(action.payload.data),state.lastUpdated=(new Date).toISOString(),state.error=null}catch(error){state.error=error instanceof Error?error.message:"Failed to set time series data"}},setMultipleTimeSeries:(state,action)=&gt;{try{action.payload.forEach(({key:key,data:data})=&gt;{state.timeSeries[key]=validateTimeSeriesData(data)}),state.lastUpdated=(new Date).toISOString(),state.error=null}catch(error){state.error=error instanceof Error?error.message:"Failed to set time series data"}},removeTimeSeriesData:(state,action)=&gt;{delete state.timeSeries[action.payload],state.lastUpdated=(new Date).toISOString()},clearTimeSeriesData:state=&gt;{state.timeSeries={},state.error=null,state.lastUpdated=null},setTimeSeriesLoading:(state,action)=&gt;{state.isLoading=action.payload},setTimeSeriesError:(state,action)=&gt;{state.error=action.payload}}}),{setTimeSeriesData:setTimeSeriesData,setMultipleTimeSeries:setMultipleTimeSeries,removeTimeSeriesData:removeTimeSeriesData,clearTimeSeriesData:clearTimeSeriesData,setTimeSeriesLoading:setTimeSeriesLoading,setTimeSeriesError:setTimeSeriesError}=timeseriesSlice.actions,timeseriesSlice$1=timeseriesSlice.reducer,dataReducer=combineReducers({sites:sitesSlice$1,timeseries:timeseriesSlice$1}),alertsSlice=createSlice({name:"alerts",initialState:{rules:[],activeAlerts:[],alertHistory:[],stats:null,isLoading:!1,error:null,lastUpdated:null},reducers:{setAlertRules:(state,action)=&gt;{state.rules=action.payload,state.lastUpdated=(new Date).toISOString(),state.error=null},addAlertRule:(state,action)=&gt;{state.rules.find(r=&gt;r.id===action.payload.id)||(state.rules.push(action.payload),state.lastUpdated=(new Date).toISOString())},updateAlertRule:(state,action)=&gt;{const index2=state.rules.findIndex(r=&gt;r.id===action.payload.id);-1!==index2&amp;&amp;(state.rules[index2]=action.payload,state.lastUpdated=(new Date).toISOString())},removeAlertRule:(state,action)=&gt;{state.rules=state.rules.filter(rule=&gt;rule.id!==action.payload),state.lastUpdated=(new Date).toISOString()},setActiveAlerts:(state,action)=&gt;{state.activeAlerts=action.payload,state.lastUpdated=(new Date).toISOString(),state.error=null},addActiveAlert:(state,action)=&gt;{state.activeAlerts.find(a=&gt;a.id===action.payload.id)||(state.activeAlerts.unshift(action.payload),state.lastUpdated=(new Date).toISOString())},updateActiveAlert:(state,action)=&gt;{const index2=state.activeAlerts.findIndex(a=&gt;a.id===action.payload.id);-1!==index2&amp;&amp;(state.activeAlerts[index2]=action.payload,state.lastUpdated=(new Date).toISOString())},acknowledgeAlert:(state,action)=&gt;{const alert=state.activeAlerts.find(a=&gt;a.id===action.payload.alertId);alert&amp;&amp;(alert.status="acknowledged",alert.acknowledgedAt=(new Date).toISOString(),alert.acknowledgedBy=action.payload.acknowledgedBy,state.lastUpdated=(new Date).toISOString())},resolveAlert:(state,action)=&gt;{const index2=state.activeAlerts.findIndex(a=&gt;a.id===action.payload.alertId);if(-1!==index2){const alert=state.activeAlerts[index2];alert.status="resolved",alert.resolvedAt=(new Date).toISOString(),alert.resolvedBy=action.payload.resolvedBy,state.alertHistory.unshift(alert),state.activeAlerts.splice(index2,1),state.lastUpdated=(new Date).toISOString()}},setAlertHistory:(state,action)=&gt;{state.alertHistory=action.payload,state.lastUpdated=(new Date).toISOString()},clearAlertHistory:state=&gt;{state.alertHistory=[],state.lastUpdated=(new Date).toISOString()},setAlertStats:(state,action)=&gt;{state.stats=action.payload,state.lastUpdated=(new Date).toISOString()},clearAlertsData:state=&gt;{state.rules=[],state.activeAlerts=[],state.alertHistory=[],state.stats=null,state.error=null,state.lastUpdated=null},setAlertsLoading:(state,action)=&gt;{state.isLoading=action.payload},setAlertsError:(state,action)=&gt;{state.error=action.payload}}}),{setAlertRules:setAlertRules,addAlertRule:addAlertRule,updateAlertRule:updateAlertRule,removeAlertRule:removeAlertRule,setActiveAlerts:setActiveAlerts,addActiveAlert:addActiveAlert,updateActiveAlert:updateActiveAlert,acknowledgeAlert:acknowledgeAlert,resolveAlert:resolveAlert,setAlertHistory:setAlertHistory,clearAlertHistory:clearAlertHistory,setAlertStats:setAlertStats,clearAlertsData:clearAlertsData,setAlertsLoading:setAlertsLoading,setAlertsError:setAlertsError}=alertsSlice.actions,alertsSlice$1=alertsSlice.reducer,userSlice=createSlice({name:"user",initialState:{users:[],currentUser:null,permissions:{},isLoading:!1,error:null,lastUpdated:null},reducers:{setUsers:(state,action)=&gt;{state.users=action.payload,state.lastUpdated=(new Date).toISOString(),state.error=null},addUser:(state,action)=&gt;{state.users.find(u=&gt;u.id===action.payload.id)||(state.users.push(action.payload),state.lastUpdated=(new Date).toISOString())},updateUser:(state,action)=&gt;{var _a;const index2=state.users.findIndex(u=&gt;u.id===action.payload.id);-1!==index2&amp;&amp;(state.users[index2]=action.payload,(null==(_a=state.currentUser)?void 0:_a.id)===action.payload.id&amp;&amp;(state.currentUser=action.payload),state.lastUpdated=(new Date).toISOString())},removeUser:(state,action)=&gt;{state.users=state.users.filter(user=&gt;user.id!==action.payload),state.lastUpdated=(new Date).toISOString()},setCurrentUser:(state,action)=&gt;{state.currentUser=action.payload,state.lastUpdated=(new Date).toISOString()},updateCurrentUserPreferences:(state,action)=&gt;{state.currentUser&amp;&amp;(state.currentUser.preferences={...state.currentUser.preferences,...action.payload},state.lastUpdated=(new Date).toISOString())},updateCurrentUserMetadata:(state,action)=&gt;{state.currentUser&amp;&amp;(state.currentUser.metadata={...state.currentUser.metadata,...action.payload},state.lastUpdated=(new Date).toISOString())},setPermissions:(state,action)=&gt;{state.permissions=action.payload,state.lastUpdated=(new Date).toISOString()},updatePermission:(state,action)=&gt;{state.permissions[action.payload.permission]=action.payload.value,state.lastUpdated=(new Date).toISOString()},clearUserData:state=&gt;{state.users=[],state.currentUser=null,state.permissions={},state.error=null,state.lastUpdated=null},setUserLoading:(state,action)=&gt;{state.isLoading=action.payload},setUserError:(state,action)=&gt;{state.error=action.payload}}}),{setUsers:setUsers,addUser:addUser,updateUser:updateUser,removeUser:removeUser,setCurrentUser:setCurrentUser,updateCurrentUserPreferences:updateCurrentUserPreferences,updateCurrentUserMetadata:updateCurrentUserMetadata,setPermissions:setPermissions,updatePermission:updatePermission,clearUserData:clearUserData,setUserLoading:setUserLoading,setUserError:setUserError}=userSlice.actions,userSlice$1=userSlice.reducer,notificationSlice=createSlice({name:"notification",initialState:{notifications:[],maxNotifications:5},reducers:{addNotification:(state,action)=&gt;{const notification={...action.payload,id:`notification-${Date.now()}-${Math.random()}`,timestamp:Date.now(),duration:action.payload.duration||5e3};state.notifications.unshift(notification),state.notifications.length&gt;state.maxNotifications&amp;&amp;(state.notifications=state.notifications.slice(0,state.maxNotifications))},removeNotification:(state,action)=&gt;{state.notifications=state.notifications.filter(n=&gt;n.id!==action.payload)},clearNotification:state=&gt;{state.notifications.length&gt;0&amp;&amp;state.notifications.pop()},clearAllNotifications:state=&gt;{state.notifications=[]},setMaxNotifications:(state,action)=&gt;{state.maxNotifications=action.payload,state.notifications.length&gt;action.payload&amp;&amp;(state.notifications=state.notifications.slice(0,action.payload))}}}),{addNotification:addNotification,removeNotification:removeNotification,clearNotification:clearNotification,clearAllNotifications:clearAllNotifications,setMaxNotifications:setMaxNotifications}=notificationSlice.actions,notificationSlice$1=notificationSlice.reducer,initialState={dashboards:[],activeDashboardId:null,isLoading:!1,error:null,isSaving:!1},dashboardSlice=createSlice({name:"dashboard",initialState:initialState,reducers:{setDashboards:(state,action)=&gt;{state.dashboards=action.payload,state.error=null},addDashboard:(state,action)=&gt;{const newDashboard={...action.payload},existingNames=state.dashboards.map(d=&gt;d.name);if(existingNames.includes(newDashboard.name)){let counter=2,uniqueName=`${newDashboard.name} (${counter})`;for(;existingNames.includes(uniqueName);)counter++,uniqueName=`${newDashboard.name} (${counter})`;newDashboard.name=uniqueName}state.dashboards.push(newDashboard)},updateDashboard:(state,action)=&gt;{const index2=state.dashboards.findIndex(d=&gt;d.id===action.payload.id);-1!==index2&amp;&amp;(state.dashboards[index2]={...state.dashboards[index2],...action.payload.updates,updatedAt:(new Date).toISOString()})},deleteDashboard:(state,action)=&gt;{state.dashboards=state.dashboards.filter(d=&gt;d.id!==action.payload),state.activeDashboardId===action.payload&amp;&amp;(state.activeDashboardId=state.dashboards.length&gt;0?state.dashboards[0].id:null)},setActiveDashboard:(state,action)=&gt;{state.activeDashboardId=action.payload},addVisualization:(state,action)=&gt;{const dashboard=state.dashboards.find(d=&gt;d.id===action.payload.dashboardId);dashboard&amp;&amp;(dashboard.visualizations.push(action.payload.visualization),dashboard.updatedAt=(new Date).toISOString())},updateVisualization:(state,action)=&gt;{const dashboard=state.dashboards.find(d=&gt;d.id===action.payload.dashboardId);if(dashboard){const vizIndex=dashboard.visualizations.findIndex(v=&gt;v.id===action.payload.visualizationId);-1!==vizIndex&amp;&amp;(dashboard.visualizations[vizIndex]={...dashboard.visualizations[vizIndex],...action.payload.updates},dashboard.updatedAt=(new Date).toISOString())}},removeVisualization:(state,action)=&gt;{const dashboard=state.dashboards.find(d=&gt;d.id===action.payload.dashboardId);dashboard&amp;&amp;(dashboard.visualizations=dashboard.visualizations.filter(v=&gt;v.id!==action.payload.visualizationId),dashboard.updatedAt=(new Date).toISOString())},updateLayout:(state,action)=&gt;{const dashboard=state.dashboards.find(d=&gt;d.id===action.payload.dashboardId);dashboard&amp;&amp;(dashboard.layout=action.payload.layout,dashboard.updatedAt=(new Date).toISOString())},updateDashboardPermissions:(state,action)=&gt;{const dashboard=state.dashboards.find(d=&gt;d.id===action.payload.dashboardId);dashboard&amp;&amp;(dashboard.permissions={...dashboard.permissions,...action.payload.permissions},dashboard.updatedAt=(new Date).toISOString())},setLoading:(state,action)=&gt;{state.isLoading=action.payload},setSaving:(state,action)=&gt;{state.isSaving=action.payload},setError:(state,action)=&gt;{state.error=action.payload},resetDashboardState:()=&gt;initialState}}),{setDashboards:setDashboards,addDashboard:addDashboard,updateDashboard:updateDashboard,deleteDashboard:deleteDashboard,setActiveDashboard:setActiveDashboard,addVisualization:addVisualization,updateVisualization:updateVisualization,removeVisualization:removeVisualization,updateLayout:updateLayout,updateDashboardPermissions:updateDashboardPermissions,setLoading:setLoading,setSaving:setSaving,setError:setError,resetDashboardState:resetDashboardState}=dashboardSlice.actions,dashboardSlice$1=dashboardSlice.reducer,baseApi=createApi({reducerPath:"api",baseQuery:retry(fetchBaseQuery({baseUrl:"https://building-vitals-api-763711142996.us-central1.run.app",prepareHeaders:(headers,{getState:getState})=&gt;{const token=getState().auth.aceToken;return token&amp;&amp;(headers.set("authorization",`Bearer ${token}`),headers.set("X-ACE-Token",token)),headers.set("Content-Type","application/json"),headers}}),{maxRetries:3}),tagTypes:["Site","Point","Monitor","Dashboard","TimeSeriesData","User","Settings"],endpoints:()=&gt;({})}),authPersistConfig={key:"auth",version:1,storage:storage,whitelist:["aceToken","tokenExpiresAt","firebaseUser","isAuthenticated"],debug:!0,migrate:state=&gt;(null==state?void 0:state.isAuthenticated)&amp;&amp;!state.aceToken?(console.log("Migration: Clearing auth state without token"),Promise.resolve({...state,isAuthenticated:!1,firebaseUser:null})):Promise.resolve(state)},persistedAuthReducer=persistReducer(authPersistConfig,authSlice$1);console.log("Redux persist config:",authPersistConfig);const store=configureStore({reducer:{auth:persistedAuthReducer,ui:uiSlice$1,data:dataReducer,sites:sitesSlice$1,timeseries:timeseriesSlice$1,alerts:alertsSlice$1,user:userSlice$1,notification:notificationSlice$1,dashboard:dashboardSlice$1,[baseApi.reducerPath]:baseApi.reducer},middleware:getDefaultMiddleware=&gt;getDefaultMiddleware({serializableCheck:{ignoredActions:["persist/PERSIST","persist/REHYDRATE",FLUSH,REHYDRATE,PAUSE,PERSIST,PURGE,REGISTER]}}).concat(baseApi.middleware)});setupListeners(store.dispatch);const persistor=persistStore(store);store.subscribe(()=&gt;{const state=store.getState();state.auth.aceToken&amp;&amp;console.log("Redux auth state updated - token present:",!!state.auth.aceToken)}),"undefined"!=typeof window&amp;&amp;(window.store=store,window.persistor=persistor);const index=Object.freeze(Object.defineProperty({__proto__:null,default:store,persistor:persistor},Symbol.toStringTag,{value:"Module"}));var LogLevel=(LogLevel2=&gt;(LogLevel2[LogLevel2.DEBUG=0]="DEBUG",LogLevel2[LogLevel2.INFO=1]="INFO",LogLevel2[LogLevel2.WARN=2]="WARN",LogLevel2[LogLevel2.ERROR=3]="ERROR",LogLevel2[LogLevel2.NONE=4]="NONE",LogLevel2))(LogLevel||{});class Logger{constructor(source,loggerInstance){this.source=source,this.loggerInstance=loggerInstance}debug(message,metadata,...args){this.loggerInstance.debug(this.source,message,metadata,...args)}info(message,metadata,...args){this.loggerInstance.info(this.source,message,metadata,...args)}warn(message,metadata,...args){this.loggerInstance.warn(this.source,message,metadata,...args)}error(message,metadata,...args){this.loggerInstance.error(this.source,message,metadata,...args)}log(message,metadata,...args){this.loggerInstance.log(this.source,message,metadata,...args)}startTimer(name){return this.loggerInstance.startTimer(name,this.source)}endTimer(name){return this.loggerInstance.endTimer(name)}time(name,fn){return this.loggerInstance.time(name,fn,this.source)}async timeAsync(name,fn){return this.loggerInstance.timeAsync(name,fn,this.source)}}const globalLogger=new class LoggerInstance{constructor(){__publicField(this,"config",{level:0,enabledSources:[],disabledSources:[],enablePerformanceLogging:!0,maxMetadataSize:1e3}),__publicField(this,"timers",new Map),__publicField(this,"isDevelopment",!1)}configure(config){this.config={...this.config,...config}}getConfig(){return{...this.config}}shouldLog(level,source){return!(!this.isDevelopment&amp;&amp;3!==level)&amp;&amp;(!(level&lt;this.config.level)&amp;&amp;(!this.config.disabledSources.includes(source)&amp;&amp;!(this.config.enabledSources.length&gt;0&amp;&amp;!this.config.enabledSources.includes(source))))}formatMessage(level,source,message){return`${(new Date).toISOString().substr(11,12)} [${LogLevel[level].padEnd(5)}][${source}] ${message}`}sanitizeMetadata(metadata){if(metadata)try{const serialized=JSON.stringify(metadata);return serialized.length&gt;this.config.maxMetadataSize?{...metadata,_truncated:!0,_originalSize:serialized.length}:metadata}catch(error){return{_error:"Failed to serialize metadata",_originalType:typeof metadata}}}doLog(level,source,message,metadata,...args){if(!this.shouldLog(level,source))return;const formattedMessage=this.formatMessage(level,source,message),enhancedMetadata={...this.sanitizeMetadata(metadata),timestamp:(new Date).toISOString(),source:source,level:LogLevel[level]};switch(level){case 0:console.debug(formattedMessage,enhancedMetadata,...args);break;case 1:console.info(formattedMessage,enhancedMetadata,...args);break;case 2:console.warn(formattedMessage,enhancedMetadata,...args);break;case 3:console.error(formattedMessage,enhancedMetadata,...args)}}startTimer(name,source="Timer"){const timer={name:name,startTime:performance.now(),end:()=&gt;{const duration=performance.now()-timer.startTime;return this.timers.delete(name),this.config.enablePerformanceLogging&amp;&amp;this.doLog(0,source,`Timer "${name}" completed`,{performance:{duration:Math.round(100*duration)/100}}),duration}};return this.timers.set(name,timer),timer}endTimer(name){const timer=this.timers.get(name);return timer?timer.end():null}time(name,fn,source="Timer"){const timer=this.startTimer(name,source);try{const result=fn();return timer.end(),result}catch(error){throw timer.end(),this.doLog(3,source,`Timer "${name}" failed`,{error:error}),error}}async timeAsync(name,fn,source="Timer"){const timer=this.startTimer(name,source);try{const result=await fn();return timer.end(),result}catch(error){throw timer.end(),this.doLog(3,source,`Async timer "${name}" failed`,{error:error}),error}}createLogger(source){return new Logger(source,this)}debug(source,message,metadata,...args){this.doLog(0,source,message,metadata,...args)}info(source,message,metadata,...args){this.doLog(1,source,message,metadata,...args)}warn(source,message,metadata,...args){this.doLog(2,source,message,metadata,...args)}error(source,message,metadata,...args){this.doLog(3,source,message,metadata,...args)}log(source,message,metadata,...args){this.doLog(1,source,message,metadata,...args)}};globalLogger.configure({level:3,enablePerformanceLogging:!1});const createLogger=source=&gt;globalLogger.createLogger(source);const cloudflareWorkerClient=new class CloudflareWorkerClient{constructor(){__publicField(this,"baseUrl"),__publicField(this,"apiService",null),this.baseUrl="https://ace-iot-consolidated-proxy.jstahr.workers.dev",this.initializeService()}initializeService(){const token=getAceApiToken();this.baseUrl&amp;&amp;token&amp;&amp;(this.apiService=initializeBatchApiService$1(this.baseUrl,token))}setToken(token){if(!validateAceToken(token))return console.error("[CloudflareWorkerClient] Invalid ACE API token format"),console.error("[CloudflareWorkerClient] ACE API requires site/device tokens, not JWT"),void console.warn("[CloudflareWorkerClient] Run clearInvalidToken() to remove invalid tokens");setAceApiToken(token),this.initializeService()}getToken(){return getAceApiToken()}async fetchSites(){const token=getAceApiToken();if(!token)throw console.error("[CloudflareWorkerClient] No ACE API token available"),new Error("No ACE API token available. Please configure your ACE API token in Settings.");console.log("[CloudflareWorkerClient] Fetching sites from:",`${this.baseUrl}/api/sites`);const response=await fetch(`${this.baseUrl}/api/sites`,{headers:{"X-ACE-Token":token}});if(!response.ok){console.error(`[CloudflareWorkerClient] Failed to fetch sites: ${response.status} ${response.statusText}`);const errorText=await response.text();throw console.error("[CloudflareWorkerClient] Error response:",errorText),new Error(`Failed to fetch sites: ${response.statusText}`)}const data=await response.json();return console.log("[CloudflareWorkerClient] Sites response:",data),Array.isArray(data)?{items:data}:data}async fetchPoints(siteId,bypassCache=!1){const token=getAceApiToken();if(!token)throw console.error("[CloudflareWorkerClient] No ACE API token available"),new Error("No ACE API token available. Please configure your ACE API token in Settings.");let url=siteId?`${this.baseUrl}/api/sites/${siteId}/configured_points`:`${this.baseUrl}/api/points`;bypassCache&amp;&amp;(url+="?bypass_cache=true",console.log("[CloudflareWorkerClient] Cache bypass requested")),console.log("[CloudflareWorkerClient] Fetching points from:",url);const response=await fetch(url,{headers:{"X-ACE-Token":token}});if(!response.ok)throw console.error(`[CloudflareWorkerClient] Failed to fetch points: ${response.status} ${response.statusText}`),new Error(`Failed to fetch points: ${response.statusText}`);const data=await response.json();return Array.isArray(data)?{items:data}:data}async getSites(){return this.fetchSites()}async getPoints(){return this.fetchPoints()}async getTimeseries(pointNames,startTime,endTime){var _a;const token=getAceApiToken();if(!token)throw console.error("[CloudflareWorkerClient] No ACE API token available"),new Error("No ACE API token available. Please configure your ACE API token in Settings.");const pathParts=(pointNames[0]||"").split("/"),siteName=pathParts.length&gt;1?pathParts[1]:"ses_falls_city";console.log("[CloudflareWorkerClient] Using paginated endpoint:",{siteName:siteName,pointCount:pointNames.length,timeRange:`${startTime} to ${endTime}`});const startTimeISO=startTime instanceof Date?startTime.toISOString():startTime,endTimeISO=endTime instanceof Date?endTime.toISOString():endTime,url=new URL(`${this.baseUrl}/api/sites/${siteName}/timeseries/paginated`);url.searchParams.set("start_time",startTimeISO),url.searchParams.set("end_time",endTimeISO),url.searchParams.set("raw_data","true"),url.searchParams.set("page_size","100000");let allSamples=[],cursor=null,hasMore=!0,pageCount=0;for(;hasMore;){pageCount++,cursor&amp;&amp;url.searchParams.set("cursor",cursor),console.log(`[CloudflareWorkerClient] Fetching page ${pageCount}`,{cursor:cursor?cursor.substring(0,20)+"...":"initial"});const response=await fetch(url.toString(),{headers:{"X-ACE-Token":token,"Content-Type":"application/json"}});if(!response.ok){const errorText=await response.text();throw console.error("[CloudflareWorkerClient] Paginated request failed:",{status:response.status,statusText:response.statusText,error:errorText}),new Error(`Failed to fetch paginated timeseries: ${response.status} ${response.statusText}`)}const data=await response.json();if(allSamples.push(...data.point_samples||[]),cursor=data.next_cursor,hasMore=data.has_more,console.log(`[CloudflareWorkerClient] Page ${pageCount} fetched:`,{samplesInPage:(null==(_a=data.point_samples)?void 0:_a.length)||0,totalSamples:allSamples.length,hasMore:hasMore,cacheStatus:response.headers.get("X-Cache")}),pageCount&gt;1e3)throw console.error("[CloudflareWorkerClient] Too many pages, aborting"),new Error("Pagination exceeded safety limit (1000 pages)")}console.log("[CloudflareWorkerClient] Pagination complete:",{totalPages:pageCount,totalSamples:allSamples.length});const selectedPointNames=new Set(pointNames),filteredSamples=allSamples.filter(sample=&gt;selectedPointNames.has(sample.name));console.log("[CloudflareWorkerClient] Filtered samples:",{totalSamples:allSamples.length,filteredSamples:filteredSamples.length,selectedPoints:pointNames.length});const groupedByPoint={};return pointNames.forEach(pointName=&gt;{groupedByPoint[pointName]=[]}),filteredSamples.forEach(sample=&gt;{if(groupedByPoint[sample.name]){const timestamp=new Date(sample.time).getTime(),value=parseFloat(sample.value);groupedByPoint[sample.name].push([timestamp,value])}}),Object.keys(groupedByPoint).forEach(pointName=&gt;{groupedByPoint[pointName].sort((a,b)=&gt;a[0]-b[0])}),{point_samples:pointNames.map(pointName=&gt;({pointName:pointName,pointId:pointName,data:groupedByPoint[pointName]||[],unit:""}))}}},cloudflareWorkerClient$1=Object.freeze(Object.defineProperty({__proto__:null,cloudflareWorkerClient:cloudflareWorkerClient},Symbol.toStringTag,{value:"Module"})),getApiService=()=&gt;cloudflareWorkerClient,updateDirectApiToken=token=&gt;{token&amp;&amp;__vitePreload(async()=&gt;{const{validateAceToken:validateAceToken2}=await import("./services-B0KkmCks.js").then(n=&gt;n.E);return{validateAceToken:validateAceToken2}},__vite__mapDeps([0,1,2,3,4,5,6,7])).then(({validateAceToken:validateAceToken2})=&gt;{if(validateAceToken2(token))try{cloudflareWorkerClient.setToken(token)}catch(error){console.error("[API] Failed to set token:",error instanceof Error?error.message:"Unknown error"),console.warn("[API] If you see JWT errors, run clearInvalidToken() in console")}else console.warn("[API] Invalid ACE API token format - token not updated"),console.warn("[API] ACE API tokens must be 20+ characters, alphanumeric with hyphens/underscores"),console.warn("[API] JWT tokens (containing dots) are not valid for ACE API"),console.warn("[API] Run clearInvalidToken() to remove invalid tokens"),console.warn("[API] Then configure a valid ACE API token in Settings")}).catch(err=&gt;{console.error("[API] Failed to import aceTokenResolver:",err)})},api=Object.freeze(Object.defineProperty({__proto__:null,clearApiCache:()=&gt;{console.log("Cache is managed by Cloudflare Worker")},getApiService:getApiService,updateDirectApiToken:updateDirectApiToken},Symbol.toStringTag,{value:"Module"})),logger$1_info=(message,...args)=&gt;console.log(`[TokenService] ${message}`,...args),logger$1_warn=(message,...args)=&gt;console.warn(`[TokenService] ${message}`,...args),logger$1_error=(message,...args)=&gt;console.error(`[TokenService] ${message}`,...args);class TokenService{constructor(){__publicField(this,"tokenCache",new Map)}async saveToken(userId,token,persistent=!0){var _a,_b;try{logger$1_info("saveToken called",{userId:userId,tokenLength:token.length,persistent:persistent});const cleanedToken=token.trim().replace(/[\s\r\n]+/g,"");if(logger$1_info("Token cleaned",{cleanedLength:cleanedToken.length}),!this.isValidJWT(cleanedToken))throw logger$1_error("Invalid token format"),new Error("Invalid token format");const decoded=this.decodeToken(cleanedToken);logger$1_info("Token decoded successfully",{exp:decoded.exp}),logger$1_info("Storing token in secure storage..."),await secureStorage.setAceToken(cleanedToken,persistent),logger$1_info("Token stored in secure storage"),logger$1_info("Generating token hash...");const tokenHash=await encryptionService.hashToken(cleanedToken);logger$1_info("Token hash generated successfully"),logger$1_info("Encrypting token for Firestore...");const encryptedToken=await encryptionService.encrypt(cleanedToken,userId);logger$1_info("Token encrypted successfully");if(db){logger$1_info("Storing encrypted token in Firestore...");let retries=3,lastError=null;for(;retries&gt;0;)try{const userRef=doc(db,"users",userId);(await getDoc(userRef)).exists()?(await setDoc(userRef,{aceJwt:encryptedToken,aceJwtHash:tokenHash,aceJwtIsEncrypted:!0,aceJwtUpdatedAt:(new Date).toISOString(),aceJwtExpiresAt:decoded.exp?new Date(1e3*decoded.exp).toISOString():null},{merge:!0}),logger$1_info("Updated existing user document with encrypted token")):(logger$1_warn("User document does not exist, creating with basic fields..."),await setDoc(userRef,{uid:userId,email:(null==(_a=auth.currentUser)?void 0:_a.email)||"",createdAt:(new Date).toISOString(),aceJwt:encryptedToken,aceJwtHash:tokenHash,aceJwtIsEncrypted:!0,aceJwtUpdatedAt:(new Date).toISOString(),aceJwtExpiresAt:decoded.exp?new Date(1e3*decoded.exp).toISOString():null}),logger$1_info("Created new user document with encrypted token"));const verifyDoc=await getDoc(userRef),verifyData=verifyDoc.data();logger$1_info("Verification after save:",{docExists:verifyDoc.exists(),hasToken:!!(null==verifyData?void 0:verifyData.aceJwt),hasHash:!!(null==verifyData?void 0:verifyData.aceJwtHash)});break}catch(error){if(lastError=error,retries--,!(null==(_b=null==error?void 0:error.message)?void 0:_b.includes("terminated"))&amp;&amp;"failed-precondition"!==(null==error?void 0:error.code))throw error;logger$1_warn(`Firestore client error (${retries} retries left):`,error.message),retries&gt;0&amp;&amp;(await new Promise(resolve=&gt;setTimeout(resolve,1e3)),logger$1_info("Retrying Firestore operation..."))}if(0===retries&amp;&amp;lastError)throw logger$1_error("Failed to save token after all retries"),lastError}return this.tokenCache.set(userId,{token:cleanedToken,expiresAt:decoded.exp||0,issuedAt:decoded.iat||Date.now()/1e3,claims:decoded}),!0}catch(error){if(error instanceof Error){if(error.message.includes("Invalid token format"))throw new Error("The provided token is not valid. Please check that you copied the entire JWT token.");if(error.message.includes("permission"))throw new Error("Unable to save token. Please check your permissions and try again.");throw new Error(`Failed to save token: ${error.message}`)}throw new Error("An unexpected error occurred while saving the token. Please try again.")}}async getToken(userId){try{if(!userId)throw new Error("User ID is required to retrieve token");const cached=this.tokenCache.get(userId);if(cached&amp;&amp;!this.isTokenExpired(cached))return cached.token;let token=await secureStorage.getAceToken();if(token&amp;&amp;this.isValidJWT(token)){const decoded=this.decodeToken(token);if(this.tokenCache.set(userId,{token:token,expiresAt:decoded.exp||0,issuedAt:decoded.iat||Date.now()/1e3,claims:decoded}),!this.isTokenExpired({expiresAt:decoded.exp||0}))return token;secureStorage.clearAceToken()}if(db){const userRef=doc(db,"users",userId),userDoc=await getDoc(userRef);if(userDoc.exists()){const data=userDoc.data();if(data.aceJwt){if(!0===data.aceJwtIsEncrypted)try{token=await encryptionService.decrypt(data.aceJwt,userId),logger$1_info("Successfully decrypted token from Firestore")}catch(error){return logger$1_error("Failed to decrypt token from Firestore:",error),null}else{token=data.aceJwt,logger$1_warn("Found unencrypted token in Firestore - will re-encrypt on next save");try{await this.saveToken(userId,token,!0),logger$1_info("Migrated plain text token to encrypted storage")}catch(error){logger$1_warn("Failed to migrate token, continuing with plain text:",error)}}if(token&amp;&amp;(token=token.trim().replace(/[\s\r\n]+/g,""),token&amp;&amp;this.isValidJWT(token))){const decoded=this.decodeToken(token);if(this.tokenCache.set(userId,{token:token,expiresAt:decoded.exp||0,issuedAt:decoded.iat||Date.now()/1e3,claims:decoded}),!this.isTokenExpired({expiresAt:decoded.exp||0}))return await secureStorage.setAceToken(token,!0),token}}}}return null}catch(error){if(error instanceof Error&amp;&amp;(error.message.includes("User ID is required")||error.message.includes("permission")||error.message.includes("decrypt")))throw error;return null}}async removeToken(userId){try{if(!userId)throw new Error("User ID is required to remove token");secureStorage.clearAceToken(),this.tokenCache.delete(userId);if(db){const userRef=doc(db,"users",userId);await updateDoc(userRef,{aceJwt:null,aceJwtHash:null,aceJwtIsEncrypted:!1,aceJwtUpdatedAt:(new Date).toISOString(),aceJwtExpiresAt:null})}return!0}catch(error){if(error instanceof Error&amp;&amp;(error.message.includes("User ID is required")||error.message.includes("permission")))throw error;throw new Error("Failed to remove token. Please try again.")}}isValidJWT(token){return 3===token.split(".").length}decodeToken(token){try{return jwtDecode(token)}catch(_error){return{}}}isTokenExpired(tokenInfo){if(!tokenInfo.expiresAt)return!1;return Date.now()/1e3&gt;tokenInfo.expiresAt-60}async validateToken(userId,token){try{const tokenToValidate=token||await this.getToken(userId);if(!tokenToValidate)return{isValid:!1,error:"No token found"};if(!this.isValidJWT(tokenToValidate))return{isValid:!1,error:"Invalid token format"};const decoded=this.decodeToken(tokenToValidate);if(!decoded.exp)return{isValid:!0};const expiresAt=new Date(1e3*decoded.exp),now=new Date,daysUntilExpiry=Math.ceil((expiresAt.getTime()-now.getTime())/864e5);return daysUntilExpiry&lt;=0?{isValid:!1,error:"Token has expired",expiresAt:expiresAt,daysUntilExpiry:0}:{isValid:!0,expiresAt:expiresAt,daysUntilExpiry:daysUntilExpiry}}catch(error){return{isValid:!1,error:error instanceof Error?error.message:"Failed to validate token"}}}getTokenExpiration(userId){const cached=this.tokenCache.get(userId);if(!(null==cached?void 0:cached.expiresAt))return{isExpired:!1,expiresAt:null,timeUntilExpiry:1/0};const now=Date.now()/1e3,expiresAt=new Date(1e3*cached.expiresAt),timeUntilExpiry=cached.expiresAt-now;return{isExpired:timeUntilExpiry&lt;=0,expiresAt:expiresAt,timeUntilExpiry:Math.max(0,timeUntilExpiry)}}clearCache(){this.tokenCache.clear()}}let tokenServiceInstance;const getTokenService=()=&gt;(tokenServiceInstance||(tokenServiceInstance=new TokenService),tokenServiceInstance),saveToken=(userId,token)=&gt;getTokenService().saveToken(userId,token),getToken=userId=&gt;getTokenService().getToken(userId),removeToken=userId=&gt;getTokenService().removeToken(userId),validateToken=(userId,token)=&gt;getTokenService().validateToken(userId,token),tokenService=getTokenService(),tokenService$1=Object.freeze(Object.defineProperty({__proto__:null,getToken:getToken,getTokenService:getTokenService,removeToken:removeToken,saveToken:saveToken,tokenService:tokenService,validateToken:validateToken},Symbol.toStringTag,{value:"Module"}));const tokenManager=new class TokenManager{async loadTokenFromFirestore(){const user=auth.currentUser;if(!user)throw new Error("No authenticated user");try{const token=await getToken(user.uid);token?store.dispatch(setAceToken$1({token:token})):store.dispatch(setAceToken$1({token:null}))}catch(error){throw console.error("Failed to load token from Firestore:",error),error}}async saveToken(userId,token){try{await saveToken(userId,token),store.dispatch(setAceToken$1({token:token}))}catch(error){throw console.error("Failed to save token:",error),error}}async removeToken(userId){try{await removeToken(userId),store.dispatch(setAceToken$1({token:null}))}catch(error){throw console.error("Failed to remove token:",error),error}}async validateToken(token){const user=auth.currentUser;if(!user)throw new Error("No authenticated user");return validateToken(user.uid,token)}async initializeToken(userId){return this.loadTokenFromFirestore()}},tokenManager$1=Object.freeze(Object.defineProperty({__proto__:null,default:tokenManager},Symbol.toStringTag,{value:"Module"})),DEFAULT_FLAGS={enableRequestBatching:!0,batchingRolloutPercentage:25,enableBatchingMetrics:!0,enableBatchingFallback:!0,enableDataDownsampling:!1,enableWebGLRendering:!0,enableVirtualScrolling:!0,enableLazyLoading:!0,enableAdvancedTooltips:!0,enableRealTimeUpdates:!0,enableFaultDetection:!1,enableDeviationAnalysis:!1,MULTI_SITE_TOKENS:!0,AUTO_MIGRATE_TOKENS:!1,SHOW_MIGRATION_BANNER:!0,ALLOW_MIGRATION_ROLLBACK:!0,DUAL_WRITE_MODE:!1,MIGRATION_DRY_RUN:!1,PRESERVE_LEGACY_TOKENS:!0,MIGRATION_ANALYTICS:!0,ADMIN_ONLY_MIGRATION:!1,MIGRATION_VERIFICATION:!0,enableDebugLogging:!1,enablePerformanceMonitoring:!0,enableMemoryProfiling:!1},ENVIRONMENT_OVERRIDES={development:{enableRequestBatching:!0,batchingRolloutPercentage:100,enableDebugLogging:!0,enablePerformanceMonitoring:!0,enableMemoryProfiling:!0,enableFaultDetection:!0,enableDeviationAnalysis:!0,MIGRATION_DRY_RUN:!0,MIGRATION_ANALYTICS:!0,ALLOW_MIGRATION_ROLLBACK:!0},test:{enableRequestBatching:!0,batchingRolloutPercentage:100,enableDebugLogging:!1,enablePerformanceMonitoring:!1,enableMemoryProfiling:!1},staging:{enableRequestBatching:!0,batchingRolloutPercentage:50,enableDebugLogging:!1,enablePerformanceMonitoring:!0,enableMemoryProfiling:!1},production:{enableRequestBatching:!0,batchingRolloutPercentage:25,enableDebugLogging:!1,enablePerformanceMonitoring:!0,enableMemoryProfiling:!1}};const featureFlags=function loadFeatureFlags(){let flags={...DEFAULT_FLAGS,...ENVIRONMENT_OVERRIDES.production||{}};return function getUserRolloutBucket(){const userIdentifier=localStorage.getItem("user_session_id")||sessionStorage.getItem("session_id")||"anonymous";let hash=0;for(let i=0;i&lt;userIdentifier.length;i++)hash=(hash&lt;&lt;5)-hash+userIdentifier.charCodeAt(i),hash&amp;=hash;return Math.abs(hash)%100}()&gt;=flags.batchingRolloutPercentage&amp;&amp;(flags.enableRequestBatching=!1),flags}(),isFeatureEnabled=flag=&gt;featureFlags[flag],isBatchingEnabled=()=&gt;isFeatureEnabled("enableRequestBatching"),featureFlags$1=Object.freeze(Object.defineProperty({__proto__:null,featureFlags:featureFlags,isBatchingEnabled:isBatchingEnabled,isFeatureEnabled:isFeatureEnabled},Symbol.toStringTag,{value:"Module"}));console.log("[globalTimeRangeStore] MODULE LOADED - Store file is being imported");const globalTimeRangeStore=new class GlobalTimeRangeStore{constructor(){__publicField(this,"state"),__publicField(this,"listeners",new Set),console.log("[GlobalTimeRangeStore] Constructor called");try{const stored=localStorage.getItem("globalTimeRange");console.log("[GlobalTimeRangeStore] localStorage.getItem succeeded:",stored),this.state=stored?JSON.parse(stored):{enabled:!1,timeRange:"24h",customStartDate:null,customEndDate:null,syncedChartIds:[],lastAppliedTimeRange:null,individualChartSettings:{}},console.log("[GlobalTimeRangeStore] Initial state set:",this.state)}catch(error){console.error("[GlobalTimeRangeStore] localStorage access failed:",error),this.state={enabled:!1,timeRange:"24h",customStartDate:null,customEndDate:null,syncedChartIds:[],lastAppliedTimeRange:null,individualChartSettings:{}}}}getState(){return{...this.state}}setState(updates){this.state={...this.state,...updates},this.persist(),this.notify()}setEnabled(enabled){enabled?this.setState({enabled:enabled,lastAppliedTimeRange:{timeRange:this.state.timeRange,customStartDate:this.state.customStartDate,customEndDate:this.state.customEndDate}}):this.setState({enabled:enabled})}setTimeRange(timeRange){this.setState({timeRange:timeRange})}setCustomDates(startDate,endDate){this.setState({customStartDate:startDate,customEndDate:endDate})}setSyncedChartIds(ids){this.setState({syncedChartIds:ids})}addSyncedChartId(id){this.state.syncedChartIds.includes(id)||this.setState({syncedChartIds:[...this.state.syncedChartIds,id]})}removeSyncedChartId(id){this.setState({syncedChartIds:this.state.syncedChartIds.filter(chartId=&gt;chartId!==id)})}saveIndividualChartSettings(chartId,settings){this.setState({individualChartSettings:{...this.state.individualChartSettings,[chartId]:settings}})}restoreIndividualSettings(){this.setState({lastAppliedTimeRange:null})}getEffectiveTimeRange(chartId){return this.state.enabled?{timeRange:this.state.timeRange,customStartDate:this.state.customStartDate,customEndDate:this.state.customEndDate}:this.state.lastAppliedTimeRange?this.state.lastAppliedTimeRange:chartId&amp;&amp;this.state.individualChartSettings[chartId]?this.state.individualChartSettings[chartId]:null}subscribe(listener){return this.listeners.add(listener),()=&gt;this.listeners.delete(listener)}persist(){try{localStorage.setItem("globalTimeRange",JSON.stringify(this.state)),console.log("[GlobalTimeRangeStore] State persisted successfully")}catch(error){console.warn("[GlobalTimeRangeStore] Failed to persist state to localStorage:",error)}}notify(){this.listeners.forEach(listener=&gt;listener(this.state))}};function useGlobalTimeRangeStore(){console.log("[useGlobalTimeRangeStore] Hook called");try{const[state,setState]=reactExports.useState(globalTimeRangeStore.getState());return console.log("[useGlobalTimeRangeStore] useState succeeded, initial state:",state),reactExports.useEffect(()=&gt;{console.log("[useGlobalTimeRangeStore] useEffect called");const unsubscribe=globalTimeRangeStore.subscribe(setState);return console.log("[useGlobalTimeRangeStore] Subscribed to store"),unsubscribe},[]),{globalTimeRange:state,setGlobalTimeRangeEnabled:enabled=&gt;globalTimeRangeStore.setEnabled(enabled),setGlobalTimeRange:timeRange=&gt;globalTimeRangeStore.setTimeRange(timeRange),setCustomDates:(start,end)=&gt;globalTimeRangeStore.setCustomDates(start,end),setSyncedChartIds:ids=&gt;globalTimeRangeStore.setSyncedChartIds(ids),addSyncedChartId:id=&gt;globalTimeRangeStore.addSyncedChartId(id),removeSyncedChartId:id=&gt;globalTimeRangeStore.removeSyncedChartId(id),saveIndividualChartSettings:(chartId,settings)=&gt;globalTimeRangeStore.saveIndividualChartSettings(chartId,settings),restoreIndividualSettings:()=&gt;globalTimeRangeStore.restoreIndividualSettings(),getEffectiveTimeRange:chartId=&gt;globalTimeRangeStore.getEffectiveTimeRange(chartId)}}catch(error){throw console.error("[useGlobalTimeRangeStore] Hook failed with error:",error),error}}const useInstallPrompt=()=&gt;{const[installPrompt,setInstallPrompt]=reactExports.useState(null),[isInstalled,setIsInstalled]=reactExports.useState(!1);reactExports.useEffect(()=&gt;{window.matchMedia("(display-mode: standalone)").matches&amp;&amp;setIsInstalled(!0);const handleBeforeInstallPrompt=e=&gt;{e.preventDefault(),setInstallPrompt(e)},handleAppInstalled=()=&gt;{setIsInstalled(!0),setInstallPrompt(null)};return window.addEventListener("beforeinstallprompt",handleBeforeInstallPrompt),window.addEventListener("appinstalled",handleAppInstalled),()=&gt;{window.removeEventListener("beforeinstallprompt",handleBeforeInstallPrompt),window.removeEventListener("appinstalled",handleAppInstalled)}},[]);return{promptInstall:async()=&gt;{if(!installPrompt)return!1;try{await installPrompt.prompt();const{outcome:outcome}=await installPrompt.userChoice;return"accepted"===outcome&amp;&amp;(setInstallPrompt(null),!0)}catch(_error){}},canInstall:!!installPrompt&amp;&amp;!isInstalled,isInstalled:isInstalled}},usePullToRefresh=({onRefresh:onRefresh,threshold:threshold=10,resistance:resistance=2.5,distanceToRefresh:distanceToRefresh=80,refreshTimeout:refreshTimeout=1e4,disabled:disabled=!1})=&gt;{useTheme();const[state,setState]=reactExports.useState({isPulling:!1,pullDistance:0,isRefreshing:!1,releaseToRefresh:!1}),startY=reactExports.useRef(0),currentY=reactExports.useRef(0),containerRef=reactExports.useRef(null),refreshTimeoutRef=reactExports.useRef(void 0),isAtTop=reactExports.useCallback(()=&gt;{if(!containerRef.current)return!0;const scrollElement=containerRef.current,scrollTop=scrollElement.scrollTop;let parent=scrollElement.parentElement;for(;parent;){if(parent.scrollTop&gt;0)return!1;parent=parent.parentElement}return scrollTop&lt;=0},[]),handleTouchStart=reactExports.useCallback(e=&gt;{disabled||state.isRefreshing||!isAtTop()||(startY.current=e.touches[0].clientY,currentY.current=startY.current)},[disabled,state.isRefreshing,isAtTop]),handleTouchMove=reactExports.useCallback(e=&gt;{if(disabled||state.isRefreshing||!isAtTop())return;currentY.current=e.touches[0].clientY;const distance=currentY.current-startY.current;if(distance&gt;threshold){e.preventDefault();const pullDistance=Math.min(distance/resistance,1.5*distanceToRefresh);setState(prev=&gt;({...prev,isPulling:!0,pullDistance:pullDistance,releaseToRefresh:pullDistance&gt;=distanceToRefresh}))}},[disabled,state.isRefreshing,threshold,resistance,distanceToRefresh,isAtTop]),handleTouchEnd=reactExports.useCallback(async()=&gt;{if(disabled||!state.isPulling)return;const shouldRefresh=state.releaseToRefresh;if(setState(prev=&gt;({...prev,isPulling:!1,pullDistance:0,releaseToRefresh:!1,isRefreshing:shouldRefresh})),shouldRefresh)try{refreshTimeoutRef.current=setTimeout(()=&gt;{setState(prev=&gt;({...prev,isRefreshing:!1}))},refreshTimeout),await onRefresh(),refreshTimeoutRef.current&amp;&amp;clearTimeout(refreshTimeoutRef.current)}catch(_error){setState(prev=&gt;({...prev,isRefreshing:!1}))}startY.current=0,currentY.current=0},[disabled,state.isPulling,state.releaseToRefresh,onRefresh,refreshTimeout]);reactExports.useEffect(()=&gt;{const element=containerRef.current;if(!element||disabled)return;const options={passive:!1};return element.addEventListener("touchstart",handleTouchStart,options),element.addEventListener("touchmove",handleTouchMove,options),element.addEventListener("touchend",handleTouchEnd,options),()=&gt;{element.removeEventListener("touchstart",handleTouchStart),element.removeEventListener("touchmove",handleTouchMove),element.removeEventListener("touchend",handleTouchEnd)}},[handleTouchStart,handleTouchMove,handleTouchEnd,disabled]),reactExports.useEffect(()=&gt;()=&gt;{refreshTimeoutRef.current&amp;&amp;clearTimeout(refreshTimeoutRef.current)},[]);const pullProgress=Math.min(state.pullDistance/distanceToRefresh,1);return{containerRef:containerRef,isRefreshing:state.isRefreshing,pullDistance:state.pullDistance,isPulling:state.isPulling,releaseToRefresh:state.releaseToRefresh,pullProgress:pullProgress,handlers:{onTouchStart:handleTouchStart,onTouchMove:handleTouchMove,onTouchEnd:handleTouchEnd}}};function useSupportsTouch(){const[supportsTouch,setSupportsTouch]=reactExports.useState(!1);return reactExports.useEffect(()=&gt;{const checkTouch=()=&gt;{const hasTouch="ontouchstart"in window||navigator.maxTouchPoints&gt;0||navigator.msMaxTouchPoints&gt;0;setSupportsTouch(hasTouch)};return checkTouch(),window.addEventListener("resize",checkTouch),()=&gt;window.removeEventListener("resize",checkTouch)},[]),supportsTouch}function useTokenStatus(){useDispatch();const{_firebaseUser:_firebaseUser,aceToken:aceToken}=useSelector(state=&gt;state.auth),[isLoading,_setIsLoading]=reactExports.useState(!1),[tokenStatus,setTokenStatus]=reactExports.useState({isValid:!1,isExpiring:!1,daysUntilExpiration:null,expiresAt:null});return reactExports.useEffect(()=&gt;{if(aceToken)try{const decoded=jwtDecode(aceToken),now=Date.now()/1e3;if(decoded.exp){const expiresAt=new Date(1e3*decoded.exp),timeUntilExpiry=decoded.exp-now,daysUntilExpiration=Math.ceil(timeUntilExpiry/86400);setTokenStatus({isValid:timeUntilExpiry&gt;0,isExpiring:daysUntilExpiration&lt;=7&amp;&amp;daysUntilExpiration&gt;0,daysUntilExpiration:daysUntilExpiration&gt;0?daysUntilExpiration:null,expiresAt:expiresAt.toISOString()})}else setTokenStatus({isValid:!0,isExpiring:!1,daysUntilExpiration:null,expiresAt:null})}catch(_error){setTokenStatus({isValid:!1,isExpiring:!1,daysUntilExpiration:null,expiresAt:null})}else setTokenStatus({isValid:!1,isExpiring:!1,daysUntilExpiration:null,expiresAt:null})},[aceToken]),{token:aceToken,isLoading:isLoading,...tokenStatus}}const aceIotApiClient=new class AceIotApiClient{constructor(){__publicField(this,"batchingEnabled",!0),__publicField(this,"apiService",null);this.apiService=initializeBatchApiService$1("https://ace-iot-consolidated-proxy.jstahr.workers.dev","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTc1NzYxMTE4NiwianRpIjoiNjY1ZDM2NjMtZjFhZC00YWYxLTliZmEtNGMwMzRmMTllYjA4IiwidHlwZSI6ImFjY2VzcyIsImlkZW50aXR5Ijoic2VzXzAwMDFfZmFsbHNfY2l0eSIsIm5iZiI6MTc1NzYxMTE4NiwiZXhwIjoxNzg5MTQ3MTg2fQ.5g9JVBO_18x42srsJ4ZUNIqMbK6XeQDyrqqS-WEFc0g")}setBatchingEnabled(enabled){this.batchingEnabled=enabled,this.apiService&amp;&amp;this.apiService.updateConfig({batchWindow:enabled?50:0,enableDeduplication:enabled})}async getSites(){return[]}async getPoints(){return[]}async fetchTimeseriesData(pointNames,startTime,endTime){if(!this.apiService)return console.warn("API service not initialized"),[];try{const response=await this.apiService.getTimeseries({points:pointNames,start_time:startTime,end_time:endTime,options:{compression:"auto",cache_strategy:"normal"}}),result=[];for(const pointName of pointNames)if(response.data[pointName]&amp;&amp;!("error"in response.data[pointName])){const pointData=response.data[pointName];result.push({pointName:pointName,data:pointData.values.map(v=&gt;({timestamp:v.timestamp,value:v.value})),metadata:pointData.metadata})}return result}catch(error){return console.error("Failed to fetch timeseries data:",error),[]}}getBatchingMetrics(){var _a;return(null==(_a=this.apiService)?void 0:_a.getMetrics())||{totalRequests:0,batchRequests:0,cacheHits:0,cacheMisses:0,errors:0,averageResponseTime:0,deduplicationSaved:0}}clearBatchingMetrics(){this.apiService=initializeBatchApiService$1("https://ace-iot-consolidated-proxy.jstahr.workers.dev","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTc1NzYxMTE4NiwianRpIjoiNjY1ZDM2NjMtZjFhZC00YWYxLTliZmEtNGMwMzRmMTllYjA4IiwidHlwZSI6ImFjY2VzcyIsImlkZW50aXR5Ijoic2VzXzAwMDFfZmFsbHNfY2l0eSIsIm5iZiI6MTc1NzYxMTE4NiwiZXhwIjoxNzg5MTQ3MTg2fQ.5g9JVBO_18x42srsJ4ZUNIqMbK6XeQDyrqqS-WEFc0g")}getCacheStats(){var _a;const metrics=(null==(_a=this.apiService)?void 0:_a.getMetrics())||{};return{size:metrics.cacheSize||0,hits:metrics.cacheHits||0,misses:metrics.cacheMisses||0,hitRate:metrics.cacheHits&amp;&amp;metrics.cacheMisses?metrics.cacheHits/(metrics.cacheHits+metrics.cacheMisses):0}}clearCache(){var _a;null==(_a=this.apiService)||_a.clearCache()}setToken(token){this.apiService=initializeBatchApiService$1("https://ace-iot-consolidated-proxy.jstahr.workers.dev",token)}},batchRequestService_configure=()=&gt;{},batchRequestService_clearCache=()=&gt;aceIotApiClient.clearCache(),defaultConfig$1={enabled:!0,maxBatchSize:50,batchWindowMs:50,enableDeduplication:!0,prefetchCommonData:!0},BatchingContext=reactExports.createContext(null),BatchingProvider=({children:children})=&gt;{const[config,setConfig]=reactExports.useState(()=&gt;{const saved=localStorage.getItem("batchingConfig");if(saved)try{return{...defaultConfig$1,...JSON.parse(saved)}}catch(error){}return defaultConfig$1}),updateConfig=reactExports.useCallback(updates=&gt;{setConfig(prev=&gt;{const newConfig={...prev,...updates};return localStorage.setItem("batchingConfig",JSON.stringify(newConfig)),aceIotApiClient.setBatchingEnabled(newConfig.enabled),batchRequestService_configure({maxBatchSize:newConfig.maxBatchSize,batchWindowMs:newConfig.batchWindowMs,enableDeduplication:newConfig.enableDeduplication}),newConfig})},[]),resetConfig=reactExports.useCallback(()=&gt;{updateConfig(defaultConfig$1),localStorage.removeItem("batchingConfig")},[updateConfig]),clearCache=reactExports.useCallback(()=&gt;{batchRequestService_clearCache()},[]),prefetchData=reactExports.useCallback(async()=&gt;{if(config.prefetchCommonData)try{await Promise.all([aceIotApiClient.getSites(),aceIotApiClient.getPoints()])}catch(error){}},[config.prefetchCommonData]);reactExports.useEffect(()=&gt;{aceIotApiClient.setBatchingEnabled(config.enabled),batchRequestService_configure({maxBatchSize:config.maxBatchSize,batchWindowMs:config.batchWindowMs,enableDeduplication:config.enableDeduplication})},[]);const value={config:config,updateConfig:updateConfig,resetConfig:resetConfig,clearCache:clearCache,prefetchData:prefetchData};return jsxRuntimeExports.jsx(BatchingContext.Provider,{value:value,children:children})};const SnackbarContext=reactExports.createContext(null),SnackbarProvider=({children:children})=&gt;{const[open,setOpen]=reactExports.useState(!1),[message,setMessage]=reactExports.useState(""),[severity,setSeverity]=reactExports.useState("info"),showSnackbar=reactExports.useCallback((msg,sev="info")=&gt;{setMessage(msg),setSeverity(sev),setOpen(!0)},[]),handleClose=()=&gt;{setOpen(!1)};return jsxRuntimeExports.jsxs(SnackbarContext.Provider,{value:{showSnackbar:showSnackbar},children:[children,jsxRuntimeExports.jsx(Snackbar,{open:open,autoHideDuration:6e3,onClose:handleClose,children:jsxRuntimeExports.jsx(Alert,{onClose:handleClose,severity:severity,sx:{width:"100%"},children:message})})]})},useSnackbar=()=&gt;{const context=reactExports.useContext(SnackbarContext);return context||{showSnackbar:(message,severity)=&gt;{console.log(`[Snackbar] ${severity||"info"}: ${message}`)}}},useDialogFocusTrap=(isOpen,onClose,initialFocusSelector)=&gt;((options={})=&gt;{const{active:active=!1,initialFocus:initialFocus,returnFocus:returnFocus,allowOutsideClick:allowOutsideClick=!1,onActivate:onActivate,onDeactivate:onDeactivate,onEscape:onEscape,focusableSelectors:focusableSelectors}=options,containerRef=reactExports.useRef(null),previouslyFocusedElementRef=reactExports.useRef(null),isActiveRef=reactExports.useRef(!1),defaultFocusableSelectors=["a[href]","button:not([disabled])","textarea:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]',"details[open] summary","audio[controls]","video[controls]"],getFocusableElements=reactExports.useCallback(()=&gt;{if(!containerRef.current)return[];const selectors=focusableSelectors||defaultFocusableSelectors,elements=containerRef.current.querySelectorAll(selectors.join(", "));return Array.from(elements).filter(element=&gt;element instanceof HTMLElement&amp;&amp;!element.hasAttribute("disabled")&amp;&amp;!element.getAttribute("aria-hidden")&amp;&amp;-1!==element.tabIndex&amp;&amp;element.offsetWidth&gt;0&amp;&amp;element.offsetHeight&gt;0)},[focusableSelectors]),focusFirst=reactExports.useCallback(()=&gt;{var _a;null==(_a=getFocusableElements()[0])||_a.focus()},[getFocusableElements]),focusLast=reactExports.useCallback(()=&gt;{var _a;const focusableElements=getFocusableElements();null==(_a=focusableElements[focusableElements.length-1])||_a.focus()},[getFocusableElements]),focusNext=reactExports.useCallback(()=&gt;{var _a;const focusableElements=getFocusableElements(),currentIndex=focusableElements.indexOf(document.activeElement);null==(_a=focusableElements[(currentIndex+1)%focusableElements.length])||_a.focus()},[getFocusableElements]),focusPrevious=reactExports.useCallback(()=&gt;{var _a;const focusableElements=getFocusableElements(),currentIndex=focusableElements.indexOf(document.activeElement);null==(_a=focusableElements[0===currentIndex?focusableElements.length-1:currentIndex-1])||_a.focus()},[getFocusableElements]),getElement=reactExports.useCallback(elementInput=&gt;elementInput?"string"==typeof elementInput?document.querySelector(elementInput):"function"==typeof elementInput?elementInput():elementInput:null,[]),activate=reactExports.useCallback(()=&gt;{if(isActiveRef.current||!containerRef.current)return;previouslyFocusedElementRef.current=document.activeElement,isActiveRef.current=!0;const initialElement=getElement(initialFocus)||getFocusableElements()[0];initialElement&amp;&amp;setTimeout(()=&gt;{initialElement.focus()},0),null==onActivate||onActivate()},[initialFocus,getFocusableElements,getElement,onActivate]),deactivate=reactExports.useCallback(()=&gt;{if(!isActiveRef.current)return;isActiveRef.current=!1;const returnElement=getElement(returnFocus)||previouslyFocusedElementRef.current;returnElement&amp;&amp;returnElement.focus&amp;&amp;setTimeout(()=&gt;{returnElement.focus()},0),previouslyFocusedElementRef.current=null,null==onDeactivate||onDeactivate()},[returnFocus,getElement,onDeactivate]),handleTabKey=reactExports.useCallback(event=&gt;{if(!isActiveRef.current||"Tab"!==event.key)return;const focusableElements=getFocusableElements();if(0===focusableElements.length)return void event.preventDefault();const firstElement=focusableElements[0],lastElement=focusableElements[focusableElements.length-1],activeElement=document.activeElement;event.shiftKey?activeElement===firstElement&amp;&amp;(event.preventDefault(),lastElement.focus()):activeElement===lastElement&amp;&amp;(event.preventDefault(),firstElement.focus())},[getFocusableElements]),handleEscapeKey=reactExports.useCallback(event=&gt;{isActiveRef.current&amp;&amp;"Escape"===event.key&amp;&amp;(event.preventDefault(),null==onEscape||onEscape())},[onEscape]),handleOutsideClick=reactExports.useCallback(event=&gt;{isActiveRef.current&amp;&amp;allowOutsideClick&amp;&amp;containerRef.current&amp;&amp;!containerRef.current.contains(event.target)&amp;&amp;deactivate()},[allowOutsideClick,deactivate]),handleFocusIn=reactExports.useCallback(event=&gt;{if(!isActiveRef.current||!containerRef.current||containerRef.current.contains(event.target))return;event.preventDefault();const focusableElements=getFocusableElements();focusableElements.length&gt;0&amp;&amp;focusableElements[0].focus()},[getFocusableElements]);return reactExports.useEffect(()=&gt;{if(isActiveRef.current)return document.addEventListener("keydown",handleTabKey),document.addEventListener("keydown",handleEscapeKey),document.addEventListener("focusin",handleFocusIn),allowOutsideClick&amp;&amp;document.addEventListener("mousedown",handleOutsideClick),()=&gt;{document.removeEventListener("keydown",handleTabKey),document.removeEventListener("keydown",handleEscapeKey),document.removeEventListener("focusin",handleFocusIn),document.removeEventListener("mousedown",handleOutsideClick)}},[handleTabKey,handleEscapeKey,handleFocusIn,handleOutsideClick,allowOutsideClick]),reactExports.useEffect(()=&gt;{active&amp;&amp;!isActiveRef.current?activate():!active&amp;&amp;isActiveRef.current&amp;&amp;deactivate()},[active,activate,deactivate]),reactExports.useEffect(()=&gt;()=&gt;{isActiveRef.current&amp;&amp;deactivate()},[deactivate]),{containerRef:containerRef,activate:activate,deactivate:deactivate,isActive:isActiveRef.current,getFocusableElements:getFocusableElements,focusFirst:focusFirst,focusLast:focusLast,focusNext:focusNext,focusPrevious:focusPrevious}})({active:isOpen,initialFocus:initialFocusSelector,allowOutsideClick:!1,onEscape:onClose}),noopLogger={debug:(...args)=&gt;console.debug("[NoOp Logger]",...args),info:(...args)=&gt;console.info("[NoOp Logger]",...args),warn:(...args)=&gt;console.warn("[NoOp Logger]",...args),error:(...args)=&gt;console.error("[NoOp Logger]",...args)};"undefined"==typeof window||window.logger||(window.logger=noopLogger);const axiosInstance=axios.create({timeout:3e4,headers:{"Content-Type":"application/json"}});initializeTokenInterceptor(axiosInstance);const axiosInstance$1=Object.freeze(Object.defineProperty({__proto__:null,default:axiosInstance,setAceToken:function setAceToken(token){if(console.warn("[axiosInstance] setAceToken() is deprecated. Tokens are now automatically injected via interceptor."),token)try{localStorage.setItem("ace_token",token)}catch(error){console.error("[axiosInstance] Failed to store token in localStorage:",error)}else try{localStorage.removeItem("ace_token")}catch(error){console.error("[axiosInstance] Failed to remove token from localStorage:",error)}}},Symbol.toStringTag,{value:"Module"})),signInWithSSO=async(provider,useRedirect=!1)=&gt;{const authProvider="google"===provider?googleProvider:microsoftProvider;try{let result;if(useRedirect){if(await signInWithRedirect(auth,authProvider),result=await getRedirectResult(auth),!result)throw new Error("No redirect result available")}else result=await signInWithPopup(auth,authProvider);return await handleSSOUser(result.user,authProvider),result}catch(error){if("auth/popup-blocked"===error.code)throw new Error("Popup was blocked. Please allow popups for this site or use redirect mode.");if("auth/popup-closed-by-user"===error.code)throw new Error("Sign in was cancelled.");if("auth/unauthorized-domain"===error.code)throw new Error("This domain is not authorized for OAuth operations.");if("auth/account-exists-with-different-credential"===error.code)throw new Error("An account already exists with the same email address but different sign-in credentials.");throw error}},handleSSOUser=async(user,provider)=&gt;{const userRef=doc(db,"users",user.uid);try{if((await getDoc(userRef)).exists())await setDoc(userRef,{lastLoginAt:serverTimestamp(),displayName:user.displayName,photoURL:user.photoURL},{merge:!0});else{const adminEmails="kennyr@specializedeng.com,abutler@specializedeng.com,rcarnahan@specializedeng.com,clancaster@specializedeng.com,jstahr@specializedeng.com".split(",").map(email=&gt;email.trim())||[],isAdmin=user.email&amp;&amp;adminEmails.includes(user.email),userData={uid:user.uid,email:user.email,displayName:user.displayName,photoURL:user.photoURL,provider:provider.providerId,role:isAdmin?"admin":"user",createdAt:serverTimestamp(),lastLoginAt:serverTimestamp()};await setDoc(userRef,userData)}}catch(error){throw new Error("Failed to complete SSO sign in. Please try again.")}},checkRedirectResult=async()=&gt;{try{const result=await getRedirectResult(auth);return result&amp;&amp;await handleSSOUser(result.user,result.providerId),result}catch(error){return null}},useMobileDetection=()=&gt;{const theme=useTheme(),isMobile=useMediaQuery$1(theme.breakpoints.down("sm")),isTablet=useMediaQuery$1(theme.breakpoints.between("sm","md")),isDesktop=useMediaQuery$1(theme.breakpoints.up("md")),[orientation,setOrientation]=reactExports.useState(window.innerHeight&gt;window.innerWidth?"portrait":"landscape"),isTouchDevice="ontouchstart"in window||navigator.maxTouchPoints&gt;0,isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&amp;&amp;!window.MSStream,isAndroid=/Android/.test(navigator.userAgent),isPWA=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");reactExports.useEffect(()=&gt;{const handleOrientationChange=()=&gt;{setOrientation(window.innerHeight&gt;window.innerWidth?"portrait":"landscape")};return window.addEventListener("orientationchange",handleOrientationChange),window.addEventListener("resize",handleOrientationChange),()=&gt;{window.removeEventListener("orientationchange",handleOrientationChange),window.removeEventListener("resize",handleOrientationChange)}},[]);const[screenDimensions,setScreenDimensions]=reactExports.useState({width:window.innerWidth,height:window.innerHeight});reactExports.useEffect(()=&gt;{const handleResize=()=&gt;{setScreenDimensions({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",handleResize),()=&gt;window.removeEventListener("resize",handleResize)},[]);const deviceType=reactExports.useMemo(()=&gt;isMobile?"mobile":isTablet?"tablet":"desktop",[isMobile,isTablet]),isXl=useMediaQuery$1(theme.breakpoints.up("xl")),isLg=useMediaQuery$1(theme.breakpoints.up("lg")),isMd=useMediaQuery$1(theme.breakpoints.up("md")),isSm=useMediaQuery$1(theme.breakpoints.up("sm")),viewportSize=reactExports.useMemo(()=&gt;isXl?"xl":isLg?"lg":isMd?"md":isSm?"sm":"xs",[isXl,isLg,isMd,isSm]),safeAreaInsets=reactExports.useMemo(()=&gt;{const computedStyle=getComputedStyle(document.documentElement);return{top:parseInt(computedStyle.getPropertyValue("env(safe-area-inset-top)")||"0",10),right:parseInt(computedStyle.getPropertyValue("env(safe-area-inset-right)")||"0",10),bottom:parseInt(computedStyle.getPropertyValue("env(safe-area-inset-bottom)")||"0",10),left:parseInt(computedStyle.getPropertyValue("env(safe-area-inset-left)")||"0",10)}},[]);return{isMobile:isMobile,isTablet:isTablet,isDesktop:isDesktop,isTouchDevice:isTouchDevice,isIOS:isIOS,isAndroid:isAndroid,isPWA:isPWA,orientation:orientation,screenWidth:screenDimensions.width,screenHeight:screenDimensions.height,deviceType:deviceType,viewportSize:viewportSize,safeAreaInsets:safeAreaInsets}};const DEFAULT_CONFIGS={low:{sensitivity:"low",thresholds:{temperature:{min:60,max:80,deviation:10},humidity:{min:30,max:70,deviation:15},pressure:{min:0,max:100,deviation:20},flow:{min:0,max:1e3,deviation:50},energy:{min:0,max:1e4,deviation:100}},debounceDelay:2e3},medium:{sensitivity:"medium",thresholds:{temperature:{min:65,max:75,deviation:5},humidity:{min:35,max:65,deviation:10},pressure:{min:10,max:90,deviation:15},flow:{min:10,max:900,deviation:30},energy:{min:0,max:8e3,deviation:50}},debounceDelay:1e3},high:{sensitivity:"high",thresholds:{temperature:{min:68,max:72,deviation:2},humidity:{min:40,max:60,deviation:5},pressure:{min:20,max:80,deviation:10},flow:{min:20,max:800,deviation:20},energy:{min:0,max:6e3,deviation:25}},debounceDelay:500}};class FaultDetectionEngine{static generateId(){return`fault_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}static detectThresholdViolations(dataPoints,config){const faults=[];return dataPoints.forEach(point=&gt;{const pointType=this.inferPointType(point.pointName,point.unit),thresholds=config.thresholds[pointType]||config.thresholds.temperature;let fault=null;point.value&lt;thresholds.min?fault={id:this.generateId(),timestamp:point.timestamp,value:point.value,severity:this.calculateSeverity(Math.abs(point.value-thresholds.min),thresholds.deviation),type:pointType,message:`${pointType} below minimum threshold`,description:`Value ${point.value.toFixed(2)} is below minimum of ${thresholds.min}`,threshold:thresholds.min,deviation:Math.abs(point.value-thresholds.min),confidence:.95,pointName:point.pointName,zone:point.zone,equipment:point.equipment,chartPosition:{x:point.timestamp,y:point.value}}:point.value&gt;thresholds.max&amp;&amp;(fault={id:this.generateId(),timestamp:point.timestamp,value:point.value,severity:this.calculateSeverity(Math.abs(point.value-thresholds.max),thresholds.deviation),type:pointType,message:`${pointType} above maximum threshold`,description:`Value ${point.value.toFixed(2)} is above maximum of ${thresholds.max}`,threshold:thresholds.max,deviation:Math.abs(point.value-thresholds.max),confidence:.95,pointName:point.pointName,zone:point.zone,equipment:point.equipment,chartPosition:{x:point.timestamp,y:point.value}}),fault&amp;&amp;faults.push(fault)}),faults}static detectStatisticalAnomalies(dataPoints,config,historicalData){const faults=[];if(dataPoints.length&lt;10)return faults;const windowSize=Math.min(20,Math.floor(dataPoints.length/2));for(let i=windowSize;i&lt;dataPoints.length;i++){const window2=dataPoints.slice(i-windowSize,i),point=dataPoints[i],mean=window2.reduce((sum,p)=&gt;sum+p.value,0)/window2.length,variance=window2.reduce((sum,p)=&gt;sum+Math.pow(p.value-mean,2),0)/(window2.length-1),stdDev=Math.sqrt(variance),zScore=Math.abs((point.value-mean)/stdDev),sensitivityMultiplier="high"===config.sensitivity?2:"medium"===config.sensitivity?2.5:3;if(zScore&gt;sensitivityMultiplier){const pointType=this.inferPointType(point.pointName,point.unit);faults.push({id:this.generateId(),timestamp:point.timestamp,value:point.value,severity:this.calculateSeverity(zScore,sensitivityMultiplier),type:pointType,message:"Statistical anomaly detected",description:`Value deviates ${zScore.toFixed(2)} standard deviations from recent average`,deviation:Math.abs(point.value-mean),confidence:Math.min(.99,zScore/sensitivityMultiplier*.8),pointName:point.pointName,zone:point.zone,equipment:point.equipment,chartPosition:{x:point.timestamp,y:point.value}})}}return faults}static detectRateOfChangeAnomalies(dataPoints,config){const faults=[];if(dataPoints.length&lt;3)return faults;const maxRateMultiplier="high"===config.sensitivity?2:"medium"===config.sensitivity?3:5;for(let i=2;i&lt;dataPoints.length;i++){const current=dataPoints[i],previous=dataPoints[i-1],beforePrevious=dataPoints[i-2],timeDelta1=(current.timestamp-previous.timestamp)/1e3,timeDelta2=(previous.timestamp-beforePrevious.timestamp)/1e3;if(0===timeDelta1||0===timeDelta2)continue;const rateOfChange1=(current.value-previous.value)/timeDelta1,rateOfChange2=(previous.value-beforePrevious.value)/timeDelta2,acceleration=Math.abs(rateOfChange1-rateOfChange2),pointType=this.inferPointType(current.pointName,current.unit),maxAcceleration=(config.thresholds[pointType]||config.thresholds.temperature).deviation*maxRateMultiplier/60;acceleration&gt;maxAcceleration&amp;&amp;faults.push({id:this.generateId(),timestamp:current.timestamp,value:current.value,severity:this.calculateSeverity(acceleration,maxAcceleration),type:pointType,message:"Rapid value change detected",description:`Rate of change acceleration: ${acceleration.toFixed(2)}/s exceeds threshold`,deviation:acceleration,confidence:.85,pointName:current.pointName,zone:current.zone,equipment:current.equipment,chartPosition:{x:current.timestamp,y:current.value}})}return faults}static detectPatternAnomalies(dataPoints,config){const faults=[];if(dataPoints.length&lt;20)return faults;for(let i=10;i&lt;dataPoints.length;i++){const values=dataPoints.slice(i-10,i).map(p=&gt;p.value),minValue=Math.min(...values);if(Math.max(...values)-minValue&lt;=.01){const point=dataPoints[i],pointType=this.inferPointType(point.pointName,point.unit);faults.push({id:this.generateId(),timestamp:point.timestamp,value:point.value,severity:"medium",type:pointType,message:"Sensor appears stuck or flat-lined",description:"No variation in 10 consecutive readings",confidence:.8,pointName:point.pointName,zone:point.zone,equipment:point.equipment,chartPosition:{x:point.timestamp,y:point.value}})}}return faults}static inferPointType(pointName,unit){const name=pointName.toLowerCase(),unitLower=(null==unit?void 0:unit.toLowerCase())||"";return name.includes("temp")||unitLower.includes("Â°")||unitLower.includes("f")||unitLower.includes("c")?"temperature":name.includes("humid")||unitLower.includes("%rh")||unitLower.includes("humid")?"humidity":name.includes("press")||unitLower.includes("psi")||unitLower.includes("pa")||unitLower.includes("bar")?"pressure":name.includes("flow")||unitLower.includes("cfm")||unitLower.includes("l/s")||unitLower.includes("gpm")?"flow":name.includes("power")||name.includes("energy")||name.includes("watt")||unitLower.includes("kw")||unitLower.includes("w")?"energy":name.includes("vibr")||name.includes("accel")||unitLower.includes("g")||unitLower.includes("m/sÂ²")?"vibration":name.includes("volt")||name.includes("amp")||name.includes("current")||unitLower.includes("v")||unitLower.includes("a")?"electrical":"mechanical"}static calculateSeverity(deviation,threshold){const ratio=deviation/threshold;return ratio&gt;=3?"critical":ratio&gt;=2?"high":ratio&gt;=1.5?"medium":"low"}}const useFaultDetection=(data=[],initialConfig)=&gt;{const[config,setConfig]=reactExports.useState(()=&gt;({enabled:!0,sensitivity:"medium",algorithms:[{type:"threshold",enabled:!0,config:{}},{type:"statistical",enabled:!0,config:{}},{type:"rate_of_change",enabled:!0,config:{}},{type:"pattern",enabled:!0,config:{}}],thresholds:DEFAULT_CONFIGS.medium.thresholds,cacheTTL:3e5,debounceDelay:1e3,maxFaults:1e3,...initialConfig})),[faults,setFaults]=reactExports.useState([]),[isAnalyzing,setIsAnalyzing]=reactExports.useState(!1),[lastAnalyzedTime,setLastAnalyzedTime]=reactExports.useState(0),[cache,setCache]=reactExports.useState(new Map),cacheRef=reactExports.useRef(cache);cacheRef.current=cache;const debouncedData=function useDebounce(value,delay){const[debouncedValue,setDebouncedValue]=reactExports.useState(value);return reactExports.useEffect(()=&gt;{const handler=setTimeout(()=&gt;{setDebouncedValue(value)},delay);return()=&gt;{clearTimeout(handler)}},[value,delay]),debouncedValue}(data,config.debounceDelay),getCacheKey=reactExports.useCallback((dataPoints,config2)=&gt;`${dataPoints.slice(-50).map(p=&gt;`${p.timestamp}-${p.value}-${p.pointName}`).join("|")}-${`${config2.sensitivity}-${config2.enabled}-${JSON.stringify(config2.thresholds)}`}`,[]),cleanCache=reactExports.useCallback(()=&gt;{const now=Date.now(),newCache=new Map(cacheRef.current);for(const[key,entry]of newCache.entries())now-entry.timestamp&gt;config.cacheTTL&amp;&amp;newCache.delete(key);setCache(newCache)},[config.cacheTTL]),detectFaults=reactExports.useCallback(async dataPoints=&gt;{if(!config.enabled||0===dataPoints.length)return{faults:[],lastAnalyzedTime:Date.now(),confidence:1,processedDataPoints:0};setIsAnalyzing(!0);try{const cacheKey=getCacheKey(dataPoints,config),cachedResult=cacheRef.current.get(cacheKey);if(cachedResult&amp;&amp;Date.now()-cachedResult.timestamp&lt;config.cacheTTL)return setIsAnalyzing(!1),cachedResult.result;const detectedFaults=[];let totalConfidence=0,algorithmCount=0;for(const algorithm of config.algorithms){if(!algorithm.enabled)continue;algorithmCount++;let algorithmFaults=[];switch(algorithm.type){case"threshold":algorithmFaults=FaultDetectionEngine.detectThresholdViolations(dataPoints,config),totalConfidence+=.95;break;case"statistical":algorithmFaults=FaultDetectionEngine.detectStatisticalAnomalies(dataPoints,config),totalConfidence+=.85;break;case"rate_of_change":algorithmFaults=FaultDetectionEngine.detectRateOfChangeAnomalies(dataPoints,config),totalConfidence+=.8;break;case"pattern":algorithmFaults=FaultDetectionEngine.detectPatternAnomalies(dataPoints,config),totalConfidence+=.75}detectedFaults.push(...algorithmFaults)}const uniqueFaults=detectedFaults.filter((fault,index2,array)=&gt;array.findIndex(f=&gt;f.timestamp===fault.timestamp&amp;&amp;f.pointName===fault.pointName&amp;&amp;f.type===fault.type)===index2);uniqueFaults.sort((a,b)=&gt;{const severityOrder={critical:4,high:3,medium:2,low:1},severityDiff=severityOrder[b.severity]-severityOrder[a.severity];return 0!==severityDiff?severityDiff:b.timestamp-a.timestamp});const result={faults:uniqueFaults.slice(0,config.maxFaults),lastAnalyzedTime:Date.now(),confidence:algorithmCount&gt;0?totalConfidence/algorithmCount:1,processedDataPoints:dataPoints.length},newCache=new Map(cacheRef.current);return newCache.set(cacheKey,{result:result,timestamp:Date.now()}),setCache(newCache),result}finally{setIsAnalyzing(!1)}},[config,getCacheKey]);reactExports.useEffect(()=&gt;{debouncedData.length&gt;0&amp;&amp;detectFaults(debouncedData).then(result=&gt;{setFaults(result.faults),setLastAnalyzedTime(result.lastAnalyzedTime)})},[debouncedData,detectFaults]),reactExports.useEffect(()=&gt;{const interval=setInterval(cleanCache,config.cacheTTL/2);return()=&gt;clearInterval(interval)},[cleanCache,config.cacheTTL]);const updateConfig=reactExports.useCallback(newConfig=&gt;{setConfig(prev=&gt;({...prev,...newConfig,thresholds:{...prev.thresholds,...newConfig.thresholds}}))},[]),updateSensitivity=reactExports.useCallback(sensitivity=&gt;{updateConfig({sensitivity:sensitivity,...DEFAULT_CONFIGS[sensitivity]})},[updateConfig]),acknowledgeFault=reactExports.useCallback(faultId=&gt;{setFaults(prev=&gt;prev.map(fault=&gt;fault.id===faultId?{...fault,acknowledged:!0}:fault))},[]),resolveFault=reactExports.useCallback(faultId=&gt;{setFaults(prev=&gt;prev.map(fault=&gt;fault.id===faultId?{...fault,resolved:!0,acknowledged:!0}:fault))},[]),clearFaults=reactExports.useCallback(()=&gt;{setFaults([]),setCache(new Map)},[]),triggerDetection=reactExports.useCallback(()=&gt;{data.length&gt;0&amp;&amp;detectFaults(data).then(result=&gt;{setFaults(result.faults),setLastAnalyzedTime(result.lastAnalyzedTime)})},[data,detectFaults]),statistics=reactExports.useMemo(()=&gt;{const stats={total:faults.length,bySeverity:{low:0,medium:0,high:0,critical:0},byType:{},acknowledged:faults.filter(f=&gt;f.acknowledged).length,resolved:faults.filter(f=&gt;f.resolved).length,unresolved:faults.filter(f=&gt;!f.resolved).length,recentFaults:faults.filter(f=&gt;Date.now()-f.timestamp&lt;36e5).length};return faults.forEach(fault=&gt;{stats.bySeverity[fault.severity]++,stats.byType[fault.type]=(stats.byType[fault.type]||0)+1}),stats},[faults]);return{faults:faults,isAnalyzing:isAnalyzing,lastAnalyzedTime:lastAnalyzedTime,config:config,statistics:statistics,updateConfig:updateConfig,updateSensitivity:updateSensitivity,acknowledgeFault:acknowledgeFault,resolveFault:resolveFault,clearFaults:clearFaults,triggerDetection:triggerDetection,cacheSize:cache.size,detectFaults:detectFaults}};function useBaseChartOptions(config={}){const theme=useTheme(),isDarkMode="dark"===theme.palette.mode;return reactExports.useMemo(()=&gt;{const themeConfig=isDarkMode?chartThemes.dark:chartThemes.light,{title:titleText,hasToolbox:hasToolbox=!0,hasDataZoom:hasDataZoom=!0,hasTopLegend:hasTopLegend=!1}=config,titleConfig=titleText?{...CHART_DESIGN_TOKENS.title.base,text:titleText,textStyle:{...CHART_DESIGN_TOKENS.title.base.textStyle,color:theme.palette.text.primary}}:void 0,gridTop=calculateGridTop({hasTitle:!!titleText,hasToolbox:hasToolbox,hasTopLegend:hasTopLegend}),gridBottom=calculateGridBottom({hasDataZoom:hasDataZoom,hasBottomLegend:!0}),legendConfig={...CHART_DESIGN_TOKENS.legend.base,top:hasTopLegend?SPACING.base:void 0,textStyle:{...CHART_DESIGN_TOKENS.legend.base.textStyle,color:theme.palette.text.secondary},pageIconColor:sesColorPalette.primary,pageIconInactiveColor:alpha(themeConfig.textColor,.3),pageTextStyle:{fontSize:TYPOGRAPHY.small.fontSize,color:themeConfig.textColor}};return{backgroundColor:"transparent",textStyle:{color:themeConfig.textColor,fontFamily:theme.typography.fontFamily},color:themeConfig.colors,grid:{left:CHART_DESIGN_TOKENS.grid.base.left,right:CHART_DESIGN_TOKENS.grid.base.right,top:gridTop,bottom:gridBottom,containLabel:!0,backgroundColor:alpha(themeConfig.gridColor,.02),borderColor:themeConfig.gridColor,borderWidth:1,show:!0},tooltip:{trigger:"axis",backgroundColor:themeConfig.tooltipBackground,borderColor:themeConfig.tooltipBorder,borderWidth:1,textStyle:{color:isDarkMode?sesColorPalette.textPrimary:"rgba(10, 14, 39, 0.9)"},axisPointer:{type:"cross",lineStyle:{color:alpha(themeConfig.textColor,.3),type:"dashed"},crossStyle:{color:alpha(themeConfig.textColor,.3)}},position:function(point,params,dom,rect,size){const tooltipWidth=size.contentSize[0],tooltipHeight=size.contentSize[1],viewWidth=size.viewSize[0],viewHeight=size.viewSize[1];let x=point[0]+20,y=point[1]-tooltipHeight/2;return x+tooltipWidth&gt;viewWidth-10&amp;&amp;(x=point[0]-tooltipWidth-20),y&lt;10?y=10:y+tooltipHeight&gt;viewHeight-10&amp;&amp;(y=viewHeight-tooltipHeight-10),[x,y]},extraCssText:"max-height: 400px; overflow-y: auto; min-width: 150px; width: auto;"},toolbox:{show:!0,orient:"horizontal",right:"2%",top:"2%",z:999,zlevel:100,tooltip:{show:!0,formatter:function(param){return{dataZoom:"Zoom",dataView:"Data",magicType:"Chart Type",restore:"Reset",saveAsImage:"Save",dataZoomReset:"Reset Zoom"}[param.name]||param.title||param.name},backgroundColor:alpha(themeConfig.tooltipBackground,.95),borderColor:themeConfig.tooltipBorder,textStyle:{fontSize:11,color:themeConfig.textColor},padding:[4,8],extraCssText:"min-width: 60px; max-width: 200px; white-space: normal; width: auto;"},feature:{dataZoom:{show:!0,title:{zoom:"Area Zoom",back:"Reset Zoom"},icon:{zoom:"path://M3,13h2v7c0,1.1,0.9,2,2,2h10c1.1,0,2-0.9,2-2v-7h2c0.6,0,1.1-0.3,1.4-0.7c0.3-0.5,0.3-1.1,0-1.5l-9-10 c-0.4-0.5-1.1-0.5-1.5,0l-9,10c-0.3,0.5-0.3,1.1,0,1.5C1.9,12.7,2.4,13,3,13z",back:"path://M12.5,8C9.85,8,8,10,8,12.5s2,4.5,4.5,4.5c1.1,0,2.1-0.4,2.8-1.1l3.2,3.2l1.4-1.4l-3.2-3.2c0.7-0.8,1.1-1.8,1.1-2.8 C17,10,15,8,12.5,8z M12.5,15c-1.4,0-2.5-1.1-2.5-2.5s1.1-2.5,2.5-2.5s2.5,1.1,2.5,2.5S13.9,15,12.5,15z M5,9h2v6H5V9z M9,9h2v6H9V9z"},yAxisIndex:"none"},dataView:{show:!1,title:"Data Table View",readOnly:!1,lang:["Data Table","Close","Refresh"]},magicType:{show:!0,type:["line","bar","stack"],title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Toggle Stack Mode"},icon:{line:"path://M4 20 L8 12 L12 16 L16 8 L20 14",bar:"path://M6 20V10h3v10H6zm5 0V3h3v17h-3zm5 0V13h3v7h-3z",stack:"path://M4 20v-8h4v8H4zm6 0V8h4v12h-4zm6 0v-16h4v16h-4z"}},saveAsImage:{show:!0,title:"Download as PNG Image",pixelRatio:2,type:"png",backgroundColor:"#fff",excludeComponents:["toolbox"],icon:"path://M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"},restore:{show:!0,title:"Reset Chart View",icon:"path://M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"}},iconStyle:{borderColor:themeConfig.textColor,borderWidth:1},emphasis:{iconStyle:{borderColor:sesColorPalette.primary,borderWidth:2,shadowBlur:10,shadowColor:alpha(sesColorPalette.primary,.3)}}},dataZoom:[{type:"inside",brushSelect:!0},{type:"slider",show:!0,height:20,bottom:40,backgroundColor:alpha(themeConfig.gridColor,.1),borderColor:themeConfig.gridColor,fillerColor:alpha(sesColorPalette.primary,.2),handleStyle:{color:sesColorPalette.primary,borderColor:sesColorPalette.primary},textStyle:{color:themeConfig.textColor}}],legend:legendConfig,title:titleConfig,getAnimationConfig:dataPointCount=&gt;{if(!dataPointCount)return CHART_DESIGN_TOKENS.animation.quality;const mode=CHART_DESIGN_TOKENS.adaptive.animationMode(dataPointCount);return CHART_DESIGN_TOKENS.animation[mode]},calculateGridTop:calculateGridTop,calculateGridBottom:calculateGridBottom}},[theme,isDarkMode,config])}function mergeChartOptions(baseOptions,customOptions,features){const merged=deepMerge({},baseOptions);return features&amp;&amp;(!1===features.showDataZoom&amp;&amp;(merged.dataZoom=[]),!1===features.showLegend&amp;&amp;merged.legend&amp;&amp;(merged.legend.show=!1),!1===features.showToolbox&amp;&amp;(merged.toolbox.show=!1),features.enableDataView&amp;&amp;merged.toolbox.feature&amp;&amp;(merged.toolbox.feature.dataView={show:!0,readOnly:!1,title:"Data View"}),features.enableMagicType&amp;&amp;merged.toolbox.feature&amp;&amp;(merged.toolbox.feature.magicType={show:!0,type:["line","bar","stack"],title:{line:"Line",bar:"Bar",stack:"Stack"}})),deepMerge(merged,customOptions)}function deepMerge(target,source){if(!source)return target;if(!target)return source;if(Array.isArray(source))return[...source];if(!isObject(source))return source;const output={...target};return Object.keys(source).forEach(key=&gt;{const sourceValue=source[key],targetValue=target[key];"function"==typeof sourceValue?output[key]=sourceValue:Array.isArray(sourceValue)?output[key]=[...sourceValue]:isObject(sourceValue)?isObject(targetValue)?output[key]=deepMerge(targetValue,sourceValue):output[key]=deepMerge({},sourceValue):output[key]=sourceValue}),output}function isObject(item){return item&amp;&amp;"object"==typeof item&amp;&amp;!Array.isArray(item)}function useBarChartClick(){const[modalOpen,setModalOpen]=reactExports.useState(!1),[selectedData,setSelectedData]=reactExports.useState(null);return{modalOpen:modalOpen,selectedData:selectedData,handleBarClick:reactExports.useCallback(params=&gt;{if("series"===params.componentType&amp;&amp;"bar"===params.seriesType){const{seriesName:seriesName,dataIndex:dataIndex,value:value,data:data}=params,rawData=(null==data?void 0:data.rawData)||[],timestamp=(null==data?void 0:data.timestamp)||(null==data?void 0:data[0])||Date.now(),aggregationType=(null==data?void 0:data.aggregationType)||"average";setSelectedData({seriesName:seriesName||"Data",dataIndex:dataIndex,value:Array.isArray(value)?value[1]:value,timestamp:timestamp,aggregationType:aggregationType,rawData:rawData}),setModalOpen(!0)}},[]),closeModal:reactExports.useCallback(()=&gt;{setModalOpen(!1),setSelectedData(null)},[])}}function createBarChartClickEvent(handler){return{click:handler}}const DashboardContext=reactExports.createContext(void 0),useDashboardContext=()=&gt;{const context=reactExports.useContext(DashboardContext);if(!context)throw new Error("useDashboardContext must be used within a DashboardProvider");return context},DashboardProvider=({children:children,initialDashboardId:initialDashboardId="",initialDashboardName:initialDashboardName="Untitled Dashboard",isViewer:isViewer=!1,aceSites:aceSites=[],acePoints:acePoints=[],aceDataRefresh:aceDataRefresh})=&gt;{const queryClient=useQueryClient(),user=useSelector(state=&gt;state.auth.firebaseUser),aceToken=useSelector(state=&gt;state.auth.aceToken),[currentDashboardId,setCurrentDashboardId]=reactExports.useState(initialDashboardId),[dashboardName,setDashboardName]=reactExports.useState(initialDashboardName),[monitors,setMonitors]=reactExports.useState([]),[layouts,setLayouts]=reactExports.useState({}),[folders,setFolders]=reactExports.useState([]),[globalTimeRange,setGlobalTimeRangeState]=reactExports.useState(globalTimeRangeStore.getState());reactExports.useEffect(()=&gt;globalTimeRangeStore.subscribe(newState=&gt;{setGlobalTimeRangeState(newState)}),[]);const[customStartDate,setCustomStartDate]=reactExports.useState(()=&gt;localStorage.getItem("dashboardCustomStartDate")||null),[customEndDate,setCustomEndDate]=reactExports.useState(()=&gt;localStorage.getItem("dashboardCustomEndDate")||null),[snapshots,setSnapshots]=reactExports.useState([]);reactExports.useEffect(()=&gt;{customStartDate?localStorage.setItem("dashboardCustomStartDate",customStartDate):localStorage.removeItem("dashboardCustomStartDate")},[customStartDate]),reactExports.useEffect(()=&gt;{customEndDate?localStorage.setItem("dashboardCustomEndDate",customEndDate):localStorage.removeItem("dashboardCustomEndDate")},[customEndDate]);const[selectedMonitorId,setSelectedMonitorId]=reactExports.useState(null),[loadingState,setLoadingState]=reactExports.useState({dashboards:!0,activeDashboard:!1,snapshots:!1,creatingMonitor:!1,updatingMonitor:!1,deletingMonitor:!1,creatingFolder:!1,updatingFolder:!1,deletingFolder:!1,savingDashboard:!1}),[errorState,setErrorState]=reactExports.useState({dashboards:null,activeDashboard:null,snapshots:null,general:null}),{data:dashboards=[],isLoading:dashboardsLoading,error:dashboardsError}=useQuery({queryKey:["dashboards",null==user?void 0:user.uid],queryFn:async()=&gt;{try{if(!(null==user?void 0:user.uid))throw new Error("No user ID");return await getUserDashboardsFromFirestore(user.uid)}catch(error){throw console.error("[DASHBOARD] Failed to fetch dashboards:",error),error}},enabled:!!(null==user?void 0:user.uid),retry:2,retryDelay:attemptIndex=&gt;Math.min(1e3*2**attemptIndex,3e4)});reactExports.useEffect(()=&gt;{setLoadingState(prev=&gt;({...prev,dashboards:dashboardsLoading})),dashboardsError&amp;&amp;setErrorState(prev=&gt;({...prev,dashboards:dashboardsError}))},[dashboardsLoading,dashboardsError]);const saveDashboardMutation=useMutation({mutationFn:async data=&gt;{try{if(!(null==user?void 0:user.uid))throw new Error("No user authenticated");const visualizationConfigs=(data.monitors||[]).map(monitor=&gt;({id:monitor.id,name:monitor.title,gridPos:monitor.layout||{i:monitor.id,x:0,y:0,w:6,h:8},selectedChartType:monitor.chartType,selectedSite:monitor.siteId,selectedPoints:monitor.selectedPoints,timeRange:monitor.timeRange,...monitor.config}));return saveDashboardConfiguration(user.uid,data.id,data.layouts,visualizationConfigs,data.name,"24h",customStartDate,customEndDate)}catch(error){throw console.error("[DASHBOARD] Save failed:",error),error}},onMutate:async data=&gt;{setLoadingState(prev=&gt;({...prev,savingDashboard:!0})),await queryClient.cancelQueries({queryKey:["dashboards",null==user?void 0:user.uid]});const previousDashboards=queryClient.getQueryData(["dashboards",null==user?void 0:user.uid])||[];return queryClient.setQueryData(["dashboards",null==user?void 0:user.uid],old=&gt;{if(!old)return[{id:data.id,name:data.name}];return old.find(d=&gt;d.id===data.id)?old.map(d=&gt;d.id===data.id?{...d,name:data.name,updatedAt:new Date}:d):[...old,{id:data.id,name:data.name,createdAt:new Date,updatedAt:new Date}]}),{previousDashboards:previousDashboards,dashboardData:data}},onError:(error,variables,context)=&gt;{(null==context?void 0:context.previousDashboards)&amp;&amp;queryClient.setQueryData(["dashboards",null==user?void 0:user.uid],context.previousDashboards),setErrorState(prev=&gt;({...prev,general:new Error(`Failed to save dashboard: ${error.message}`)})),console.error("[DASHBOARD] Dashboard save error:",error)},onSuccess:(data,variables,context)=&gt;{queryClient.invalidateQueries({queryKey:["dashboards",null==user?void 0:user.uid]}),console.log("[DASHBOARD] Dashboard saved successfully")},onSettled:()=&gt;{setLoadingState(prev=&gt;({...prev,savingDashboard:!1}))}}),handleDashboardChange=reactExports.useCallback(async dashboardId=&gt;{var _a;if(dashboardId&amp;&amp;(null==user?void 0:user.uid))try{setLoadingState(prev=&gt;({...prev,activeDashboard:!0})),setErrorState(prev=&gt;({...prev,activeDashboard:null}));const dashboard=await loadDashboardConfiguration(user.uid,dashboardId);if(dashboard){setCurrentDashboardId(dashboardId),setDashboardName(dashboard.name),setActiveDashboardId(user.uid,dashboardId);const monitorsFromWidgets=(null==(_a=dashboard.widgets)?void 0:_a.map(widget=&gt;{const site=aceSites.find(s=&gt;s.id===widget.selectedSite),siteName=(null==site?void 0:site.nice_name)||(null==site?void 0:site.name)||widget.selectedSite||"";return{id:widget.id,title:widget.name||"Untitled",chartType:widget.selectedChartType,siteId:widget.selectedSite||"",siteName:siteName,selectedPoints:(Array.isArray(widget.selectedPoints)?widget.selectedPoints:[]).map(point=&gt;({id:point.id,name:point.name,unit:point.unit||""})),timeRange:widget.timeRange||"24h",config:{refreshInterval:widget.autoRefreshInterval,...widget},folderId:void 0,layout:widget.gridPos}}))||[];setMonitors(monitorsFromWidgets),setLayouts(dashboard.layouts||{}),setFolders([]),dashboard.customStartDate&amp;&amp;setCustomStartDate(dashboard.customStartDate),dashboard.customEndDate&amp;&amp;setCustomEndDate(dashboard.customEndDate)}}catch(error){console.error("[DASHBOARD] Failed to load dashboard:",error),setErrorState(prev=&gt;({...prev,activeDashboard:error}))}finally{setLoadingState(prev=&gt;({...prev,activeDashboard:!1}))}},[null==user?void 0:user.uid,aceSites]),handleDashboardSave=withErrorHandling(async()=&gt;{try{if(!dashboardName||""===dashboardName.trim())throw new Error("Please provide a dashboard name");const dashboardData={id:currentDashboardId||`dashboard-${Date.now()}`,name:dashboardName.trim(),monitors:monitors,layouts:layouts,folders:folders};await saveDashboardMutation.mutateAsync(dashboardData),currentDashboardId||setCurrentDashboardId(dashboardData.id),(null==user?void 0:user.uid)&amp;&amp;setActiveDashboardId(user.uid,dashboardData.id),console.log("[DASHBOARD] Dashboard saved successfully")}catch(error){const userMessage=formatErrorForUser(error);throw setErrorState(prev=&gt;({...prev,general:error})),reportError(error,{context:"dashboard-save",dashboardName:dashboardName}),new Error(userMessage)}},{retries:2,retryDelay:1e3,onError:error=&gt;{console.error("[DASHBOARD] Dashboard save failed:",error)}}),handleCreateNewDashboard=reactExports.useCallback(()=&gt;{const newDashboardId=`dashboard-${Date.now()}-${Math.floor(1e3*Math.random())}`;setMonitors([]),setLayouts({}),setCurrentDashboardId(newDashboardId),setDashboardName("Untitled Dashboard"),(null==user?void 0:user.uid)&amp;&amp;setActiveDashboardId(user.uid,newDashboardId)},[null==user?void 0:user.uid]);reactExports.useEffect(()=&gt;{(null==user?void 0:user.uid)&amp;&amp;(setLoadingState(prev=&gt;({...prev,snapshots:!0})),snapshotService.getUserSnapshots(user.uid).then(setSnapshots).catch(error=&gt;{console.error("[DASHBOARD] Failed to load snapshots:",error),setErrorState(prev=&gt;({...prev,snapshots:error}))}).finally(()=&gt;{setLoadingState(prev=&gt;({...prev,snapshots:!1}))}))},[null==user?void 0:user.uid]),reactExports.useEffect(()=&gt;{if(dashboards&amp;&amp;dashboards.length&gt;0&amp;&amp;!currentDashboardId&amp;&amp;(null==user?void 0:user.uid)&amp;&amp;!loadingState.dashboards){console.log("[DashboardContainer] Found dashboards:",dashboards.length);const activeDashboardId=getActiveDashboardId(user.uid);dashboards.find(d=&gt;d.id===activeDashboardId)?(console.log("[DashboardContainer] Loading active dashboard:",activeDashboardId),handleDashboardChange(activeDashboardId)):1===dashboards.length&amp;&amp;(console.log("[DashboardContainer] Loading single dashboard:",dashboards[0].id),handleDashboardChange(dashboards[0].id))}},[dashboards,currentDashboardId,null==user?void 0:user.uid,loadingState.dashboards,handleDashboardChange]);const handleSnapshotSave=reactExports.useCallback(async snapshot=&gt;{if(null==user?void 0:user.uid)try{await snapshotService.createSnapshot(user.uid,snapshot);const updatedSnapshots=await snapshotService.getUserSnapshots(user.uid);setSnapshots(updatedSnapshots)}catch(error){console.error("[DASHBOARD] Failed to save snapshot:",error),setErrorState(prev=&gt;({...prev,snapshots:error}))}},[null==user?void 0:user.uid]),handleSnapshotDelete=reactExports.useCallback(async snapshotId=&gt;{try{const snapshot=snapshots.find(s=&gt;s.id===snapshotId);snapshot&amp;&amp;(await snapshotService.deleteSnapshot(snapshotId,snapshot.chartImage),setSnapshots(snapshots.filter(s=&gt;s.id!==snapshotId)))}catch(error){console.error("[DASHBOARD] Failed to delete snapshot:",error),setErrorState(prev=&gt;({...prev,snapshots:error}))}},[snapshots]),handleSnapshotExport=reactExports.useCallback(snapshotId=&gt;{const snapshot=snapshots.find(s=&gt;s.id===snapshotId);snapshot&amp;&amp;snapshotService.exportSnapshot(snapshot)},[snapshots]),handleErrorReset=reactExports.useCallback(()=&gt;{console.error("[DashboardContext] handleErrorReset called - this will reload the page!"),console.trace("handleErrorReset call stack");const lastReloadTime=sessionStorage.getItem("dashboard_error_reload"),now=Date.now();if(lastReloadTime&amp;&amp;now-parseInt(lastReloadTime)&lt;1e4)return console.error("[DashboardContext] Reload loop detected! Skipping reload."),setErrorState({dashboards:null,activeDashboard:null,snapshots:null,general:null}),void setTimeout(()=&gt;{sessionStorage.removeItem("dashboard_error_reload")},1e4);sessionStorage.setItem("dashboard_error_reload",now.toString()),setErrorState({dashboards:null,activeDashboard:null,snapshots:null,general:null}),null==aceDataRefresh||aceDataRefresh.refreshAll(),window.location.reload()},[aceDataRefresh]);reactExports.useEffect(()=&gt;{(null==user?void 0:user.uid)&amp;&amp;aceToken&amp;&amp;TokenSyncService.syncTokenStatus().then(status=&gt;{status.localToken&amp;&amp;!status.firestoreToken&amp;&amp;(console.log("[DashboardContainer] Token found in Redux but not in Firestore, syncing..."),TokenSyncService.forceSyncToFirestore().then(()=&gt;{console.log("[DashboardContainer] âœ… Token successfully synced to Firestore"),aceDataRefresh&amp;&amp;aceDataRefresh.refreshAll()}).catch(error=&gt;{console.error("[DashboardContainer] âŒ Failed to sync token to Firestore:",error),setErrorState(prev=&gt;({...prev,general:new Error("Failed to sync authentication token. Please try refreshing the page.")}))}))}).catch(error=&gt;{console.error("[DashboardContainer] Failed to check token sync status:",error)})},[null==user?void 0:user.uid,aceToken]);const createMonitorMutation=useMutation({mutationFn:async monitor=&gt;(await new Promise(resolve=&gt;setTimeout(resolve,1e3)),monitor),onMutate:async newMonitor=&gt;{setLoadingState(prev=&gt;({...prev,creatingMonitor:!0})),await queryClient.cancelQueries({queryKey:["monitors",currentDashboardId]});const previousMonitors=monitors,optimisticMonitor={...newMonitor,id:newMonitor.id||`temp-${Date.now()}`,title:newMonitor.title||"Creating..."};return setMonitors(prev=&gt;[...prev,optimisticMonitor]),{previousMonitors:previousMonitors,optimisticMonitor:optimisticMonitor}},onError:(error,newMonitor,context)=&gt;{(null==context?void 0:context.previousMonitors)&amp;&amp;setMonitors(context.previousMonitors),setErrorState(prev=&gt;({...prev,general:new Error(`Failed to create monitor: ${error.message}`)})),console.error("[DASHBOARD] Monitor creation failed:",error)},onSuccess:(data,variables,context)=&gt;{(null==context?void 0:context.optimisticMonitor)&amp;&amp;setMonitors(prev=&gt;prev.map(monitor=&gt;monitor.id===context.optimisticMonitor.id?{...data,id:data.id||context.optimisticMonitor.id}:monitor)),console.log("[DASHBOARD] Monitor created successfully")},onSettled:()=&gt;{setLoadingState(prev=&gt;({...prev,creatingMonitor:!1}))}}),updateMonitorMutation=useMutation({mutationFn:async({monitorId:monitorId,updates:updates})=&gt;(await new Promise(resolve=&gt;setTimeout(resolve,500)),{monitorId:monitorId,updates:updates}),onMutate:async({monitorId:monitorId,updates:updates})=&gt;{setLoadingState(prev=&gt;({...prev,updatingMonitor:!0})),await queryClient.cancelQueries({queryKey:["monitors",currentDashboardId]});const previousMonitors=monitors,targetMonitor=monitors.find(m=&gt;m.id===monitorId);return setMonitors(prev=&gt;prev.map(monitor=&gt;monitor.id===monitorId?{...monitor,...updates}:monitor)),{previousMonitors:previousMonitors,targetMonitor:targetMonitor,monitorId:monitorId,updates:updates}},onError:(error,variables,context)=&gt;{(null==context?void 0:context.previousMonitors)&amp;&amp;setMonitors(context.previousMonitors),setErrorState(prev=&gt;({...prev,general:new Error(`Failed to update monitor: ${error.message}`)})),console.error("[DASHBOARD] Monitor update failed:",error)},onSuccess:(data,variables,context)=&gt;{console.log("[DASHBOARD] Monitor updated successfully")},onSettled:()=&gt;{setLoadingState(prev=&gt;({...prev,updatingMonitor:!1}))}}),deleteMonitorMutation=useMutation({mutationFn:async monitorId=&gt;(await new Promise(resolve=&gt;setTimeout(resolve,500)),monitorId),onMutate:async monitorId=&gt;{setLoadingState(prev=&gt;({...prev,deletingMonitor:!0})),await queryClient.cancelQueries({queryKey:["monitors",currentDashboardId]});const previousMonitors=monitors,previousFolders=folders,deletedMonitor=monitors.find(m=&gt;m.id===monitorId);return setMonitors(prev=&gt;prev.filter(monitor=&gt;monitor.id!==monitorId)),setFolders(prev=&gt;prev.map(folder=&gt;({...folder,monitorIds:folder.monitorIds.filter(id=&gt;id!==monitorId)}))),{previousMonitors:previousMonitors,previousFolders:previousFolders,deletedMonitor:deletedMonitor}},onError:(error,monitorId,context)=&gt;{(null==context?void 0:context.previousMonitors)&amp;&amp;setMonitors(context.previousMonitors),(null==context?void 0:context.previousFolders)&amp;&amp;setFolders(context.previousFolders),setErrorState(prev=&gt;({...prev,general:new Error(`Failed to delete monitor: ${error.message}`)})),console.error("[DASHBOARD] Monitor deletion failed:",error)},onSuccess:(data,variables,context)=&gt;{console.log("[DASHBOARD] Monitor deleted successfully")},onSettled:()=&gt;{setLoadingState(prev=&gt;({...prev,deletingMonitor:!1}))}}),setGlobalTimeRangeEnabled=reactExports.useCallback(enabled=&gt;{globalTimeRangeStore.setEnabled(enabled),enabled&amp;&amp;globalTimeRangeStore.setSyncedChartIds(monitors.map(m=&gt;m.id))},[monitors]),setGlobalTimeRange=reactExports.useCallback((timeRange,customStartDate2,customEndDate2)=&gt;{globalTimeRangeStore.setTimeRange(timeRange),void 0===customStartDate2&amp;&amp;void 0===customEndDate2||globalTimeRangeStore.setCustomDates(customStartDate2||null,customEndDate2||null)},[]),toggleChartSync=reactExports.useCallback((chartId,synced)=&gt;{synced?globalTimeRangeStore.addSyncedChartId(chartId):globalTimeRangeStore.removeSyncedChartId(chartId)},[]),getEffectiveTimeRange=reactExports.useCallback(monitorId=&gt;{var _a,_b;const monitor=monitors.find(m=&gt;m.id===monitorId);return globalTimeRange.enabled&amp;&amp;globalTimeRange.syncedChartIds.includes(monitorId)?{timeRange:globalTimeRange.timeRange,customStartDate:globalTimeRange.customStartDate,customEndDate:globalTimeRange.customEndDate}:{timeRange:(null==monitor?void 0:monitor.timeRange)||"24h",customStartDate:null==(_a=null==monitor?void 0:monitor.config)?void 0:_a.customStartDate,customEndDate:null==(_b=null==monitor?void 0:monitor.config)?void 0:_b.customEndDate}},[globalTimeRange,monitors]),addMonitor=reactExports.useCallback(monitor=&gt;{createMonitorMutation.mutate(monitor)},[createMonitorMutation]),updateMonitor=reactExports.useCallback((monitorId,updates)=&gt;{updateMonitorMutation.mutate({monitorId:monitorId,updates:updates})},[updateMonitorMutation]),deleteMonitor=reactExports.useCallback(monitorId=&gt;{deleteMonitorMutation.mutate(monitorId)},[deleteMonitorMutation]),duplicateMonitor=reactExports.useCallback(monitorId=&gt;{const monitor=monitors.find(m=&gt;m.id===monitorId);if(!monitor)return null;const newMonitor={...monitor,id:`${monitor.id}_copy_${Date.now()}`,title:`${monitor.title} (Copy)`};return addMonitor(newMonitor),newMonitor},[monitors,addMonitor]),moveMonitorToFolder=reactExports.useCallback((monitorId,folderId)=&gt;{setFolders(prev=&gt;{const updated=prev.map(folder=&gt;({...folder,monitorIds:folder.monitorIds.filter(id=&gt;id!==monitorId)}));if(folderId){const targetFolder=updated.find(f=&gt;f.id===folderId);targetFolder&amp;&amp;targetFolder.monitorIds.push(monitorId)}return updated}),updateMonitor(monitorId,{folderId:folderId||void 0})},[updateMonitor]),createFolderMutation=useMutation({mutationFn:async folderData=&gt;(await new Promise(resolve=&gt;setTimeout(resolve,300)),folderData),onMutate:async({name:name,color:color})=&gt;{setLoadingState(prev=&gt;({...prev,creatingFolder:!0})),await queryClient.cancelQueries({queryKey:["folders",currentDashboardId]});const previousFolders=folders,newFolder={id:`folder_${Date.now()}`,name:name,color:color,monitorIds:[],isExpanded:!0};return setFolders(prev=&gt;[...prev,newFolder]),{previousFolders:previousFolders,newFolder:newFolder}},onError:(error,variables,context)=&gt;{(null==context?void 0:context.previousFolders)&amp;&amp;setFolders(context.previousFolders),setErrorState(prev=&gt;({...prev,general:new Error(`Failed to create folder: ${error.message}`)})),console.error("[DASHBOARD] Folder creation failed:",error)},onSuccess:(data,variables,context)=&gt;{console.log("[DASHBOARD] Folder created successfully")},onSettled:()=&gt;{setLoadingState(prev=&gt;({...prev,creatingFolder:!1}))}}),updateFolderMutation=useMutation({mutationFn:async({folderId:folderId,updates:updates})=&gt;(await new Promise(resolve=&gt;setTimeout(resolve,300)),{folderId:folderId,updates:updates}),onMutate:async({folderId:folderId,updates:updates})=&gt;{setLoadingState(prev=&gt;({...prev,updatingFolder:!0})),await queryClient.cancelQueries({queryKey:["folders",currentDashboardId]});const previousFolders=folders;return setFolders(prev=&gt;prev.map(folder=&gt;folder.id===folderId?{...folder,...updates}:folder)),{previousFolders:previousFolders,folderId:folderId,updates:updates}},onError:(error,variables,context)=&gt;{(null==context?void 0:context.previousFolders)&amp;&amp;setFolders(context.previousFolders),setErrorState(prev=&gt;({...prev,general:new Error(`Failed to update folder: ${error.message}`)})),console.error("[DASHBOARD] Folder update failed:",error)},onSuccess:(data,variables,context)=&gt;{console.log("[DASHBOARD] Folder updated successfully")},onSettled:()=&gt;{setLoadingState(prev=&gt;({...prev,updatingFolder:!1}))}}),deleteFolderMutation=useMutation({mutationFn:async folderId=&gt;(await new Promise(resolve=&gt;setTimeout(resolve,300)),folderId),onMutate:async folderId=&gt;{setLoadingState(prev=&gt;({...prev,deletingFolder:!0})),await queryClient.cancelQueries({queryKey:["folders",currentDashboardId]});const previousFolders=folders,previousMonitors=monitors;return setFolders(prev=&gt;prev.filter(folder=&gt;folder.id!==folderId)),setMonitors(prev=&gt;prev.map(monitor=&gt;monitor.folderId===folderId?{...monitor,folderId:void 0}:monitor)),{previousFolders:previousFolders,previousMonitors:previousMonitors}},onError:(error,folderId,context)=&gt;{(null==context?void 0:context.previousFolders)&amp;&amp;setFolders(context.previousFolders),(null==context?void 0:context.previousMonitors)&amp;&amp;setMonitors(context.previousMonitors),setErrorState(prev=&gt;({...prev,general:new Error(`Failed to delete folder: ${error.message}`)})),console.error("[DASHBOARD] Folder deletion failed:",error)},onSuccess:(data,variables,context)=&gt;{console.log("[DASHBOARD] Folder deleted successfully")},onSettled:()=&gt;{setLoadingState(prev=&gt;({...prev,deletingFolder:!1}))}}),createFolder=reactExports.useCallback((name,color)=&gt;{const folderId=`folder_${Date.now()}`;return createFolderMutation.mutate({name:name,color:color}),folderId},[createFolderMutation]),updateFolder=reactExports.useCallback((folderId,updates)=&gt;{updateFolderMutation.mutate({folderId:folderId,updates:updates})},[updateFolderMutation]),deleteFolder=reactExports.useCallback(folderId=&gt;{deleteFolderMutation.mutate(folderId)},[deleteFolderMutation]),toggleFolderExpanded=reactExports.useCallback(folderId=&gt;{setFolders(prev=&gt;prev.map(folder=&gt;folder.id===folderId?{...folder,isExpanded:!folder.isExpanded}:folder))},[]),getDashboardData=reactExports.useCallback(()=&gt;({id:currentDashboardId,name:dashboardName,monitors:monitors,layouts:layouts,folders:folders}),[currentDashboardId,dashboardName,monitors,layouts,folders]),isLoading=loadingState.dashboards||loadingState.activeDashboard,hasError=errorState.dashboards||errorState.activeDashboard||errorState.general,value={currentDashboardId:currentDashboardId,dashboardName:dashboardName,monitors:monitors,layouts:layouts,folders:folders,customStartDate:customStartDate,customEndDate:customEndDate,globalTimeRange:globalTimeRange,selectedMonitorId:selectedMonitorId,isViewer:isViewer,isLoading:isLoading,error:hasError,loadingState:loadingState,errorState:errorState,dashboards:dashboards,snapshots:snapshots,aceSites:aceSites,acePoints:acePoints,aceDataRefresh:aceDataRefresh,saveDashboardMutation:saveDashboardMutation,setCurrentDashboardId:setCurrentDashboardId,setDashboardName:setDashboardName,setMonitors:setMonitors,setLayouts:setLayouts,setFolders:setFolders,setCustomStartDate:setCustomStartDate,setCustomEndDate:setCustomEndDate,setSelectedMonitorId:setSelectedMonitorId,setErrorState:setErrorState,setGlobalTimeRangeEnabled:setGlobalTimeRangeEnabled,setGlobalTimeRange:setGlobalTimeRange,toggleChartSync:toggleChartSync,getEffectiveTimeRange:getEffectiveTimeRange,onDashboardChange:handleDashboardChange,onDashboardSave:handleDashboardSave,onCreateNewDashboard:handleCreateNewDashboard,onSnapshotSave:handleSnapshotSave,onSnapshotDelete:handleSnapshotDelete,onSnapshotExport:handleSnapshotExport,onErrorReset:handleErrorReset,addMonitor:addMonitor,updateMonitor:updateMonitor,deleteMonitor:deleteMonitor,duplicateMonitor:duplicateMonitor,moveMonitorToFolder:moveMonitorToFolder,createFolder:createFolder,updateFolder:updateFolder,deleteFolder:deleteFolder,toggleFolderExpanded:toggleFolderExpanded,getDashboardData:getDashboardData};return jsxRuntimeExports.jsx(DashboardContext.Provider,{value:value,children:children})},useChartDataSimple=options=&gt;{var _a;const{selectedPoints:selectedPoints=[],timeRange:chartTimeRange="24h",customStartDate:chartCustomStart,customEndDate:chartCustomEnd,monitorId:monitorId,refreshInterval:refreshInterval,enabled:enabled=!0,enableBatching:enableBatching,batchingOptions:batchingOptions,enableMetrics:enableMetrics=featureFlags.enablePerformanceMonitoring}=options,{globalTimeRange:globalTimeRange}=useGlobalTimeRangeStore(),{getEffectiveTimeRange:getEffectiveTimeRange,saveIndividualChartSettings:saveIndividualChartSettings}=useGlobalTimeRangeStore();let effectiveTimeRange={timeRange:chartTimeRange,customStartDate:chartCustomStart,customEndDate:chartCustomEnd};const globalEffective=getEffectiveTimeRange(monitorId);if(globalEffective)effectiveTimeRange=globalEffective,console.log("[useChartData] Using global/sticky time range:",globalEffective.timeRange);else{!globalTimeRange.enabled&amp;&amp;monitorId&amp;&amp;saveIndividualChartSettings(monitorId,{timeRange:chartTimeRange,customStartDate:chartCustomStart,customEndDate:chartCustomEnd});try{const dashboardContext=useDashboardContext();monitorId&amp;&amp;(null==dashboardContext?void 0:dashboardContext.getEffectiveTimeRange)&amp;&amp;(effectiveTimeRange=dashboardContext.getEffectiveTimeRange(monitorId))}catch(e){}}const timeRange=effectiveTimeRange.timeRange,reduxToken=useSelector(state=&gt;state.auth.aceToken),aceToken=reduxToken||getAceApiToken();aceToken?console.log("[useChartData] ACE token found:",aceToken?"YES":"NO","source:",reduxToken?"Redux":"localStorage"):console.warn("[useChartData] No ACE token found in Redux or localStorage");const metricsRef=reactExports.useRef({requestCount:0,batchingUsed:0,fallbackUsed:0,totalResponseTime:0,errors:0});(null==selectedPoints?void 0:selectedPoints.some(p=&gt;{var _a2,_b;return(null==(_a2=null==p?void 0:p.name)?void 0:_a2.includes("Temp"))||(null==(_b=null==p?void 0:p.name)?void 0:_b.includes("temp"))}))&amp;&amp;console.warn("[useChartDataSimple] Called with temperature points:",{selectedPoints:selectedPoints.map(p=&gt;({name:null==p?void 0:p.name,unit:null==p?void 0:p.unit,markerTag:null==p?void 0:p.markerTag})),timeRange:timeRange,enabled:enabled});const{startTime:startTime,endTime:endTime}=reactExports.useMemo(()=&gt;{const result=function calculateTimeRange(timeRange,customStartDate,customEndDate){if(customStartDate&amp;&amp;customEndDate)return{startTime:customStartDate,endTime:customEndDate};const now=new Date;let start,end=now;switch(timeRange){case"1h":start=subHours(now,1);break;case"3h":start=subHours(now,3);break;case"4h":start=subHours(now,4);break;case"6h":start=subHours(now,6);break;case"8h":start=subHours(now,8);break;case"12h":start=subHours(now,12);break;case"24h":case"1d":start=subDays(now,1);break;case"3d":start=subDays(now,3);break;case"7d":case"1w":start=subDays(now,7);break;case"30d":case"1m":start=subDays(now,30);break;case"90d":case"3m":start=subDays(now,90);break;case"6M":case"6m":case"180d":start=subMonths(now);break;case"1Y":case"1y":case"365d":start=subYears(now);break;case"today":start=new Date(now),start.setHours(0,0,0,0);break;case"yesterday":const yesterday=new Date(now);yesterday.setDate(yesterday.getDate()-1),start=new Date(yesterday),start.setHours(0,0,0,0),end=new Date(yesterday),end.setHours(23,59,59,999);break;default:if(timeRange.includes(" - ")){const[startStr,endStr]=timeRange.split(" - ");return{startTime:formatLocalTimeForAPI(new Date(startStr.trim())),endTime:formatLocalTimeForAPI(new Date(endStr.trim()))}}start=subDays(now,1)}return{startTime:formatLocalTimeForAPI(start),endTime:formatLocalTimeForAPI(end)}}(timeRange,effectiveTimeRange.customStartDate,effectiveTimeRange.customEndDate);return console.log("ðŸ” [useChartData] TimeRange calculation:",{inputTimeRange:timeRange,customDates:{start:effectiveTimeRange.customStartDate,end:effectiveTimeRange.customEndDate},calculatedStartTime:result.startTime,calculatedEndTime:result.endTime,startDate:new Date(result.startTime),endDate:new Date(result.endTime),timeSpanDays:((new Date(result.endTime).getTime()-new Date(result.startTime).getTime())/864e5).toFixed(1),timeSpanHours:((new Date(result.endTime).getTime()-new Date(result.startTime).getTime())/36e5).toFixed(1)}),"365d"===timeRange&amp;&amp;console.warn("ðŸš¨ [TIMERANGE DEBUG] 365d selected - tracing full flow:",{originalTimeRange:timeRange,startTime:result.startTime,endTime:result.endTime,daysCalculated:((new Date(result.endTime).getTime()-new Date(result.startTime).getTime())/864e5).toFixed(1),isCorrect365Days:Math.abs((new Date(result.endTime).getTime()-new Date(result.startTime).getTime())/864e5-365)&lt;1,stackTrace:(new Error).stack}),result},[timeRange,effectiveTimeRange.customStartDate,effectiveTimeRange.customEndDate]),pointNames=reactExports.useMemo(()=&gt;{if(console.log("ðŸ” [useChartData] CRITICAL DEBUG - Extracting point names:",{hasSelectedPoints:!!selectedPoints,isArray:Array.isArray(selectedPoints),length:null==selectedPoints?void 0:selectedPoints.length,firstPoint:null==selectedPoints?void 0:selectedPoints[0],allPointsPreview:null==selectedPoints?void 0:selectedPoints.map(p=&gt;({hasName:!!(null==p?void 0:p.name),name:null==p?void 0:p.name,hasOriginalName:!!(null==p?void 0:p.original_name),originalName:null==p?void 0:p.original_name,hasId:!!(null==p?void 0:p.id),id:null==p?void 0:p.id,keys:p?Object.keys(p):[]}))}),!selectedPoints||!Array.isArray(selectedPoints))return console.warn("âš ï¸ [useChartData] selectedPoints is not an array!"),[];const filtered=selectedPoints.filter(p=&gt;(null==p?void 0:p.name)||(null==p?void 0:p.original_name)),names=filtered.map(p=&gt;{const apiName=(null==p?void 0:p.original_name)||p.name;return console.log("ðŸ” [useChartData] Resolving API name for point:",{displayName:p.name,originalName:null==p?void 0:p.original_name,selectedApiName:apiName}),apiName});return console.log("ðŸ” [useChartData] Point names extraction result:",{totalPoints:selectedPoints.length,pointsWithName:filtered.length,extractedNames:names,usedOriginalNames:names.filter((n,i)=&gt;{var _a2;return n===(null==(_a2=selectedPoints[i])?void 0:_a2.original_name)}).length}),names},[selectedPoints]),shouldUseBatching=reactExports.useMemo(()=&gt;{if(void 0!==enableBatching)return enableBatching;if(!isBatchingEnabled())return!1;const pointCount=pointNames.length;return pointCount&gt;=2||!(1!==pointCount||!refreshInterval)},[enableBatching,pointNames.length,refreshInterval]),queryResult=useQuery({queryKey:shouldUseBatching?["timeseries-batched",pointNames,startTime,endTime,batchingOptions]:["timeseries",pointNames,startTime,endTime],queryFn:async()=&gt;{if(console.log("ðŸš€ [useChartData] Query function called!",{pointNamesLength:pointNames.length,pointNames:pointNames,enabled:enabled&amp;&amp;pointNames.length&gt;0}),!pointNames.length)return console.warn("âš ï¸ [useChartData] Query aborted - no point names!"),[];const requestStartTime=Date.now();async function fetchDirectAPI(){var _a2,_b;const startDate=new Date(startTime),endDate=new Date(endTime);console.log("ðŸ“Š [useChartData] Fetching timeseries via Cloudflare paginated endpoint:",{pointNames:pointNames,startDate:startDate.toISOString(),endDate:endDate.toISOString(),timeSpanDays:((endDate.getTime()-startDate.getTime())/864e5).toFixed(1),timeSpanHours:((endDate.getTime()-startDate.getTime())/36e5).toFixed(1),originalTimeRange:timeRange,useRawData:!0});const firstPointName=(null==(_a2=selectedPoints[0])?void 0:_a2.name)||"",siteName=firstPointName.split("/")[1]||"ses_falls_city";if(console.log("ðŸ¢ [useChartData] Extracted site from point name:",{pointName:firstPointName,extractedSite:siteName}),!aceToken)throw new Error("Authentication required: ACE token not found in Redux state");const groupedData=await fetchTimeseriesForPoints(siteName,selectedPoints,startDate.toISOString(),endDate.toISOString(),aceToken,(samplesCount,hasMore)=&gt;{console.log("ðŸ“¥ [useChartData] Paginated progress:",{samplesCount:samplesCount,hasMore:hasMore})},!1),results={point_samples:Object.entries(groupedData).map(([pointName,dataPoints])=&gt;{var _a3;return{pointName:pointName,pointId:pointName,data:dataPoints.map(dp=&gt;[dp.timestamp,dp.value]),unit:null==(_a3=selectedPoints.find(p=&gt;p.name===pointName))?void 0:_a3.unit}})};console.log("ðŸ“ˆ [useChartData] Paginated endpoint results:",{hasResults:!!results,resultsType:typeof results,isArray:Array.isArray(results),pointSamplesLength:null==(_b=null==results?void 0:results.point_samples)?void 0:_b.length,totalDataPoints:results.point_samples.reduce((sum,ps)=&gt;sum+ps.data.length,0),originalTimeRange:timeRange,requestedTimeSpan:`${((endDate.getTime()-startDate.getTime())/864e5).toFixed(1)} days`,preservesRawIntervals:!0});return(!(null==results?void 0:results.point_samples)||0===results.point_samples.length||results.point_samples.every(ps=&gt;!ps.data||0===ps.data.length))&amp;&amp;console.warn("âš ï¸ [useChartData] No data available for selected points and time range"),results}metricsRef.current.requestCount++;try{let results;console.log("ðŸ”— [useChartData] Using Cloudflare worker (cloudflareWorkerClient) exclusively:",{pointNames:pointNames,timeRange:timeRange,startTime:startTime,endTime:endTime,timeSpanDays:((new Date(endTime).getTime()-new Date(startTime).getTime())/864e5).toFixed(1)}),results=await fetchDirectAPI(),results=await fetchDirectAPI(),metricsRef.current.fallbackUsed++;const responseTime=Date.now()-requestStartTime;return metricsRef.current.totalResponseTime+=responseTime,enableMetrics&amp;&amp;featureFlags.enablePerformanceMonitoring&amp;&amp;console.log("ðŸ“Š [useChartData] Performance:",{responseTime:`${responseTime}ms`,usedBatching:shouldUseBatching,pointCount:pointNames.length,metrics:metricsRef.current}),results}catch(error2){throw metricsRef.current.errors++,console.error("âŒ [useChartData] Query failed:",error2),error2}},enabled:enabled&amp;&amp;pointNames.length&gt;0,refetchInterval:refreshInterval,staleTime:shouldUseBatching?12e4:6e4,gcTime:shouldUseBatching?6e5:3e5,retry:shouldUseBatching?1:3}),{data:data,isLoading:isLoading,error:error,refetch:refetch,isInitialLoading:isInitialLoading}=queryResult;let timeseriesData=data;console.log("ðŸ”„ [useChartData] Transforming data:",{hasData:!!data,dataType:typeof data,isArray:Array.isArray(data),hasPointSamples:!(!data||!data.point_samples),hasDataField:!(!data||!data.data),hasPoints:!(!data||!data.points)}),data&amp;&amp;"object"==typeof data&amp;&amp;!Array.isArray(data)&amp;&amp;(data.point_samples?(timeseriesData=data.point_samples,console.log("âœ… Using point_samples field:",{length:data.point_samples.length})):data.data?(timeseriesData=data.data,console.log("âœ… Using data field:",{length:data.data.length})):data.points&amp;&amp;(timeseriesData=Object.entries(data.points).map(([pointId,pointData])=&gt;({pointId:pointId,pointName:pointId,data:pointData.values||pointData.data||[],unit:pointData.unit})),console.log("âœ… Converted points object to array:",{length:timeseriesData.length}))),Array.isArray(timeseriesData)?console.log("ðŸ“Š [useChartData] Timeseries data array:",{length:timeseriesData.length,firstItem:timeseriesData[0]?{keys:Object.keys(timeseriesData[0]),hasData:!!timeseriesData[0].data,dataLength:null==(_a=timeseriesData[0].data)?void 0:_a.length}:null}):(console.warn("âš ï¸ [useChartDataSimple] Data is not in expected array format:",timeseriesData),timeseriesData=[]);const series=Array.isArray(timeseriesData)?timeseriesData.map(ts=&gt;{if(!ts||"object"!=typeof ts)return console.warn("[useChartDataSimple] Skipping invalid data item - not an object:",ts),null;const pointName=ts.pointName||ts.pointId||ts.name||"";if(!pointName&amp;&amp;!ts.pointId)return console.warn("[useChartDataSimple] Skipping invalid data item with no name or ID:",ts),null;const originalPoint=null==selectedPoints?void 0:selectedPoints.find(p=&gt;(null==p?void 0:p.name)&amp;&amp;p.name===pointName||(null==p?void 0:p.id)&amp;&amp;p.id===ts.pointId);let formattedData=[];Array.isArray(ts.data)&amp;&amp;(formattedData=ts.data.map(point=&gt;{if(Array.isArray(point)){return["number"==typeof point[0]?point[0]:new Date(point[0]).getTime(),point[1]]}if(point&amp;&amp;"object"==typeof point&amp;&amp;"timestamp"in point&amp;&amp;"value"in point){return["number"==typeof point.timestamp?point.timestamp:new Date(point.timestamp).getTime(),point.value]}return console.warn("[useChartDataSimple] Unknown data point format:",point),null}).filter(point=&gt;null!==point));const isWeatherTemp=pointName&amp;&amp;isWeatherTemperaturePoint(pointName),processedData=isWeatherTemp?convertTemperatureData(formattedData,"C","F"):formattedData,displayUnit=isWeatherTemp?"Â°F":ts.unit||(null==originalPoint?void 0:originalPoint.unit)||"",markerTags=(null==originalPoint?void 0:originalPoint.marker_tags)||((null==originalPoint?void 0:originalPoint.markerTag)?[originalPoint.markerTag]:[]);let formattedName=pointName;try{formattedName=getPointDisplayLabel({name:pointName,marker_tags:markerTags,unit:displayUnit},{displayMode:"smart",context:"legend"})}catch(error2){console.warn("[useChartDataSimple] Error formatting point label, using raw name:",error2),formattedName=pointName}const largeDatasetConfig=processedData.length&gt;2e3?{large:!0,largeThreshold:2e3,progressive:5e3,progressiveThreshold:1e4,progressiveChunkMode:"sequential",sampling:"lttb"}:{};return{name:pointName,formattedName:formattedName,data:processedData,unit:displayUnit,markerTag:null==originalPoint?void 0:originalPoint.markerTag,markerTags:markerTags,...largeDatasetConfig}}).filter(item=&gt;null!==item):[],noTokenError=!isLoading&amp;&amp;!data&amp;&amp;!error&amp;&amp;Array.isArray(pointNames)&amp;&amp;pointNames.length&gt;0?new Error("Authentication required. Please ensure you have a valid ACE IoT token."):null,safeSeries=Array.isArray(series)?series:[],performanceMetrics=reactExports.useMemo(()=&gt;{const totalRequests=metricsRef.current.requestCount,avgResponseTime=totalRequests&gt;0?metricsRef.current.totalResponseTime/totalRequests:0;return{totalRequests:totalRequests,batchingUsed:metricsRef.current.batchingUsed,fallbackUsed:metricsRef.current.fallbackUsed,batchingEfficiency:totalRequests&gt;0?metricsRef.current.batchingUsed/totalRequests*100:0,averageResponseTime:Math.round(avgResponseTime),errors:metricsRef.current.errors,usingBatching:shouldUseBatching}},[shouldUseBatching,queryResult.dataUpdatedAt]);return{data:{series:safeSeries},series:safeSeries,isLoading:isLoading,error:error||noTokenError,refetch:refetch,isBatchingEnabled:shouldUseBatching,performanceMetrics:enableMetrics?performanceMetrics:void 0}};const useChartKeyboardShortcuts=(chartRef,options={})=&gt;{const{enableZoom:enableZoom=!0,enablePan:enablePan=!0,enableReset:enableReset=!0,enableDataView:enableDataView=!1,zoomSpeed:zoomSpeed=.1,panSpeed:panSpeed=5}=options;reactExports.useEffect(()=&gt;{const handleKeyboard=e=&gt;{if(!chartRef.current)return;const chart=chartRef.current.getEchartsInstance();if(!chart)return;const option=chart.getOption();if(option&amp;&amp;option.dataZoom&amp;&amp;Array.isArray(option.dataZoom)&amp;&amp;option.dataZoom.length&gt;0||!enableZoom&amp;&amp;!enablePan){if(enableZoom&amp;&amp;e.ctrlKey&amp;&amp;!e.shiftKey&amp;&amp;!e.altKey&amp;&amp;("+"===e.key||"="===e.key?(e.preventDefault(),function handleZoomIn(chart,zoomSpeed){const option=chart.getOption();if(!option||!option.dataZoom||!Array.isArray(option.dataZoom))return;option.dataZoom.forEach((zoom,index2)=&gt;{if("inside"===zoom.type||"slider"===zoom.type){const currentStart=zoom.start||0,currentEnd=zoom.end||100,range=currentEnd-currentStart,newRange=Math.max(range*(1-zoomSpeed),5),center=(currentStart+currentEnd)/2,newStart=Math.max(center-newRange/2,0),newEnd=Math.min(center+newRange/2,100);chart.dispatchAction({type:"dataZoom",dataZoomIndex:index2,start:newStart,end:newEnd})}})}(chart,zoomSpeed)):"-"===e.key?(e.preventDefault(),function handleZoomOut(chart,zoomSpeed){const option=chart.getOption();if(!option||!option.dataZoom||!Array.isArray(option.dataZoom))return;option.dataZoom.forEach((zoom,index2)=&gt;{if("inside"===zoom.type||"slider"===zoom.type){const currentStart=zoom.start||0,currentEnd=zoom.end||100,range=currentEnd-currentStart,newRange=Math.min(range*(1+zoomSpeed),100),center=(currentStart+currentEnd)/2,newStart=Math.max(center-newRange/2,0),newEnd=Math.min(center+newRange/2,100);chart.dispatchAction({type:"dataZoom",dataZoomIndex:index2,start:newStart,end:newEnd})}})}(chart,zoomSpeed)):"0"===e.key&amp;&amp;(e.preventDefault(),handleResetZoom(chart))),enablePan&amp;&amp;!e.ctrlKey&amp;&amp;!e.shiftKey&amp;&amp;!e.altKey)switch(e.key){case"ArrowLeft":e.preventDefault(),handlePan(chart,"left",panSpeed);break;case"ArrowRight":e.preventDefault(),handlePan(chart,"right",panSpeed);break;case"ArrowUp":e.preventDefault(),handlePan(chart,"up",panSpeed);break;case"ArrowDown":e.preventDefault(),handlePan(chart,"down",panSpeed)}enableDataView&amp;&amp;e.ctrlKey&amp;&amp;"d"===e.key&amp;&amp;(e.preventDefault(),function handleToggleDataView(chart){try{chart.dispatchAction({type:"restore"})}catch(error){console.warn("Data view toggle not available for this chart")}}(chart)),enableReset&amp;&amp;"Escape"===e.key&amp;&amp;(e.preventDefault(),function handleResetView(chart){try{chart.dispatchAction({type:"restore"})}catch(error){handleResetZoom(chart)}}(chart))}};return window.addEventListener("keydown",handleKeyboard),()=&gt;{window.removeEventListener("keydown",handleKeyboard)}},[chartRef,enableZoom,enablePan,enableReset,enableDataView,zoomSpeed,panSpeed])};function handleResetZoom(chart){const option=chart.getOption();option&amp;&amp;option.dataZoom&amp;&amp;Array.isArray(option.dataZoom)&amp;&amp;option.dataZoom.forEach((_,index2)=&gt;{chart.dispatchAction({type:"dataZoom",dataZoomIndex:index2,start:0,end:100})})}function handlePan(chart,direction,panSpeed){const option=chart.getOption();option&amp;&amp;option.dataZoom&amp;&amp;Array.isArray(option.dataZoom)&amp;&amp;option.dataZoom.forEach((zoom,index2)=&gt;{if("inside"===zoom.type||"slider"===zoom.type){const currentStart=zoom.start||0,currentEnd=zoom.end||100,range=currentEnd-currentStart;let newStart=currentStart,newEnd=currentEnd;"left"===direction?(newStart=Math.max(currentStart-panSpeed,0),newEnd=Math.max(currentEnd-panSpeed,range)):"right"===direction&amp;&amp;(newStart=Math.min(currentStart+panSpeed,100-range),newEnd=Math.min(currentEnd+panSpeed,100)),chart.dispatchAction({type:"dataZoom",dataZoomIndex:index2,start:newStart,end:newEnd})}})}const usePoints=(options={})=&gt;{const{siteId:siteId,siteName:siteName,deviceId:deviceId,autoFetch:autoFetch=!0,transformData:transformData=!0,cacheTime:cacheTime=3e5}=options,[_searchQuery,_setSearchQuery]=reactExports.useState(""),{data:rawPoints=[],isLoading:isLoading,error:error,refetch:refetch}=useQuery({queryKey:["points",siteId,siteName,deviceId],queryFn:async()=&gt;{if(siteName){const allPoints=await pointService.loadAllPoints(siteName);return deviceId?allPoints.filter(point=&gt;{var _a,_b;return(null==(_b=null==(_a=point.bacnet_data)?void 0:_a.device_id)?void 0:_b.toString())===deviceId}):allPoints}if(siteId){const{all:all}=await cachedSitePointService.fetchPointsForSite(siteId);return deviceId?all.filter(point=&gt;{var _a,_b;return(null==(_b=null==(_a=point.bacnet_data)?void 0:_a.device_id)?void 0:_b.toString())===deviceId}):all}throw new Error("Either site ID or site name is required to fetch points")},enabled:autoFetch&amp;&amp;(!!siteId||!!siteName),staleTime:cacheTime,gcTime:cacheTime}),points=transformData&amp;&amp;Array.isArray(rawPoints)?transformPointData(rawPoints):rawPoints,hierarchicalPoints=transformData&amp;&amp;Array.isArray(points)?organizePointsHierarchically(points):[],searchPoints=reactExports.useCallback(query=&gt;{if(!query)return points;const lowerQuery=query.toLowerCase();return points.filter(point=&gt;"string"==typeof point.name&amp;&amp;point.name.toLowerCase().includes(lowerQuery)||"string"==typeof point.displayName&amp;&amp;point.displayName.toLowerCase().includes(lowerQuery)||"string"==typeof point.description&amp;&amp;point.description.toLowerCase().includes(lowerQuery)||Array.isArray(point.marker_tags)&amp;&amp;point.marker_tags.some(tag=&gt;"string"==typeof tag&amp;&amp;tag.toLowerCase().includes(lowerQuery)))},[points]),getPointById=reactExports.useCallback(id=&gt;{if(Array.isArray(points))return points.find(point=&gt;String(point.id)===String(id))},[points]),getPointsByDevice=reactExports.useCallback(deviceId2=&gt;Array.isArray(points)?points.filter(point=&gt;String(point.deviceId)===String(deviceId2)):[],[points]),getPointsByTag=reactExports.useCallback(tag=&gt;Array.isArray(points)?points.filter(point=&gt;{var _a,_b;return(null==(_a=point.marker_tags)?void 0:_a.includes(tag))||(null==(_b=point.tags)?void 0:_b.includes(tag))}):[],[points]);return{points:points||[],hierarchicalPoints:hierarchicalPoints,isLoading:isLoading,error:error,refetch:refetch,searchPoints:searchPoints,getPointById:getPointById,getPointsByDevice:getPointsByDevice,getPointsByTag:getPointsByTag}};function useMediaQuery(query){const[matches,setMatches]=reactExports.useState(()=&gt;"undefined"!=typeof window&amp;&amp;window.matchMedia(query).matches);return reactExports.useEffect(()=&gt;{if("undefined"==typeof window)return;const mediaQueryList=window.matchMedia(query);setMatches(mediaQueryList.matches);const handleChange=event=&gt;{setMatches(event.matches)};return mediaQueryList.addEventListener?mediaQueryList.addEventListener("change",handleChange):mediaQueryList.addListener(handleChange),()=&gt;{mediaQueryList.removeEventListener?mediaQueryList.removeEventListener("change",handleChange):mediaQueryList.removeListener(handleChange)}},[query]),matches}const useDashboardState=()=&gt;{const dashboardContext=useDashboardContext(),{monitors:monitors,layouts:layouts}=dashboardContext,user=useSelector(state=&gt;state.auth.firebaseUser),queryClient=useQueryClient(),theme=useTheme(),isMobile=useMediaQuery$1(theme.breakpoints.down("md")),isTablet=useMediaQuery$1(theme.breakpoints.down("lg")),isExtraSmall=useMediaQuery("(max-width: 480px)"),isSmall=useMediaQuery("(max-width: 768px)"),isMedium=useMediaQuery("(max-width: 996px)"),isLarge=useMediaQuery("(max-width: 1200px)"),searchInputRef=reactExports.useRef(null),layoutSaveTimeoutRef=reactExports.useRef(null),gridCols=reactExports.useMemo(()=&gt;({lg:12,md:isLarge?10:12,sm:isMedium?8:10,xs:isSmall?6:8,xxs:isExtraSmall?2:4}),[isExtraSmall,isSmall,isMedium,isLarge]),[speedDialOpen,setSpeedDialOpen]=reactExports.useState(!1),[showPerformance,setShowPerformance]=reactExports.useState(!1),[performanceMetrics,setPerformanceMetrics]=reactExports.useState(null),[wizardOpen,setWizardOpen]=reactExports.useState(!1),[editingMonitor,setEditingMonitor]=reactExports.useState(null),[shortcutsDialogOpen,setShortcutsDialogOpen]=reactExports.useState(!1),[shareDialogOpen,setShareDialogOpen]=reactExports.useState(!1),[settingsDialogOpen,setSettingsDialogOpen]=reactExports.useState(!1),[foldersDialogOpen,setFoldersDialogOpen]=reactExports.useState(!1),[snapshotsDialogOpen,setSnapshotsDialogOpen]=reactExports.useState(!1),[snapshotMonitor,setSnapshotMonitor]=reactExports.useState(null),[showOnboarding,setShowOnboarding]=reactExports.useState(!1),[dashboardState,setDashboardState]=reactExports.useState({monitors:monitors,layouts:layouts}),{notification:notification,showPending:showPending,showSuccess:showSuccess,showError:showError,hide:hideNotification2}=useOptimisticNotification();return{dashboardContext:dashboardContext,user:user,queryClient:queryClient,responsive:{gridCols:gridCols,isMobile:isMobile,isTablet:isTablet,isExtraSmall:isExtraSmall,isSmall:isSmall,isMedium:isMedium,isLarge:isLarge},uiState:{speedDialOpen:speedDialOpen,showPerformance:showPerformance,performanceMetrics:performanceMetrics,wizardOpen:wizardOpen,editingMonitor:editingMonitor,shortcutsDialogOpen:shortcutsDialogOpen,shareDialogOpen:shareDialogOpen,settingsDialogOpen:settingsDialogOpen,foldersDialogOpen:foldersDialogOpen,snapshotsDialogOpen:snapshotsDialogOpen,snapshotMonitor:snapshotMonitor,showOnboarding:showOnboarding},setUIState:{setSpeedDialOpen:setSpeedDialOpen,setShowPerformance:setShowPerformance,setPerformanceMetrics:setPerformanceMetrics,setWizardOpen:setWizardOpen,setEditingMonitor:setEditingMonitor,setShortcutsDialogOpen:setShortcutsDialogOpen,setShareDialogOpen:setShareDialogOpen,setSettingsDialogOpen:setSettingsDialogOpen,setFoldersDialogOpen:setFoldersDialogOpen,setSnapshotsDialogOpen:setSnapshotsDialogOpen,setSnapshotMonitor:setSnapshotMonitor,setShowOnboarding:setShowOnboarding},dashboardState:dashboardState,setDashboardState:setDashboardState,undoRedoActions:{undo:()=&gt;{},redo:()=&gt;{},canUndo:!1,canRedo:!1},notification:notification,notificationActions:{showPending:showPending,showSuccess:showSuccess,showError:showError,hideNotification:hideNotification2},searchInputRef:searchInputRef,layoutSaveTimeoutRef:layoutSaveTimeoutRef}};function useOptimisticMonitorUpdates(){const{execute:execute,isUpdating:isUpdating}=function useOptimisticUpdate(){const queryClient=useQueryClient(),[isUpdating,setIsUpdating]=reactExports.useState(!1),rollbackDataRef=reactExports.useRef(null);return{execute:reactExports.useCallback(async({onSuccess:onSuccess,onError:onError,optimisticData:optimisticData,mutationFn:mutationFn,rollbackData:rollbackData,queryKey:queryKey})=&gt;{setIsUpdating(!0),rollbackDataRef.current=rollbackData,queryKey&amp;&amp;queryClient.setQueryData(queryKey,optimisticData);try{const result=await mutationFn();return queryKey&amp;&amp;queryClient.setQueryData(queryKey,result),setIsUpdating(!1),null==onSuccess||onSuccess(result),result}catch(error){throw queryKey&amp;&amp;rollbackDataRef.current&amp;&amp;queryClient.setQueryData(queryKey,rollbackDataRef.current),setIsUpdating(!1),null==onError||onError(error,rollbackDataRef.current),error}},[queryClient]),isUpdating:isUpdating}}();return{createMonitor:reactExports.useCallback(async({newMonitor:newMonitor,currentMonitors:currentMonitors,saveFn:saveFn,onSuccess:onSuccess,onError:onError})=&gt;execute({optimisticData:[...currentMonitors,newMonitor],mutationFn:saveFn,rollbackData:currentMonitors,onSuccess:onSuccess,onError:error=&gt;{console.error("Failed to create monitor:",error),null==onError||onError(error)}}),[execute]),updateMonitor:reactExports.useCallback(async({monitorId:monitorId,updates:updates,currentMonitors:currentMonitors,saveFn:saveFn,onSuccess:onSuccess,onError:onError})=&gt;{const updatedMonitors=currentMonitors.map(m=&gt;m.id===monitorId?{...m,...updates}:m);return execute({optimisticData:updatedMonitors,mutationFn:saveFn,rollbackData:currentMonitors,onSuccess:onSuccess,onError:error=&gt;{console.error("Failed to update monitor:",error),null==onError||onError(error)}})},[execute]),deleteMonitor:reactExports.useCallback(async({monitorId:monitorId,currentMonitors:currentMonitors,saveFn:saveFn,onSuccess:onSuccess,onError:onError})=&gt;{const filteredMonitors=currentMonitors.filter(m=&gt;m.id!==monitorId);return execute({optimisticData:filteredMonitors,mutationFn:saveFn,rollbackData:currentMonitors,onSuccess:onSuccess,onError:error=&gt;{console.error("Failed to delete monitor:",error),null==onError||onError(error)}})},[execute]),isUpdating:isUpdating}}const useDashboardMonitors=({monitors:monitors,layouts:layouts,currentDashboardId:currentDashboardId,dashboardName:dashboardName,folders:folders,gridCols:gridCols,isMobile:isMobile,isTablet:isTablet,setMonitors:setMonitors,setDashboardState:setDashboardState,setErrorState:setErrorState,saveDashboardMutation:saveDashboardMutation,showPending:showPending,showSuccess:showSuccess,showError:showError})=&gt;{useQueryClient();const{createMonitor:optimisticCreateMonitor,deleteMonitor:optimisticDeleteMonitor}=useOptimisticMonitorUpdates(),getTimeRangeDates=reactExports.useCallback(()=&gt;{const end=new Date,start=new Date;return start.setHours(start.getHours()-24),{start:start,end:end}},[]),findEmptyPosition=reactExports.useCallback(()=&gt;{const cols=gridCols.lg,occupiedPositions=new Set;monitors.forEach(m=&gt;{if(m.layout)for(let x=m.layout.x;x&lt;m.layout.x+m.layout.w;x++)for(let y=m.layout.y;y&lt;m.layout.y+m.layout.h;y++)occupiedPositions.add(`${x},${y}`)});const newW=isMobile?4:6;for(let y=0;y&lt;100;y++)for(let x=0;x&lt;=cols-newW;x++){let canFit=!0;for(let dx=0;dx&lt;newW;dx++){for(let dy=0;dy&lt;4;dy++)if(occupiedPositions.has(`${x+dx},${y+dy}`)){canFit=!1;break}if(!canFit)break}if(canFit)return{x:x,y:y}}return{x:0,y:0}},[monitors,gridCols,isMobile,isTablet]),handleMonitorCreate=withErrorHandling(async config=&gt;{var _a;console.log("[MONITORS] ðŸ“Š Creating new chart monitor:",{title:config.title,chartType:config.chartType,siteId:config.siteId,selectedSite:config.selectedSite,timeRange:config.timeRange,selectedPoints:config.selectedPoints,configKeys:Object.keys(config),fullConfig:config}),config.siteId&amp;&amp;!config.selectedSite&amp;&amp;(config.selectedSite=config.siteId),config.chartType&amp;&amp;!config.selectedChartType&amp;&amp;(config.selectedChartType=config.chartType);try{if(!validateChartConfig(config))throw console.error("[MONITORS] âŒ Invalid chart configuration"),new Error("Invalid chart configuration");if(!config.selectedPoints||0===config.selectedPoints.length)throw console.error("[MONITORS] âŒ No points selected"),new Error("Please select at least one point");const monitorId=`monitor-${Date.now()}`,selectedPointsWithColor=null==(_a=config.selectedPoints)?void 0:_a.map((point,index2)=&gt;({...point,color:`hsl(${360*index2/config.selectedPoints.length}, 70%, 50%)`})),position=findEmptyPosition(),newMonitor={id:monitorId,title:config.title,chartType:config.chartType,siteId:config.siteId,siteName:config.siteName,selectedPoints:selectedPointsWithColor,timeRange:config.timeRange||"24h",config:config.config||{},layout:{i:monitorId,x:position.x,y:position.y,w:isMobile?4:6,h:isMobile?8:10}};showPending("Creating monitor..."),await optimisticCreateMonitor({newMonitor:newMonitor,currentMonitors:monitors,saveFn:async()=&gt;{const newMonitors=[...monitors,newMonitor];if(setMonitors(newMonitors),setDashboardState({monitors:newMonitors,layouts:layouts}),currentDashboardId&amp;&amp;dashboardName){const dashboardData={id:currentDashboardId,name:dashboardName.trim(),monitors:newMonitors,layouts:layouts,folders:folders};await saveDashboardMutation.mutateAsync(dashboardData)}return newMonitors},onSuccess:()=&gt;{console.log("[MONITORS] âœ… Monitor created successfully"),showSuccess("Monitor created successfully")},onError:error=&gt;{console.error("[MONITORS] âŒ Failed to create monitor:",error),showError("Failed to create monitor. Please try again."),setErrorState(prev=&gt;({...prev,general:error}))}})}catch(error){const userMessage=formatErrorForUser(error);throw setErrorState(prev=&gt;({...prev,general:error})),reportError(error,{context:"monitor-creation",config:config}),new Error(userMessage)}},{onError:error=&gt;{console.error("[MONITORS] Monitor creation failed:",error)}}),handleMonitorDelete=reactExports.useCallback(async monitorId=&gt;{showPending("Deleting monitor..."),await optimisticDeleteMonitor({monitorId:monitorId,currentMonitors:monitors,saveFn:async()=&gt;{const updatedMonitors=monitors.filter(m=&gt;m.id!==monitorId);if(setMonitors(updatedMonitors),setDashboardState({monitors:updatedMonitors,layouts:layouts}),currentDashboardId&amp;&amp;dashboardName){const dashboardData={id:currentDashboardId,name:dashboardName.trim(),monitors:updatedMonitors,layouts:layouts,folders:folders};await saveDashboardMutation.mutateAsync(dashboardData)}return updatedMonitors},onSuccess:()=&gt;{console.log(`Monitor ${monitorId} deleted successfully`),showSuccess("Monitor deleted successfully")},onError:error=&gt;{console.error("Failed to delete monitor:",error),showError("Failed to delete monitor. Please try again."),setErrorState(prev=&gt;({...prev,general:error}))}})},[monitors,layouts,currentDashboardId,dashboardName,folders,saveDashboardMutation,setDashboardState,setMonitors,setErrorState,optimisticDeleteMonitor,showPending,showSuccess,showError]),handleMonitorEdit=reactExports.useCallback(monitorId=&gt;{const monitor=monitors.find(m=&gt;m.id===monitorId);monitor&amp;&amp;console.log("Edit monitor:",monitor)},[monitors]);return{handleMonitorCreate:handleMonitorCreate,handleMonitorUpdate:reactExports.useCallback(async config=&gt;{try{const targetId=config.id||config.title,updatedMonitors=monitors.map(m=&gt;m.id===targetId?{...m,...config}:m);if(setMonitors(updatedMonitors),setDashboardState({monitors:updatedMonitors,layouts:layouts}),currentDashboardId&amp;&amp;dashboardName){const dashboardData={id:currentDashboardId,name:dashboardName.trim(),monitors:updatedMonitors,layouts:layouts,folders:folders};await saveDashboardMutation.mutateAsync(dashboardData),console.log("Monitor updated and dashboard saved")}}catch(error){console.error("Failed to save dashboard after monitor update:",error),setErrorState(prev=&gt;({...prev,general:error}))}},[monitors,layouts,currentDashboardId,dashboardName,folders,saveDashboardMutation,setDashboardState,setMonitors,setErrorState]),handleMonitorDelete:handleMonitorDelete,handleMonitorEdit:handleMonitorEdit,handleMonitorDuplicate:reactExports.useCallback(async monitor=&gt;{try{const newMonitorId=`monitor-${Date.now()}`,newMonitor={...monitor,id:newMonitorId,title:`${monitor.title} (Copy)`,layout:monitor.layout?{...monitor.layout,i:newMonitorId,x:(monitor.layout.x+2)%12,y:monitor.layout.y}:void 0},updatedMonitors=[...monitors,newMonitor];if(setMonitors(updatedMonitors),currentDashboardId&amp;&amp;dashboardName){const dashboardData={id:currentDashboardId,name:dashboardName.trim(),monitors:updatedMonitors,layouts:layouts,folders:folders};await saveDashboardMutation.mutateAsync(dashboardData),console.log("Monitor duplicated and dashboard saved")}}catch(error){console.error("Failed to save dashboard after monitor duplication:",error),setErrorState(prev=&gt;({...prev,general:error})),setMonitors(monitors)}},[monitors,currentDashboardId,dashboardName,layouts,folders,saveDashboardMutation,setMonitors,setErrorState]),getTimeRangeDates:getTimeRangeDates,setEditingMonitors:reactExports.useCallback(monitorsOrUpdater=&gt;{setMonitors("function"==typeof monitorsOrUpdater?current=&gt;monitorsOrUpdater(current):monitorsOrUpdater)},[setMonitors])}},useKeyboardShortcuts=config=&gt;{const navigate=useNavigate(),shortcuts=[{key:"ctrl+d, cmd+d",description:"Go to Dashboard",action:()=&gt;navigate("/dashboard")},{key:"ctrl+shift+a, cmd+shift+a",description:"Go to SES Dashboard",action:()=&gt;navigate("/ses-dashboard")},{key:"ctrl+shift+s, cmd+shift+s",description:"Go to Settings",action:()=&gt;navigate("/settings")},{key:"ctrl+n, cmd+n",description:"Add New Monitor",action:config.onAddMonitor},{key:"ctrl+s, cmd+s",description:"Save Dashboard",action:config.onSaveDashboard},{key:"f11",description:"Toggle Fullscreen",action:config.onToggleFullscreen},{key:"f5, ctrl+r, cmd+r",description:"Refresh All Data",action:config.onRefreshAll},{key:"ctrl+k, cmd+k",description:"Focus Search",action:config.onSearchFocus},{key:"/",description:"Quick Search",action:config.onSearchFocus},{key:"ctrl+e, cmd+e",description:"Export Data",action:config.onExportData},{key:"delete",description:"Delete Selected",action:config.onDeleteSelected},{key:"ctrl+d, cmd+d",description:"Duplicate Selected",action:config.onDuplicateSelected},{key:"?, shift+/",description:"Show Keyboard Shortcuts",action:config.onToggleHelp},{key:"escape",description:"Close Dialogs/Cancel",action:()=&gt;{}}];return shortcuts.forEach(({key:key,action:action})=&gt;{action&amp;&amp;useHotkeys(key,e=&gt;{e.preventDefault(),action()},{enableOnFormTags:!1,enableOnContentEditable:!1})}),useHotkeys("/",e=&gt;{e.preventDefault(),config.onSearchFocus&amp;&amp;config.onSearchFocus()},{enableOnFormTags:!1,enableOnContentEditable:!1}),useHotkeys("j",()=&gt;{window.scrollBy(0,100)},{enableOnFormTags:!1}),useHotkeys("k",()=&gt;{window.scrollBy(0,-100)},{enableOnFormTags:!1}),useHotkeys("g g",()=&gt;{window.scrollTo(0,0)},{enableOnFormTags:!1}),useHotkeys("shift+g",()=&gt;{window.scrollTo(0,document.body.scrollHeight)},{enableOnFormTags:!1}),shortcuts},useKeyboardShortcuts$1=Object.freeze(Object.defineProperty({__proto__:null,KeyboardShortcutsDialog:({open:open,onClose:onClose})=&gt;{const formatKey=key=&gt;navigator.platform.toUpperCase().indexOf("MAC")&gt;=0?key.replace("Cmd","âŒ˜").replace("Ctrl","âŒƒ"):key;return jsxRuntimeExports.jsxs(Dialog,{fullWidth:!0,PaperProps:{sx:{...glassEffect.strong}},maxWidth:"md",open:open,onClose:onClose,children:[jsxRuntimeExports.jsx(DialogTitle,{children:jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",alignItems:"center",gap:2},children:[jsxRuntimeExports.jsx(Keyboard,{}),jsxRuntimeExports.jsx(Typography,{variant:"h6",children:"Keyboard Shortcuts"})]})}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsx(Box,{sx:{mt:2},children:[{category:"Navigation",items:[{keys:["Ctrl+D","Cmd+D"],description:"Go to Dashboard"},{keys:["Ctrl+Shift+A","Cmd+Shift+A"],description:"Go to SES Dashboard"},{keys:["Ctrl+Shift+S","Cmd+Shift+S"],description:"Go to Settings"}]},{category:"Monitor Management",items:[{keys:["Ctrl+N","Cmd+N"],description:"Add New Monitor"},{keys:["Ctrl+S","Cmd+S"],description:"Save Dashboard"},{keys:["F11"],description:"Toggle Fullscreen"},{keys:["F5","Ctrl+R","Cmd+R"],description:"Refresh All Data"}]},{category:"Search and Filter",items:[{keys:["Ctrl+K","Cmd+K"],description:"Focus Search"},{keys:["/"],description:"Quick Search"}]},{category:"Data Operations",items:[{keys:["Ctrl+E","Cmd+E"],description:"Export Data"},{keys:["Delete"],description:"Delete Selected"},{keys:["Ctrl+D","Cmd+D"],description:"Duplicate Selected"}]},{category:"Navigation (Vim-style)",items:[{keys:["J"],description:"Scroll Down"},{keys:["K"],description:"Scroll Up"},{keys:["G G"],description:"Go to Top"},{keys:["Shift+G"],description:"Go to Bottom"}]},{category:"Help",items:[{keys:["?","Shift+/"],description:"Show Keyboard Shortcuts"},{keys:["Esc"],description:"Close Dialogs/Cancel"}]}].map(section=&gt;jsxRuntimeExports.jsxs(Box,{sx:{mb:4},children:[jsxRuntimeExports.jsx(Typography,{sx:{mb:2,color:"primary.main"},variant:"subtitle2",children:section.category}),jsxRuntimeExports.jsx(TableContainer,{component:Paper,sx:{...glassEffect.light},children:jsxRuntimeExports.jsx(Table,{size:"small",children:jsxRuntimeExports.jsx(TableBody,{children:section.items.map((item,index2)=&gt;jsxRuntimeExports.jsxs(TableRow,{children:[jsxRuntimeExports.jsx(TableCell,{sx:{width:"40%"},children:jsxRuntimeExports.jsx(Box,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:item.keys.map((key,keyIndex)=&gt;jsxRuntimeExports.jsxs(React.Fragment,{children:[jsxRuntimeExports.jsx(Chip,{label:formatKey(key),size:"small",sx:{...glassEffect.light,fontFamily:"monospace",fontWeight:600}}),keyIndex&lt;item.keys.length-1&amp;&amp;jsxRuntimeExports.jsx(Typography,{sx:{alignSelf:"center"},variant:"caption",children:"or"})]},keyIndex))})}),jsxRuntimeExports.jsx(TableCell,{children:item.description})]},index2))})})})]},section.category))})}),jsxRuntimeExports.jsx(DialogActions,{children:jsxRuntimeExports.jsx(Button,{onClick:onClose,children:"Close"})})]})},useKeyboardShortcuts:useKeyboardShortcuts},Symbol.toStringTag,{value:"Module"})),useAceIotApi=()=&gt;{useSelector(state=&gt;state.auth.user),useSelector(state=&gt;state.auth.isAuthenticated),useSelector(state=&gt;state.auth.aceToken);const{config:batchingConfig}=function useBatching(){const context=reactExports.useContext(BatchingContext);if(!context)throw new Error("useBatching must be used within a BatchingProvider");return context}(),[loading,setLoading2]=reactExports.useState(!1),[error,setError2]=reactExports.useState(null);return{loading:loading,error:error,setApiToken:reactExports.useCallback(token=&gt;{aceIotApiClient.setToken(token)},[]),getSites:reactExports.useCallback(async()=&gt;{setLoading2(!0),setError2(null);try{return await aceIotApiClient.getSites()}catch(err){throw setError2(err),err}finally{setLoading2(!1)}},[]),getPoints:reactExports.useCallback(async()=&gt;{setLoading2(!0),setError2(null);try{return await aceIotApiClient.getPoints()}catch(err){throw setError2(err),err}finally{setLoading2(!1)}},[]),getTimeseries:reactExports.useCallback(async(pointNames,startTime,endTime)=&gt;{setLoading2(!0),setError2(null);try{return await aceIotApiClient.fetchTimeseriesData(pointNames,startTime,endTime)}catch(err){throw setError2(err),err}finally{setLoading2(!1)}},[]),clearCache:reactExports.useCallback(()=&gt;{aceIotApiClient.clearCache()},[]),getCacheStats:reactExports.useCallback(()=&gt;aceIotApiClient.getCacheStats(),[]),getMetrics:reactExports.useCallback(()=&gt;aceIotApiClient.getBatchingMetrics(),[]),batchingEnabled:batchingConfig.enabled}},useAceSites=()=&gt;{const{getSites:getSites}=useAceIotApi(),[sites,setSites2]=reactExports.useState([]),[isLoading,setIsLoading]=reactExports.useState(!1),[error,setError2]=reactExports.useState(null);return{data:sites,isLoading:isLoading,error:error,refetch:reactExports.useCallback(async()=&gt;{setIsLoading(!0),setError2(null);try{const result=await getSites();return setSites2(result||[]),result}catch(err){throw setError2(err),err}finally{setIsLoading(!1)}},[getSites])}},useAcePoints=siteId=&gt;{const{getPoints:getPoints}=useAceIotApi(),[points,setPoints2]=reactExports.useState([]),[isLoading,setIsLoading]=reactExports.useState(!1),[error,setError2]=reactExports.useState(null);return{data:points,isLoading:isLoading,error:error,refetch:reactExports.useCallback(async()=&gt;{setIsLoading(!0),setError2(null);try{const result=await getPoints(),filtered=siteId?(result||[]).filter(p=&gt;p.siteId===siteId):result||[];return setPoints2(filtered),filtered}catch(err){throw setError2(err),err}finally{setIsLoading(!1)}},[getPoints,siteId])}},useAceDataRefresh=()=&gt;{const{clearCache:clearCache}=useAceIotApi(),[isRefreshing,setIsRefreshing]=reactExports.useState(!1);return{refresh:reactExports.useCallback(async()=&gt;{setIsRefreshing(!0);try{clearCache(),await new Promise(resolve=&gt;setTimeout(resolve,100))}finally{setIsRefreshing(!1)}},[clearCache]),isRefreshing:isRefreshing}},logger=createLogger("PerformanceMonitor"),defaultConfig={slowRenderThreshold:16,memoryLeakThreshold:50,trackMemory:!0,trackInteractions:!0,logSlowRenders:!0,sampleRate:1},usePerformanceMonitor=(componentName,config={})=&gt;{const finalConfig={...defaultConfig,...config},[metrics,setMetrics]=reactExports.useState({renderCount:0,totalRenderTime:0,averageRenderTime:0,lastRenderTime:0,mountTime:Date.now(),interactionCount:0,slowRenders:0,memoryLeaks:0}),renderStartTime=reactExports.useRef(0),initialMemory=reactExports.useRef(0),lastMemoryCheck=reactExports.useRef(0),interactionListeners=reactExports.useRef([]),startRenderTiming=reactExports.useCallback(()=&gt;{Math.random()&gt;finalConfig.sampleRate||(renderStartTime.current=performance.now())},[finalConfig.sampleRate]),endRenderTiming=reactExports.useCallback(()=&gt;{if(0===renderStartTime.current)return;const renderTime=performance.now()-renderStartTime.current;renderStartTime.current=0,setMetrics(prev=&gt;{const newRenderCount=prev.renderCount+1,newTotalTime=prev.totalRenderTime+renderTime,averageTime=newTotalTime/newRenderCount,newMetrics={...prev,renderCount:newRenderCount,totalRenderTime:newTotalTime,averageRenderTime:averageTime,lastRenderTime:renderTime,firstRenderTime:prev.firstRenderTime||renderTime,slowRenders:renderTime&gt;finalConfig.slowRenderThreshold?prev.slowRenders+1:prev.slowRenders};return finalConfig.logSlowRenders&amp;&amp;renderTime&gt;finalConfig.slowRenderThreshold&amp;&amp;logger.warn("Slow render detected",{component:componentName,renderTime:renderTime,threshold:finalConfig.slowRenderThreshold,renderCount:newRenderCount}),newMetrics})},[componentName,finalConfig.slowRenderThreshold,finalConfig.logSlowRenders]),checkMemoryUsage=reactExports.useCallback(()=&gt;{if(!finalConfig.trackMemory||!("memory"in performance))return;const memory=performance.memory,currentMemory=memory.usedJSHeapSize/1048576;0===initialMemory.current&amp;&amp;(initialMemory.current=currentMemory);const memoryIncrease=currentMemory-initialMemory.current,memoryLeakDetected=memoryIncrease&gt;finalConfig.memoryLeakThreshold;setMetrics(prev=&gt;({...prev,usedJSHeapSize:memory.usedJSHeapSize,totalJSHeapSize:memory.totalJSHeapSize,jsHeapSizeLimit:memory.jsHeapSizeLimit,memoryLeaks:memoryLeakDetected&amp;&amp;currentMemory&gt;lastMemoryCheck.current?prev.memoryLeaks+1:prev.memoryLeaks})),memoryLeakDetected&amp;&amp;currentMemory&gt;lastMemoryCheck.current&amp;&amp;logger.warn("Potential memory leak detected",{component:componentName,memoryIncrease:memoryIncrease,currentMemory:currentMemory,threshold:finalConfig.memoryLeakThreshold}),lastMemoryCheck.current=currentMemory},[componentName,finalConfig.trackMemory,finalConfig.memoryLeakThreshold]),trackInteraction=reactExports.useCallback(event=&gt;{setMetrics(prev=&gt;({...prev,interactionCount:prev.interactionCount+1,lastInteractionTime:Date.now()}))},[]);reactExports.useEffect(()=&gt;{if(!finalConfig.trackInteractions)return;const listeners=[];return["click","keydown","scroll","touchstart"].forEach(eventName=&gt;{const listener=event=&gt;trackInteraction(event);document.addEventListener(eventName,listener,{passive:!0}),listeners.push(()=&gt;document.removeEventListener(eventName,listener))}),interactionListeners.current=listeners,()=&gt;{listeners.forEach(cleanup=&gt;cleanup())}},[finalConfig.trackInteractions,trackInteraction]),reactExports.useEffect(()=&gt;{if(!finalConfig.trackMemory)return;const interval=setInterval(checkMemoryUsage,5e3);return()=&gt;clearInterval(interval)},[checkMemoryUsage,finalConfig.trackMemory]),reactExports.useEffect(()=&gt;(logger.debug("Component mounted",{component:componentName,mountTime:metrics.mountTime}),()=&gt;{logger.debug("Component unmounted",{component:componentName,lifetime:Date.now()-metrics.mountTime,totalRenders:metrics.renderCount,averageRenderTime:metrics.averageRenderTime})}),[componentName,metrics.mountTime,metrics.renderCount,metrics.averageRenderTime]);const getPerformanceSummary=reactExports.useCallback(()=&gt;{const lifetime=Date.now()-metrics.mountTime,rendersPerSecond=metrics.renderCount/(lifetime/1e3);return{...metrics,lifetime:lifetime,rendersPerSecond:rendersPerSecond,performanceScore:calculatePerformanceScore(metrics,finalConfig)}},[metrics,finalConfig]),resetMetrics=reactExports.useCallback(()=&gt;{setMetrics({renderCount:0,totalRenderTime:0,averageRenderTime:0,lastRenderTime:0,mountTime:Date.now(),interactionCount:0,slowRenders:0,memoryLeaks:0}),initialMemory.current=0,lastMemoryCheck.current=0},[]);return{metrics:metrics,startRenderTiming:startRenderTiming,endRenderTiming:endRenderTiming,checkMemoryUsage:checkMemoryUsage,getPerformanceSummary:getPerformanceSummary,resetMetrics:resetMetrics}},calculatePerformanceScore=(metrics,config)=&gt;{let score=100;const slowRenderRatio=metrics.slowRenders/Math.max(metrics.renderCount,1);if(score-=30*slowRenderRatio,metrics.averageRenderTime&gt;config.slowRenderThreshold){const excess=metrics.averageRenderTime-config.slowRenderThreshold;score-=Math.min(excess,20)}return score-=10*metrics.memoryLeaks,metrics.renderCount&gt;10&amp;&amp;slowRenderRatio&lt;.1&amp;&amp;(score+=5),Math.max(0,Math.min(100,score))};function useSitePoints(){const[sites,setSites2]=reactExports.useState([]),[sitesLoading,setSitesLoading2]=reactExports.useState(!0),[sitesError,setSitesError2]=reactExports.useState(null),[selectedSite,setSelectedSite2]=reactExports.useState(null),[points,setPoints2]=reactExports.useState([]),[pointsGrouped,setPointsGrouped]=reactExports.useState({}),[pointsLoading,setPointsLoading]=reactExports.useState(!1),[pointsError,setPointsError]=reactExports.useState(null);reactExports.useEffect(()=&gt;{(async()=&gt;{setSitesLoading2(!0),setSitesError2(null);try{const fetchedSites=await cachedSitePointService.fetchSites();setSites2(fetchedSites),console.log("[useSitePoints] Fetched sites:",fetchedSites.length)}catch(error){console.error("[useSitePoints] Failed to fetch sites:",error),setSitesError2(error instanceof Error?error:new Error("Failed to fetch sites")),setSites2([])}finally{setSitesLoading2(!1)}})()},[]);const[pendingSiteId,setPendingSiteId]=reactExports.useState(null),selectSite=reactExports.useCallback(async siteId=&gt;{if(console.log("[useSitePoints] Selecting site:",siteId,"Sites loaded:",sites.length),sitesLoading||0===sites.length)return console.log("[useSitePoints] Sites not loaded yet, storing pending selection:",siteId),void setPendingSiteId(siteId);setPendingSiteId(null);const site=sites.find(s=&gt;{var _a;return s.name===siteId||s.id===siteId||(null==(_a=s.id)?void 0:_a.toString())===siteId||s.id===parseInt(siteId,10).toString()||parseInt(s.id,10)===parseInt(siteId,10)});if(!site)return console.warn("[useSitePoints] Site not found:",siteId,"Available sites:",sites.map(s=&gt;({id:s.id,name:s.name}))),void setPointsError(new Error(`Site not found: ${siteId}`));console.log("[useSitePoints] Found site:",{id:site.id,name:site.name,providedSiteId:siteId,isNumeric:!isNaN(parseInt(siteId,10))}),setSelectedSite2(site),setPointsLoading(!0),setPointsError(null);try{const siteIdentifier=site.name;if(!siteIdentifier)throw new Error(`Site name not found for site ID: ${siteId}`);console.log("[useSitePoints] Using site name for API:",siteIdentifier);const result=await cachedSitePointService.fetchPointsForSite(siteIdentifier,void 0,void 0,!0);setPoints2(result.all),setPointsGrouped(result.grouped),console.log("[useSitePoints] Fetched points for site:",siteIdentifier,"Count:",result.all.length)}catch(error){console.error("[useSitePoints] Failed to fetch points:",error),setPointsError(error instanceof Error?error:new Error("Failed to fetch points")),setPoints2([]),setPointsGrouped({})}finally{setPointsLoading(!1)}},[sites,sitesLoading]);return reactExports.useEffect(()=&gt;{!sitesLoading&amp;&amp;sites.length&gt;0&amp;&amp;pendingSiteId&amp;&amp;(console.log("[useSitePoints] Processing pending site selection:",pendingSiteId),selectSite(pendingSiteId))},[sitesLoading,sites,pendingSiteId,selectSite]),{sites:sites,sitesLoading:sitesLoading,sitesError:sitesError,points:points,pointsGrouped:pointsGrouped,pointsLoading:pointsLoading,pointsError:pointsError,selectSite:selectSite,selectedSite:selectedSite}}function usePointData(options={}){const{siteId:siteId,searchQuery:searchQuery="",markerTags:markerTags=[],pageSize:pageSize=1e5,debounceMs:debounceMs=50,enableIndexedDB:enableIndexedDB=!0,enablePrefetch:enablePrefetch=!0,enableProgressive:enableProgressive=!0,virtualScrolling:virtualScrolling=!0}=options,[points,setPoints2]=reactExports.useState([]),[allPoints,setAllPoints]=reactExports.useState([]),[isLoading,setIsLoading]=reactExports.useState(!1),[isSearching,setIsSearching]=reactExports.useState(!1),[isPrefetching,setIsPrefetching]=reactExports.useState(!1),[error,setError2]=reactExports.useState(null),[fromCache,setFromCache]=reactExports.useState(!1),[loadTime,setLoadTime]=reactExports.useState(void 0),[searchTerm,setSearchTerm]=reactExports.useState(""),fetchPoints=reactExports.useCallback(async(bypassCache=!1)=&gt;{if(!siteId)return setPoints2([]),void setAllPoints([]);setIsLoading(!0),setError2(null);const startTime=Date.now();try{const result=await cachedSitePointService.fetchPointsForSite(siteId,void 0,void 0,!0,bypassCache);console.log("[usePointData] Enhancing points...");const enhancedPoints=result.all.map(point=&gt;{if(hasKvTags(point)){const enhanced=enhancePointWithKvTags(point);return console.log(`[usePointData] Enhanced with KV tags: ${point.Name||point.name} -&gt; ${enhanced.display_name}`),enhanced}if(needsEnhancement(point)){const enhanced=enhancePoint(point);return console.log(`[usePointData] Enhanced: ${point.name} -&gt; ${enhanced.display_name}`),enhanced}return point});setAllPoints(enhancedPoints),setPoints2(enhancedPoints),setLoadTime(Date.now()-startTime),setFromCache(!1)}catch(err){console.error("[usePointData] Failed to fetch points:",err),setError2(err instanceof Error?err:new Error("Failed to fetch points")),setPoints2([]),setAllPoints([])}finally{setIsLoading(!1)}},[siteId]),search=reactExports.useCallback(query=&gt;{if(setSearchTerm(query),setIsSearching(!0),query){const lowerQuery=query.toLowerCase(),filtered=allPoints.filter(point=&gt;{var _a,_b,_c,_d,_e,_f,_g,_h,_i;return!!(null==(_a=point.display_name)?void 0:_a.toLowerCase().includes(lowerQuery))||(!!(null==(_b=point.name)?void 0:_b.toLowerCase().includes(lowerQuery))||(!!(null==(_c=point.Name)?void 0:_c.toLowerCase().includes(lowerQuery))||(!!(null==(_d=point.id)?void 0:_d.toLowerCase().includes(lowerQuery))||(!!(null==(_e=point.marker_tags)?void 0:_e.some(tag=&gt;tag.toLowerCase().includes(lowerQuery)))||(!!(null==(_f=point.unit)?void 0:_f.toLowerCase().includes(lowerQuery))||(!!(null==(_g=point.equipmentName)?void 0:_g.toLowerCase().includes(lowerQuery))||(!!(null==(_h=point.equipmentType)?void 0:_h.toLowerCase().includes(lowerQuery))||!!(null==(_i=point.Site)?void 0:_i.toLowerCase().includes(lowerQuery)))))))))});setPoints2(filtered)}else setPoints2(allPoints);setIsSearching(!1)},[allPoints]);reactExports.useEffect(()=&gt;{if(markerTags.length&gt;0){const filtered=allPoints.filter(point=&gt;{var _a;return null==(_a=point.marker_tags)?void 0:_a.some(tag=&gt;markerTags.includes(tag))});setPoints2(filtered)}else searchTerm||setPoints2(allPoints)},[markerTags,allPoints,searchTerm]),reactExports.useEffect(()=&gt;{fetchPoints()},[fetchPoints]);const refresh=reactExports.useCallback(async()=&gt;{console.log("[usePointData] Refreshing points with cache bypass"),await fetchPoints(!0)},[fetchPoints]),clearCache=reactExports.useCallback(()=&gt;{console.log("[usePointData] Clear cache requested - will bypass on next fetch")},[]),prefetchSite=reactExports.useCallback(prefetchSiteId=&gt;{setIsPrefetching(!0),console.log("[usePointData] Prefetching site:",prefetchSiteId),setTimeout(()=&gt;setIsPrefetching(!1),1e3)},[]),cacheStats=reactExports.useMemo(()=&gt;({hitRate:fromCache?.95:0}),[fromCache]);return{points:points,totalCount:allPoints.length,isLoading:isLoading,isSearching:isSearching,isPrefetching:isPrefetching,error:error,search:search,refresh:refresh,clearCache:clearCache,prefetchSite:prefetchSite,fromCache:fromCache,cacheStats:cacheStats,loadTime:loadTime,renderTime:50}}const WIZARD_STATE_KEY="buildingVitals_wizardState",useWizardStatePersistence=()=&gt;{const[savedState,setSavedState]=reactExports.useState(null);reactExports.useEffect(()=&gt;{try{const stored=localStorage.getItem(WIZARD_STATE_KEY);if(stored){const parsed=JSON.parse(stored);parsed.timestamp&amp;&amp;Date.now()-parsed.timestamp&lt;864e5?setSavedState(parsed):localStorage.removeItem(WIZARD_STATE_KEY)}}catch(error){console.error("Failed to load wizard state:",error),localStorage.removeItem(WIZARD_STATE_KEY)}},[]);return{savedState:savedState,saveWizardState:reactExports.useCallback(state=&gt;{try{const stateWithTimestamp={...state,timestamp:Date.now()};localStorage.setItem(WIZARD_STATE_KEY,JSON.stringify(stateWithTimestamp)),setSavedState(stateWithTimestamp)}catch(error){console.error("Failed to save wizard state:",error)}},[]),clearWizardState:reactExports.useCallback(()=&gt;{try{localStorage.removeItem(WIZARD_STATE_KEY),setSavedState(null)}catch(error){console.error("Failed to clear wizard state:",error)}},[]),hasSavedState:reactExports.useCallback(()=&gt;{try{const stored=localStorage.getItem(WIZARD_STATE_KEY);if(stored){const parsed=JSON.parse(stored);return parsed.timestamp&amp;&amp;Date.now()-parsed.timestamp&lt;864e5}}catch(error){console.error("Failed to check wizard state:",error)}return!1},[])}},useWizardAutoSave=(state,enabled=!0,debounceMs=1e3)=&gt;{const{saveWizardState:saveWizardState}=useWizardStatePersistence();reactExports.useEffect(()=&gt;{if(!enabled||!state||0===Object.keys(state).length)return;const timeoutId=setTimeout(()=&gt;{saveWizardState(state)},debounceMs);return()=&gt;clearTimeout(timeoutId)},[state,enabled,debounceMs,saveWizardState])};export{sesDarkTheme as $,useWizardAutoSave as A,useSitePoints as B,useSnackbar as C,firebaseFunctions as D,store as E,checkRedirectResult as F,signInWithSSO as G,useDashboardState as H,useDashboardMonitors as I,useKeyboardShortcuts as J,usePerformanceMonitor as K,useAceSites as L,useAcePoints as M,useAceDataRefresh as N,createLogger as O,DashboardProvider as P,cloudflareWorkerClient as Q,getTokenService as R,aceIotApiClient as S,setAceToken$1 as T,tokenLoadComplete as U,getApiService as V,tokenManager as W,getFirebaseAuth as X,getToken as Y,axiosInstance as Z,__vitePreload as _,useGlobalTimeRangeStore as a,updateDirectApiToken as a0,authFailure as a1,authStart as a2,setFirebaseUser as a3,loadProfileStart as a4,setDarkMode as a5,setUserProfile as a6,BatchingProvider as a7,SnackbarProvider as a8,persistor as a9,authSlice$2 as aa,index as ab,cloudflareWorkerClient$1 as ac,api as ad,tokenService$1 as ae,tokenManager$1 as af,featureFlags$1 as ag,axiosInstance$1 as ah,useKeyboardShortcuts$1 as ai,useAppDispatch as b,auth as c,useInstallPrompt as d,useSupportsTouch as e,featureFlags as f,glassEffect as g,usePullToRefresh as h,useTokenStatus as i,useDialogFocusTrap as j,useFaultDetection as k,logout as l,useBaseChartOptions as m,useChartDataSimple as n,useBarChartClick as o,mergeChartOptions as p,createBarChartClickEvent as q,useChartKeyboardShortcuts as r,sesColorPalette as s,usePoints as t,useAppSelector as u,useMobileDetection as v,useDashboardContext as w,db as x,usePointData as y,useWizardStatePersistence as z};</span>
&nbsp;</pre></td></tr></table></pre>

                <div class='push'></div><!-- for sticky footer -->
            </div><!-- /wrapper -->
            <div class='footer quiet pad2 space-top1 center small'>
                Code coverage generated by
                <a href="https://istanbul.js.org/" target="_blank" rel="noopener noreferrer">istanbul</a>
                at 2025-10-16T12:41:31.984Z
            </div>
        <script src="../../../../prettify.js"></script>
        <script>
            window.onload = function () {
                prettyPrint();
            };
        </script>
        <script src="../../../../sorter.js"></script>
        <script src="../../../../block-navigation.js"></script>
    </body>
</html>
    